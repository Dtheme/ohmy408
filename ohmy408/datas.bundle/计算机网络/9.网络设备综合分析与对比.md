# 9.ç½‘ç»œè®¾å¤‡ç»¼åˆåˆ†æä¸å¯¹æ¯”

## ç›®å½•
- [9.1 ç½‘ç»œè®¾å¤‡åˆ†å±‚æ¶æ„](#91-ç½‘ç»œè®¾å¤‡åˆ†å±‚æ¶æ„)
- [9.2 ç‰©ç†å±‚è®¾å¤‡è¯¦è§£](#92-ç‰©ç†å±‚è®¾å¤‡è¯¦è§£)
- [9.3 æ•°æ®é“¾è·¯å±‚è®¾å¤‡è¯¦è§£](#93-æ•°æ®é“¾è·¯å±‚è®¾å¤‡è¯¦è§£)
- [9.4 ç½‘ç»œå±‚è®¾å¤‡è¯¦è§£](#94-ç½‘ç»œå±‚è®¾å¤‡è¯¦è§£)
- [9.5 è®¾å¤‡æ€§èƒ½å¯¹æ¯”åˆ†æ](#95-è®¾å¤‡æ€§èƒ½å¯¹æ¯”åˆ†æ)
- [9.6 ç½‘ç»œæ¶æ„è®¾è®¡æŒ‡å—](#96-ç½‘ç»œæ¶æ„è®¾è®¡æŒ‡å—)
- [9.7 è€ƒç ”é‡ç‚¹æ€»ç»“](#97-è€ƒç ”é‡ç‚¹æ€»ç»“)

---

## 9.1 ç½‘ç»œè®¾å¤‡åˆ†å±‚æ¶æ„

### OSIæ¨¡å‹ä¸è®¾å¤‡å¯¹åº”å…³ç³»

```mermaid
flowchart TB
    A["åº”ç”¨å±‚ L7"] --> A1["åº”ç”¨ç½‘å…³"]
    A1 --> A2["åè®®è½¬æ¢"]
    
    B["è¡¨ç¤ºå±‚ L6"] --> B1["ç½‘å…³"]
    B1 --> B2["æ•°æ®æ ¼å¼è½¬æ¢"]
    
    C["ä¼šè¯å±‚ L5"] --> C1["ä¼šè¯ç½‘å…³"]
    C1 --> C2["ä¼šè¯ç®¡ç†"]
    
    D["ä¼ è¾“å±‚ L4"] --> D1["ä¼ è¾“ç½‘å…³"]
    D1 --> D2["ç«¯åˆ°ç«¯è¿æ¥"]
    
    E["ç½‘ç»œå±‚ L3"] --> E1["è·¯ç”±å™¨"]
    E --> E2["ä¸‰å±‚äº¤æ¢æœº"]
    E --> E3["é˜²ç«å¢™"]
    E1 --> E4["è·¯å¾„é€‰æ‹©"]
    E2 --> E5["ç¡¬ä»¶è·¯ç”±"]
    E3 --> E6["å®‰å…¨è¿‡æ»¤"]
    
    F["æ•°æ®é“¾è·¯å±‚ L2"] --> F1["ç½‘æ¡¥"]
    F --> F2["äº¤æ¢æœº"]
    F1 --> F3["MACåœ°å€å­¦ä¹ "]
    F2 --> F4["å¸§è½¬å‘"]
    
    G["ç‰©ç†å±‚ L1"] --> G1["ä¸­ç»§å™¨"]
    G --> G2["é›†çº¿å™¨"]
    G1 --> G3["ä¿¡å·å†ç”Ÿ"]
    G2 --> G4["ä¿¡å·åˆ†å‘"]
    
    style A fill:#e3f2fd,stroke:#1976d2,stroke-width:2px,color:#0d47a1
    style B fill:#e8f5e8,stroke:#2e7d32,stroke-width:2px,color:#1b5e20
    style C fill:#fff3e0,stroke:#f57c00,stroke-width:2px,color:#e65100
    style D fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px,color:#4a148c
    style E fill:#ffebee,stroke:#d32f2f,stroke-width:2px,color:#b71c1c
    style F fill:#e0f2f1,stroke:#00695c,stroke-width:2px,color:#004d40
    style G fill:#fce4ec,stroke:#c2185b,stroke-width:2px,color:#880e4f
```

**OSIå±‚æ¬¡ä¸è®¾å¤‡åŠŸèƒ½å¯¹åº”è¡¨**ï¼š

| OSIå±‚æ¬¡ | è®¾å¤‡ç±»å‹ | ä¸»è¦åŠŸèƒ½ | åº”ç”¨åœºæ™¯ |
|---------|---------|---------|---------|
| **åº”ç”¨å±‚** | åº”ç”¨ç½‘å…³ | åè®®è½¬æ¢ | HTTP/HTTPSä»£ç† |
| **è¡¨ç¤ºå±‚** | ç½‘å…³ | æ•°æ®æ ¼å¼è½¬æ¢ | åŠ å¯†è§£å¯†ã€å‹ç¼© |
| **ä¼šè¯å±‚** | ä¼šè¯ç½‘å…³ | ä¼šè¯ç®¡ç† | è´Ÿè½½å‡è¡¡å™¨ |
| **ä¼ è¾“å±‚** | ä¼ è¾“ç½‘å…³ | ç«¯åˆ°ç«¯è¿æ¥ | é˜²ç«å¢™ã€NAT |
| **ç½‘ç»œå±‚** | è·¯ç”±å™¨ã€ä¸‰å±‚äº¤æ¢æœºã€é˜²ç«å¢™ | è·¯å¾„é€‰æ‹©ã€å®‰å…¨è¿‡æ»¤ | ç½‘ç»œäº’è¿ |
| **æ•°æ®é“¾è·¯å±‚** | ç½‘æ¡¥ã€äº¤æ¢æœº | MACåœ°å€å­¦ä¹ ã€å¸§è½¬å‘ | å±€åŸŸç½‘äº¤æ¢ |
| **ç‰©ç†å±‚** | ä¸­ç»§å™¨ã€é›†çº¿å™¨ | ä¿¡å·å†ç”Ÿã€ä¿¡å·åˆ†å‘ | è·ç¦»å»¶é•¿ |

### ç½‘ç»œè®¾å¤‡å·¥ä½œåŸŸå¯¹æ¯”

#### **å·¥ä½œèŒƒå›´åˆ†ç±»**

```mermaid
graph TB
    subgraph CD["å†²çªåŸŸ"]
        CD1["åŒä¸€ç‰©ç†ä»‹è´¨ä¸Š<br/>å¯èƒ½å‘ç”Ÿå†²çªçš„è®¾å¤‡é›†åˆ"]
        CD2["åˆ†å‰²è®¾å¤‡: ç½‘æ¡¥ã€äº¤æ¢æœºã€è·¯ç”±å™¨"]
    end
    
    subgraph BD["å¹¿æ’­åŸŸ"]
        BD1["å¹¿æ’­å¸§èƒ½å¤Ÿåˆ°è¾¾çš„<br/>æ‰€æœ‰è®¾å¤‡é›†åˆ"]
        BD2["åˆ†å‰²è®¾å¤‡: è·¯ç”±å™¨ã€VLAN"]
    end
    
    style CD fill:#ffebee,stroke:#d32f2f,stroke-width:2px,color:#b71c1c
    style BD fill:#e3f2fd,stroke:#1976d2,stroke-width:2px,color:#0d47a1
```

#### **è®¾å¤‡å¯¹å†²çªåŸŸå’Œå¹¿æ’­åŸŸçš„å½±å“åˆ†æ**

```mermaid
flowchart TD
    A["ç½‘ç»œè®¾å¤‡"] --> B["ä¸­ç»§å™¨/é›†çº¿å™¨"]
    A --> C["ç½‘æ¡¥/äº¤æ¢æœº"]
    A --> D["è·¯ç”±å™¨"]
    A --> E["VLANäº¤æ¢æœº"]
    
    B --> B1["å†²çªåŸŸ: ä¸åˆ†å‰²"]
    B --> B2["å¹¿æ’­åŸŸ: ä¸åˆ†å‰²"]
    
    C --> C1["å†²çªåŸŸ: åˆ†å‰²"]
    C --> C2["å¹¿æ’­åŸŸ: ä¸åˆ†å‰²"]
    
    D --> D1["å†²çªåŸŸ: åˆ†å‰²"]
    D --> D2["å¹¿æ’­åŸŸ: åˆ†å‰²"]
    
    E --> E1["å†²çªåŸŸ: åˆ†å‰²"]
    E --> E2["å¹¿æ’­åŸŸ: åˆ†å‰²"]
    
    style B1 fill:#ffebee,stroke:#d32f2f,stroke-width:2px,color:#b71c1c
    style B2 fill:#ffebee,stroke:#d32f2f,stroke-width:2px,color:#b71c1c
    style C1 fill:#e8f5e8,stroke:#2e7d32,stroke-width:2px,color:#1b5e20
    style C2 fill:#ffebee,stroke:#d32f2f,stroke-width:2px,color:#b71c1c
    style D1 fill:#e8f5e8,stroke:#2e7d32,stroke-width:2px,color:#1b5e20
    style D2 fill:#e8f5e8,stroke:#2e7d32,stroke-width:2px,color:#1b5e20
    style E1 fill:#e8f5e8,stroke:#2e7d32,stroke-width:2px,color:#1b5e20
    style E2 fill:#e8f5e8,stroke:#2e7d32,stroke-width:2px,color:#1b5e20
```

**è®¾å¤‡å½±å“å¯¹æ¯”è¡¨**ï¼š

| è®¾å¤‡ | å†²çªåŸŸ | å¹¿æ’­åŸŸ | ä¸»è¦ç‰¹ç‚¹ | åº”ç”¨åœºæ™¯ |
|------|-------|-------|---------|---------|
| **ä¸­ç»§å™¨/é›†çº¿å™¨** | âŒ ä¸åˆ†å‰² | âŒ ä¸åˆ†å‰² | ç‰©ç†å±‚è®¾å¤‡ï¼Œç®€å•ä¿¡å·æ”¾å¤§ | å°å‹ç½‘ç»œã€ä¿¡å·å»¶é•¿ |
| **ç½‘æ¡¥/äº¤æ¢æœº** | âœ… åˆ†å‰² | âŒ ä¸åˆ†å‰² | æ•°æ®é“¾è·¯å±‚è®¾å¤‡ï¼ŒMACå­¦ä¹  | å±€åŸŸç½‘å†…éƒ¨äº¤æ¢ |
| **è·¯ç”±å™¨** | âœ… åˆ†å‰² | âœ… åˆ†å‰² | ç½‘ç»œå±‚è®¾å¤‡ï¼ŒIPè·¯ç”± | ç½‘ç»œé—´äº’è¿ |
| **VLANäº¤æ¢æœº** | âœ… åˆ†å‰² | âœ… åˆ†å‰² | æ”¯æŒVLANçš„äºŒå±‚è®¾å¤‡ | è™šæ‹Ÿç½‘ç»œåˆ’åˆ† |

---

## 9.2 ç‰©ç†å±‚è®¾å¤‡è¯¦è§£

### ä¸­ç»§å™¨ï¼ˆRepeaterï¼‰

#### **å·¥ä½œåŸç†**

```mermaid
flowchart LR
    A["å‘é€ç«¯"] --> B["ä¼ è¾“ä»‹è´¨"]
    B --> C["ä¿¡å·è¡°å‡"]
    C --> D["ä¸­ç»§å™¨"]
    D --> E["ä¿¡å·å†ç”Ÿ"]
    E --> F["æ¥æ”¶ç«¯"]
    
    style A fill:#e3f2fd,stroke:#1976d2,stroke-width:2px,color:#0d47a1
    style F fill:#e8f5e8,stroke:#2e7d32,stroke-width:2px,color:#1b5e20
    style D fill:#fff3e0,stroke:#f57c00,stroke-width:2px,color:#e65100
```

#### **æŠ€æœ¯ç‰¹æ€§**
- **å·¥ä½œå±‚æ¬¡**ï¼šç‰©ç†å±‚ï¼ˆç¬¬1å±‚ï¼‰
- **è½¬å‘æ–¹å¼**ï¼šæ¯”ç‰¹çº§ä¿¡å·å†ç”Ÿ
- **å»¶è¿Ÿç‰¹æ€§**ï¼šçº¦ä¸ºå‡ ä¸ªæ¯”ç‰¹æ—¶é—´
- **è·ç¦»æ‰©å±•**ï¼šå¯å»¶é•¿ç½‘ç»œä¼ è¾“è·ç¦»

#### **åº”ç”¨åœºæ™¯**

```mermaid
graph LR
    A["PC A"] ---|"100m"| B["ä¸­ç»§å™¨"]
    B ---|"100m"| C["PC B"]
    
    style A fill:#e3f2fd,stroke:#1976d2,stroke-width:2px,color:#0d47a1
    style C fill:#e3f2fd,stroke:#1976d2,stroke-width:2px,color:#0d47a1
    style B fill:#fff3e0,stroke:#f57c00,stroke-width:2px,color:#e65100
```

> **è·ç¦»å»¶é•¿æ•ˆæœ**ï¼šå•æ®µæœ€å¤§ä¼ è¾“è·ç¦»ä»100må»¶é•¿åˆ°200mï¼Œæœ‰æ•ˆè§£å†³äº†é•¿è·ç¦»ä¼ è¾“ä¸­çš„ä¿¡å·è¡°å‡é—®é¢˜ã€‚

### é›†çº¿å™¨ï¼ˆHubï¼‰

#### **å·¥ä½œåŸç†**
> **é›†çº¿å™¨æœ¬è´¨**ï¼šå¤šç«¯å£ä¸­ç»§å™¨ï¼Œå·¥ä½œåœ¨ç‰©ç†å±‚ï¼Œé‡‡ç”¨åŠåŒå·¥é€šä¿¡æ–¹å¼ã€‚

#### **æŠ€æœ¯ç‰¹æ€§**

##### **å…±äº«å¸¦å®½æœºåˆ¶**
```mermaid
pie title é›†çº¿å™¨å¸¦å®½åˆ†é…(10Mbpsæ€»å¸¦å®½/8ç«¯å£)
    "ç«¯å£1" : 12.5
    "ç«¯å£2" : 12.5
    "ç«¯å£3" : 12.5
    "ç«¯å£4" : 12.5
    "ç«¯å£5" : 12.5
    "ç«¯å£6" : 12.5
    "ç«¯å£7" : 12.5
    "ç«¯å£8" : 12.5
```

> **å¸¦å®½è®¡ç®—**ï¼šæ¯ç«¯å£ç†è®ºæœ€å¤§å¸¦å®½ = 10Mbps Ã· 8 = 1.25Mbps

##### **CSMA/CDå†²çªæ£€æµ‹æœºåˆ¶**
```mermaid
sequenceDiagram
    participant A as ç«™ç‚¹A
    participant M as ä¼ è¾“ä»‹è´¨
    participant B as ç«™ç‚¹B
    participant C as ç«™ç‚¹C
    
    Note over A,C: 1. è½½æ³¢ä¾¦å¬(CS)
    A->>M: ä¾¦å¬ä»‹è´¨æ˜¯å¦ç©ºé—²
    M-->>A: ä»‹è´¨ç©ºé—²
    
    Note over A,C: 2. å¤šè·¯è®¿é—®(MA)
    A->>M: å¼€å§‹å‘é€æ•°æ®
    B->>M: åŒæ—¶å¼€å§‹å‘é€æ•°æ®
    
    Note over A,C: 3. å†²çªæ£€æµ‹(CD)
    M->>A: æ£€æµ‹åˆ°å†²çªä¿¡å·
    M->>B: æ£€æµ‹åˆ°å†²çªä¿¡å·
    
    Note over A,C: 4. æŒ‡æ•°é€€é¿
    A->>A: åœæ­¢å‘é€ï¼Œè®¡ç®—é€€é¿æ—¶é—´
    B->>B: åœæ­¢å‘é€ï¼Œè®¡ç®—é€€é¿æ—¶é—´
    
    Note over A,C: 5. é‡æ–°å°è¯•
    A->>M: ç­‰å¾…åé‡æ–°å‘é€
```

#### **æ€§èƒ½é™åˆ¶**
- **åŠåŒå·¥é€šä¿¡**ï¼šä¸èƒ½åŒæ—¶å‘é€å’Œæ¥æ”¶
- **å†²çªåŸŸæ‰©å¤§**ï¼šæ‰€æœ‰ç«¯å£å±äºåŒä¸€å†²çªåŸŸ
- **æ€§èƒ½ä¸‹é™**ï¼šèŠ‚ç‚¹å¢åŠ å¯¼è‡´å†²çªæ¦‚ç‡ä¸Šå‡

### ç°ä»£åº”ç”¨åœºæ™¯

#### **å·¥ä¸šä»¥å¤ªç½‘åº”ç”¨**

```mermaid
graph TD
    subgraph å·¥ä¸šç°åœº["å·¥ä¸šç°åœºç½‘ç»œ"]
        H["å·¥ä¸šé›†çº¿å™¨"]
        S1["ä¼ æ„Ÿå™¨1"]
        S2["ä¼ æ„Ÿå™¨2"]
        S3["ä¼ æ„Ÿå™¨3"]
        PLC["PLCæ§åˆ¶å™¨"]
        HMI["HMIç•Œé¢"]
    end
    
    H --- S1
    H --- S2
    H --- S3
    H --- PLC
    H --- HMI
    
    style H fill:#fff3e0,stroke:#f57c00,stroke-width:2px,color:#e65100
    style PLC fill:#e3f2fd,stroke:#1976d2,stroke-width:2px,color:#0d47a1
```

> **å·¥ä¸šåº”ç”¨ä¼˜åŠ¿**ï¼šé›†çº¿å™¨åœ¨å·¥ä¸šç¯å¢ƒä¸­æä¾›äº†ç®€å•å¯é çš„è¿æ¥æ–¹å¼ï¼Œé€‚åˆå¯¹å®æ—¶æ€§è¦æ±‚ä¸é«˜ä½†å¯¹ç¨³å®šæ€§è¦æ±‚è¾ƒé«˜çš„åœºæ™¯ã€‚

---

## 9.3 æ•°æ®é“¾è·¯å±‚è®¾å¤‡è¯¦è§£

### ç½‘æ¡¥ï¼ˆBridgeï¼‰

#### **æ ¸å¿ƒåŠŸèƒ½**
1. **MACåœ°å€å­¦ä¹ æœºåˆ¶**

```mermaid
flowchart TD
    A["æ¥æ”¶åˆ°å¸§"] --> B["æå–æºMACåœ°å€"]
    B --> C["æ›´æ–°MACåœ°å€è¡¨"]
    C --> D["æå–ç›®çš„MACåœ°å€"]
    D --> E{"ç›®çš„MACåœ¨è¡¨ä¸­ï¼Ÿ"}
    
    E -->|æ˜¯| F["è·å–è¾“å‡ºç«¯å£"]
    E -->|å¦| G["æ³›æ´ªè½¬å‘"]
    
    F --> H{"è¾“å‡ºç«¯å£â‰ è¾“å…¥ç«¯å£ï¼Ÿ"}
    H -->|æ˜¯| I["å•æ’­è½¬å‘"]
    H -->|å¦| J["ä¸¢å¼ƒå¸§"]
    
    style A fill:#e3f2fd,stroke:#1976d2,stroke-width:2px,color:#0d47a1
    style C fill:#e8f5e8,stroke:#2e7d32,stroke-width:2px,color:#1b5e20
    style G fill:#fff3e0,stroke:#f57c00,stroke-width:2px,color:#e65100
    style I fill:#e8f5e8,stroke:#2e7d32,stroke-width:2px,color:#1b5e20
    style J fill:#ffebee,stroke:#d32f2f,stroke-width:2px,color:#b71c1c
```

**MACåœ°å€å­¦ä¹ ç¤ºä¾‹**ï¼š
```mermaid
sequenceDiagram
    participant PC1 as PC1
    participant Bridge as ç½‘æ¡¥
    participant PC2 as PC2
    participant Table as MACè¡¨
    
    Note over PC1,Table: åˆå§‹çŠ¶æ€: MACè¡¨ä¸ºç©º
    
    PC1->>Bridge: å‘é€å¸§ Aâ†’B
    Bridge->>Table: å­¦ä¹  MAC A
    Bridge->>PC2: æ³›æ´ªè½¬å‘
    
    PC2->>Bridge: å›å¤å¸§ Bâ†’A
    Bridge->>Table: å­¦ä¹  MAC B
    Bridge->>PC1: ç›´æ¥è½¬å‘
    
    Note over PC1,Table: åç»­é€šä¿¡ç›´æ¥è½¬å‘
```

2. **ç”Ÿæˆæ ‘åè®®ï¼ˆSTPï¼‰**

```mermaid
stateDiagram-v2
    [*] --> å¯åŠ¨
    å¯åŠ¨ --> é€‰ä¸¾æ ¹æ¡¥
    é€‰ä¸¾æ ¹æ¡¥ --> è®¡ç®—è·¯å¾„æˆæœ¬
    è®¡ç®—è·¯å¾„æˆæœ¬ --> ç¡®å®šç«¯å£è§’è‰²
    ç¡®å®šç«¯å£è§’è‰² --> ç«¯å£çŠ¶æ€è½¬æ¢
    ç«¯å£çŠ¶æ€è½¬æ¢ --> å½¢æˆæ— ç¯æ‹“æ‰‘
    
    state ç«¯å£çŠ¶æ€è½¬æ¢ {
        Blocking --> Listening : 15ç§’
        Listening --> Learning : 15ç§’
        Learning --> Forwarding : 15ç§’
        Forwarding --> Blocking : æ£€æµ‹åˆ°æ›´ä¼˜è·¯å¾„
    }
    
    å½¢æˆæ— ç¯æ‹“æ‰‘ --> [*]
```

**STPå·¥ä½œç¤ºä¾‹**ï¼š
```mermaid
graph TD
    subgraph "STPæ‹“æ‰‘ç¤ºä¾‹"
        RB["æ ¹æ¡¥"]
        B1["ç½‘æ¡¥1"]
        B2["ç½‘æ¡¥2"]
        B3["ç½‘æ¡¥3"]
    end
    
    RB ---|"æ ¹ç«¯å£"| B1
    RB ---|"æ ¹ç«¯å£"| B2
    B1 ---|"æŒ‡å®šç«¯å£"| B3
    B2 -.->|"é˜»å¡ç«¯å£"| B3
    
    style RB fill:#e8f5e8,stroke:#2e7d32,stroke-width:2px,color:#1b5e20
    style B1 fill:#e3f2fd,stroke:#1976d2,stroke-width:2px,color:#0d47a1
    style B2 fill:#e3f2fd,stroke:#1976d2,stroke-width:2px,color:#0d47a1
    style B3 fill:#e3f2fd,stroke:#1976d2,stroke-width:2px,color:#0d47a1
```

#### **ç½‘æ¡¥ç±»å‹**
1. **é€æ˜ç½‘æ¡¥**
   - å³æ’å³ç”¨ï¼Œæ— éœ€é…ç½®
   - è‡ªåŠ¨å­¦ä¹ MACåœ°å€
   - æ”¯æŒç”Ÿæˆæ ‘åè®®

2. **æºè·¯ç”±ç½‘æ¡¥**
   - è·¯å¾„ä¿¡æ¯åŒ…å«åœ¨å¸§ä¸­
   - ä¸»è¦ç”¨äºä»¤ç‰Œç¯ç½‘ç»œ
   - éœ€è¦ç«¯ç«™å‚ä¸è·¯ç”±å†³ç­–

### äº¤æ¢æœºï¼ˆSwitchï¼‰

#### **æ ¸å¿ƒæŠ€æœ¯**
1. **MACåœ°å€è¡¨ç®¡ç†**

```mermaid
erDiagram
    MAC_TABLE {
        string MAC_Address PK
        int Port_Number
        int VLAN_ID
        int Aging_Timer
        datetime Last_Update
        string Status
    }
    
    PORT {
        int Port_Number PK
        string Port_Type
        string Port_Status
        int Speed_Mbps
    }
    
    VLAN {
        int VLAN_ID PK
        string VLAN_Name
        string VLAN_Status
    }
    
    MAC_TABLE ||--o{ PORT : "belongs_to"
    MAC_TABLE ||--o{ VLAN : "in"
```

**MACåœ°å€è¡¨ç¤ºä¾‹**ï¼š

| MAC Address | Port | VLAN | Aging(s) | Status | Description |
|-------------|------|------|----------|--------|-------------|
| `00:11:22:33:44:55` | 1 | 10 | 300 | Active | é”€å”®éƒ¨é—¨PC |
| `00:aa:bb:cc:dd:ee` | 2 | 20 | 280 | Active | å·¥ç¨‹éƒ¨é—¨PC |
| `00:ff:ee:dd:cc:bb` | 3 | 10 | 150 | Active | é”€å”®éƒ¨é—¨æ‰“å°æœº |
| `00:12:34:56:78:90` | 24 | ALL | 300 | Trunk | ä¸Šè”äº¤æ¢æœº |

**è€åŒ–æœºåˆ¶**ï¼š
```mermaid
flowchart LR
    A["MACåœ°å€å­¦ä¹ "] --> B["é‡ç½®è€åŒ–è®¡æ—¶å™¨<br/>Timer = 300s"]
    B --> C["å®šæœŸæ£€æŸ¥<br/>Timer--"]
    C --> D{"Timer = 0?"}
    D -->|å¦| C
    D -->|æ˜¯| E["åˆ é™¤MACæ¡ç›®"]
    
    style A fill:#e8f5e8,stroke:#2e7d32,stroke-width:2px,color:#1b5e20
    style E fill:#ffebee,stroke:#d32f2f,stroke-width:2px,color:#b71c1c
```

2. **å¸§è½¬å‘æ–¹å¼**
   - **å­˜å‚¨è½¬å‘**ï¼šæ¥æ”¶å®Œæ•´å¸§åè½¬å‘
   - **ç›´é€šè½¬å‘**ï¼šè¯»å–ç›®çš„åœ°å€åç«‹å³è½¬å‘
   - **å…åˆ†ç‰‡è½¬å‘**ï¼šæ··åˆæ¨¡å¼ï¼Œæ£€æµ‹é”™è¯¯å¸§

3. **VLANæ”¯æŒ**
   ```cisco
   # VLANé…ç½®ç¤ºä¾‹
   vlan 10
    name Sales
   vlan 20
    name Engineering
   
   interface FastEthernet0/1
    switchport mode access
    switchport access vlan 10
   
   interface FastEthernet0/24
    switchport mode trunk
    switchport trunk allowed vlan 10,20
   ```

#### **äº¤æ¢æŠ€æœ¯ä¼˜åŠ¿å¯¹æ¯”**

```mermaid
graph TB
    subgraph "é›†çº¿å™¨ç‰¹æ€§"
        H1["ç‰©ç†å±‚è®¾å¤‡"]
        H2["åŠåŒå·¥é€šä¿¡"]
        H3["å…±äº«å†²çªåŸŸ"]
        H4["å…±äº«å¸¦å®½"]
        H5["å®‰å…¨æ€§è¾ƒä½"]
        H6["ä»·æ ¼ä¾¿å®œ"]
    end
    
    subgraph "äº¤æ¢æœºç‰¹æ€§"
        S1["æ•°æ®é“¾è·¯å±‚è®¾å¤‡"]
        S2["å…¨åŒå·¥é€šä¿¡"]
        S3["æ¯ç«¯å£ç‹¬ç«‹å†²çªåŸŸ"]
        S4["ç‹¬äº«å¸¦å®½"]
        S5["å®‰å…¨æ€§è¾ƒé«˜"]
        S6["ä»·æ ¼ç›¸å¯¹è¾ƒè´µ"]
    end
    
    H1 -.->|å‡çº§| S1
    H2 -.->|æ”¹è¿›| S2
    H3 -.->|åˆ†å‰²| S3
    H4 -.->|ä¼˜åŒ–| S4
    H5 -.->|å¢å¼º| S5
    H6 -.->|æ€§ä»·æ¯”| S6
    
    style H1 fill:#ffebee,stroke:#d32f2f,stroke-width:2px,color:#b71c1c
    style H2 fill:#ffebee,stroke:#d32f2f,stroke-width:2px,color:#b71c1c
    style H3 fill:#ffebee,stroke:#d32f2f,stroke-width:2px,color:#b71c1c
    style H4 fill:#ffebee,stroke:#d32f2f,stroke-width:2px,color:#b71c1c
    style H5 fill:#ffebee,stroke:#d32f2f,stroke-width:2px,color:#b71c1c
    style H6 fill:#e8f5e8,stroke:#2e7d32,stroke-width:2px,color:#1b5e20
    
    style S1 fill:#e8f5e8,stroke:#2e7d32,stroke-width:2px,color:#1b5e20
    style S2 fill:#e8f5e8,stroke:#2e7d32,stroke-width:2px,color:#1b5e20
    style S3 fill:#e8f5e8,stroke:#2e7d32,stroke-width:2px,color:#1b5e20
    style S4 fill:#e8f5e8,stroke:#2e7d32,stroke-width:2px,color:#1b5e20
    style S5 fill:#e8f5e8,stroke:#2e7d32,stroke-width:2px,color:#1b5e20
    style S6 fill:#ffebee,stroke:#d32f2f,stroke-width:2px,color:#b71c1c
```

**è¯¦ç»†å¯¹æ¯”è¡¨**ï¼š

| ç‰¹æ€§ | é›†çº¿å™¨ | äº¤æ¢æœº | ä¼˜åŠ¿åˆ†æ |
|------|--------|--------|----------|
| **å·¥ä½œå±‚æ¬¡** | ç‰©ç†å±‚(L1) | æ•°æ®é“¾è·¯å±‚(L2) | äº¤æ¢æœºå¯å¤„ç†MACåœ°å€ |
| **é€šä¿¡æ–¹å¼** | åŠåŒå·¥ | å…¨åŒå·¥ | äº¤æ¢æœºæ”¯æŒåŒæ—¶æ”¶å‘ |
| **å†²çªåŸŸ** | å…±äº«1ä¸ª | æ¯ç«¯å£1ä¸ª | äº¤æ¢æœºå½»åº•æ¶ˆé™¤å†²çª |
| **å¹¿æ’­åŸŸ** | 1ä¸ª | 1ä¸ª(å¯VLANåˆ†å‰²) | äº¤æ¢æœºæ”¯æŒè™šæ‹Ÿåˆ†å‰² |
| **å¸¦å®½** | æ€»å¸¦å®½å…±äº« | æ¯ç«¯å£ç‹¬äº« | äº¤æ¢æœºæ€»å¸¦å®½æˆå€å¢åŠ  |
| **å®‰å…¨æ€§** | æ•°æ®å¯è¢«ç›‘å¬ | ç‚¹å¯¹ç‚¹ä¼ è¾“ | äº¤æ¢æœºæä¾›æ›´å¥½éš”ç¦» |
| **æ™ºèƒ½åŒ–** | æ—  | MACå­¦ä¹ ã€VLANç­‰ | äº¤æ¢æœºåŠŸèƒ½ä¸°å¯Œ |
| **ä»·æ ¼** | ä½ | ç›¸å¯¹é«˜ | æ€§ä»·æ¯”ä¸æ–­æ”¹å–„ |

---

## 9.4 ç½‘ç»œå±‚è®¾å¤‡è¯¦è§£

### è·¯ç”±å™¨ï¼ˆRouterï¼‰

#### **æ ¸å¿ƒåŠŸèƒ½æ¨¡å—æ¶æ„**

```mermaid
graph TB
    subgraph MP["ç®¡ç†å¹³é¢"]
        CM["é…ç½®ç®¡ç†"]
        MM["ç›‘æ§è¯Šæ–­"]
        NM["ç½‘ç»œç®¡ç†"]
    end
    
    subgraph CP["æ§åˆ¶å¹³é¢"]
        RP["è·¯ç”±åè®®"]
        ARP["ARPåè®®"]
        ICMP["ICMPåè®®"]
        RT["è·¯ç”±è¡¨"]
    end
    
    subgraph DP["æ•°æ®å¹³é¢"]
        PF["åŒ…è½¬å‘"]
        QM["é˜Ÿåˆ—ç®¡ç†"]
        BF["ç¼“å†²åŒº"]
        IF["æ¥å£å¤„ç†"]
    end
    
    MP -.->|é…ç½®ä¸‹å‘| CP
    CP -.->|è·¯ç”±ä¿¡æ¯| DP
    DP -.->|çŠ¶æ€ä¸ŠæŠ¥| MP
    
    RP --> RT
    RT --> PF
    
    style MP fill:#e3f2fd,stroke:#1976d2,stroke-width:2px,color:#0d47a1
    style CP fill:#fff3e0,stroke:#f57c00,stroke-width:2px,color:#e65100
    style DP fill:#e8f5e8,stroke:#2e7d32,stroke-width:2px,color:#1b5e20
```

**å¹³é¢åŠŸèƒ½è¯¦è§£**ï¼š

| å¹³é¢ | ä¸»è¦åŠŸèƒ½ | å…³é”®åè®®/æŠ€æœ¯ | ä½œç”¨ |
|------|---------|---------------|------|
| **ç®¡ç†å¹³é¢** | è®¾å¤‡ç®¡ç†ã€é…ç½®ã€ç›‘æ§ | SNMPã€CLIã€Web | è¿ç»´ç®¡ç† |
| **æ§åˆ¶å¹³é¢** | è·¯ç”±è®¡ç®—ã€åè®®å¤„ç† | OSPFã€BGPã€RIPã€ARP | å»ºç«‹è·¯ç”±è¡¨ |
| **æ•°æ®å¹³é¢** | æ•°æ®åŒ…è½¬å‘ã€QoS | ç¡¬ä»¶è½¬å‘ã€é˜Ÿåˆ—è°ƒåº¦ | é«˜é€Ÿè½¬å‘ |

#### **è·¯ç”±è¡¨ç»“æ„**

```mermaid
erDiagram
    ROUTING_TABLE {
        string Destination_Network PK
        string Subnet_Mask
        string Next_Hop
        string Interface
        int Administrative_Distance
        int Metric
        string Protocol
        datetime Last_Update
    }
    
    INTERFACE {
        string Interface_Name PK
        string IP_Address
        string Status
        int Speed
    }
    
    PROTOCOL {
        string Protocol_Name PK
        int Default_AD
        string Type
    }
    
    ROUTING_TABLE ||--o{ INTERFACE : "uses"
    ROUTING_TABLE ||--o{ PROTOCOL : "learned_by"
```

**è·¯ç”±è¡¨ç¤ºä¾‹**ï¼š

| ç›®çš„ç½‘ç»œ | å­ç½‘æ©ç  | ä¸‹ä¸€è·³ | æ¥å£ | AD | åº¦é‡ | åè®® | ç±»å‹ |
|----------|----------|--------|------|----|----- |------|------|
| `192.168.1.0` | `/24` | - | Eth0 | 0 | 0 | Direct | ç›´è¿è·¯ç”± |
| `192.168.2.0` | `/24` | `10.1.1.2` | Eth1 | 1 | 1 | Static | é™æ€è·¯ç”± |
| `172.16.0.0` | `/16` | `10.1.1.3` | Eth1 | 110 | 20 | OSPF | åŠ¨æ€è·¯ç”± |
| `0.0.0.0` | `/0` | `10.1.1.1` | Eth1 | 1 | 1 | Static | é»˜è®¤è·¯ç”± |

**è·¯ç”±æŸ¥æ‰¾è¿‡ç¨‹**ï¼š
```mermaid
flowchart TD
    A["æ”¶åˆ°æ•°æ®åŒ…"] --> B["æå–ç›®çš„IPåœ°å€"]
    B --> C["æŸ¥æ‰¾è·¯ç”±è¡¨"]
    C --> D["æœ€é•¿å‰ç¼€åŒ¹é…"]
    D --> E{"æ‰¾åˆ°åŒ¹é…è·¯ç”±ï¼Ÿ"}
    
    E -->|æ˜¯| F["è·å–ä¸‹ä¸€è·³ä¿¡æ¯"]
    E -->|å¦| G["ä½¿ç”¨é»˜è®¤è·¯ç”±"]
    
    F --> H["ARPè§£æMACåœ°å€"]
    G --> H
    H --> I["å°è£…å¸§å¤´"]
    I --> J["ä»æŒ‡å®šæ¥å£è½¬å‘"]
    
    G --> K{"é»˜è®¤è·¯ç”±å­˜åœ¨ï¼Ÿ"}
    K -->|å¦| L["ä¸¢å¼ƒæ•°æ®åŒ…<br/>å‘é€ICMPä¸å¯è¾¾"]
    
    style A fill:#e3f2fd,stroke:#1976d2,stroke-width:2px,color:#0d47a1
    style J fill:#e8f5e8,stroke:#2e7d32,stroke-width:2px,color:#1b5e20
    style L fill:#ffebee,stroke:#d32f2f,stroke-width:2px,color:#b71c1c
```

#### **é«˜çº§è·¯ç”±åŠŸèƒ½**
1. **ç­–ç•¥è·¯ç”±**
   ```cisco
   ! åŸºäºæºåœ°å€çš„ç­–ç•¥è·¯ç”±
   access-list 10 permit 192.168.10.0 0.0.0.255
   route-map PBR permit 10
    match ip address 10
    set ip next-hop 172.16.1.1
   
   interface FastEthernet0/0
    ip policy route-map PBR
   ```

2. **è·¯ç”±é‡åˆ†å‘**
   ```cisco
   ! OSPFå’ŒRIPä¹‹é—´çš„è·¯ç”±é‡åˆ†å‘
   router ospf 1
    redistribute rip metric 20 subnets
   
   router rip
    redistribute ospf 1 metric 3
   ```

### ä¸‰å±‚äº¤æ¢æœº

#### **æŠ€æœ¯ä¼˜åŠ¿å¯¹æ¯”åˆ†æ**

```mermaid
graph LR
    subgraph Router["è·¯ç”±å™¨ (Router)"]
        R1["è½¯ä»¶è½¬å‘<br/>CPUå¤„ç†"]
        R2["ç«¯å£æ•°é‡å°‘<br/>2-8ä¸ªå¸¸è§"]
        R3["å­æ¥å£VLAN<br/>é€»è¾‘åˆ†å‰²"]
        R4["WANæ¥å£ä¸°å¯Œ<br/>ä¸²è¡Œ/å…‰çº¤"]
        R5["åè®®æ”¯æŒå…¨é¢<br/>BGP/OSPFç­‰"]
    end
    
    subgraph L3SW["ä¸‰å±‚äº¤æ¢æœº (Layer 3 Switch)"]
        S1["ç¡¬ä»¶è½¬å‘<br/>ASICèŠ¯ç‰‡"]
        S2["ç«¯å£å¯†åº¦é«˜<br/>24-48ä¸ªå¸¸è§"]
        S3["åŸç”ŸVLAN<br/>ç¡¬ä»¶æ”¯æŒ"]
        S4["LANæ¥å£ä¸ºä¸»<br/>ä»¥å¤ªç½‘ç«¯å£"]
        S5["å±€åŸŸç½‘ä¼˜åŒ–<br/>å¿«é€Ÿæ”¶æ•›"]
    end
    
    R1 -.->|æ€§èƒ½æå‡| S1
    R2 -.->|å¯†åº¦å¢åŠ | S2
    R3 -.->|åŠŸèƒ½å¢å¼º| S3
    
    style Router fill:#e3f2fd,stroke:#1976d2,stroke-width:2px,color:#0d47a1
    style L3SW fill:#e8f5e8,stroke:#2e7d32,stroke-width:2px,color:#1b5e20
```

**è¯¦ç»†æ€§èƒ½å¯¹æ¯”**ï¼š

| å¯¹æ¯”ç»´åº¦ | è·¯ç”±å™¨ | ä¸‰å±‚äº¤æ¢æœº | é€‚ç”¨åœºæ™¯ |
|----------|--------|------------|----------|
| **è½¬å‘æ€§èƒ½** | è½¯ä»¶è½¬å‘ï¼Œå‡ Mpps | ç¡¬ä»¶è½¬å‘ï¼Œå‡ åMpps | é«˜æ€§èƒ½è¦æ±‚é€‰æ‹©ä¸‰å±‚äº¤æ¢æœº |
| **ç«¯å£å¯†åº¦** | 2-16ä¸ªç«¯å£ | 24-48ä¸ªç«¯å£ | å¤§é‡ç»ˆç«¯æ¥å…¥é€‰æ‹©ä¸‰å±‚äº¤æ¢æœº |
| **VLANæ”¯æŒ** | å­æ¥å£æ–¹å¼ï¼Œé…ç½®å¤æ‚ | åŸç”Ÿæ”¯æŒï¼Œé…ç½®ç®€å• | VLANéœ€æ±‚é€‰æ‹©ä¸‰å±‚äº¤æ¢æœº |
| **WANæ”¯æŒ** | ä¸°å¯Œçš„WANæ¥å£ | ä¸»è¦æ˜¯LANæ¥å£ | å¹¿åŸŸç½‘è¿æ¥å¿…é¡»ä½¿ç”¨è·¯ç”±å™¨ |
| **åè®®æ”¯æŒ** | å…¨é¢(BGP/OSPF/RIPç­‰) | å±€åŸŸç½‘ä¼˜åŒ– | å¤æ‚è·¯ç”±é€‰æ‹©è·¯ç”±å™¨ |
| **ä»·æ ¼** | ç›¸å¯¹ä¾¿å®œ | ç›¸å¯¹æ˜‚è´µ | æ ¹æ®é¢„ç®—å’Œéœ€æ±‚å¹³è¡¡ |
| **åº”ç”¨åœºæ™¯** | ç½‘ç»œè¾¹ç•Œã€WANè¿æ¥ | ç½‘ç»œæ ¸å¿ƒã€é«˜å¯†åº¦æ¥å…¥ | åˆ†å±‚è®¾è®¡ä¸­åŠŸèƒ½å®šä½ä¸åŒ |

**é€‰æ‹©å†³ç­–æ ‘**ï¼š
```mermaid
flowchart TD
    A["ç½‘ç»œè®¾å¤‡é€‰æ‹©"] --> B{"éœ€è¦WANè¿æ¥ï¼Ÿ"}
    B -->|æ˜¯| C["è·¯ç”±å™¨"]
    B -->|å¦| D{"ç«¯å£æ•°é‡éœ€æ±‚ï¼Ÿ"}
    
    D -->|>16ä¸ª| E["ä¸‰å±‚äº¤æ¢æœº"]
    D -->|â‰¤16ä¸ª| F{"è½¬å‘æ€§èƒ½è¦æ±‚ï¼Ÿ"}
    
    F -->|é«˜| E
    F -->|ä¸€èˆ¬| G{"é¢„ç®—è€ƒè™‘ï¼Ÿ"}
    
    G -->|ç´§å¼ | C
    G -->|å……è¶³| E
    
    style C fill:#e3f2fd,stroke:#1976d2,stroke-width:2px,color:#0d47a1
    style E fill:#e8f5e8,stroke:#2e7d32,stroke-width:2px,color:#1b5e20
```

---

## 9.5 è®¾å¤‡æ€§èƒ½å¯¹æ¯”åˆ†æ

### è½¬å‘æ€§èƒ½æŒ‡æ ‡

#### **åŒ…è½¬å‘ç‡ï¼ˆPPSï¼‰**
```
ç†è®ºPPSè®¡ç®—ï¼š
æœ€å°ä»¥å¤ªç½‘å¸§ï¼š64å­—èŠ‚
å¸§é—´éš™ï¼š12å­—èŠ‚
å‰å¯¼ç ï¼š8å­—èŠ‚
æ€»å¼€é”€ï¼š64 + 12 + 8 = 84å­—èŠ‚

åƒå…†ä»¥å¤ªç½‘æœ€å¤§PPSï¼š
1,000,000,000 bps Ã· (84 Ã— 8) bits = 1,488,095 pps
```

#### **è®¾å¤‡æ€§èƒ½å¯¹æ¯”åˆ†æ**

```mermaid
graph TB
    subgraph Performance["è®¾å¤‡æ€§èƒ½æ¼”è¿›"]
        Hub["é›†çº¿å™¨<br/>10Mbpså…±äº«"]
        Switch["äº¤æ¢æœº<br/>100Mbps/ç«¯å£"]
        Router["è·¯ç”±å™¨<br/>1-10Gbps"]
        L3Switch["ä¸‰å±‚äº¤æ¢æœº<br/>10-100Gbps"]
    end
    
    Hub -->|æ€§èƒ½å‡çº§| Switch
    Switch -->|æ™ºèƒ½å‡çº§| Router
    Router -->|ç¡¬ä»¶å‡çº§| L3Switch
    
    style Hub fill:#ffebee,stroke:#d32f2f,stroke-width:2px,color:#b71c1c
    style Switch fill:#fff3e0,stroke:#f57c00,stroke-width:2px,color:#e65100
    style Router fill:#e3f2fd,stroke:#1976d2,stroke-width:2px,color:#0d47a1
    style L3Switch fill:#e8f5e8,stroke:#2e7d32,stroke-width:2px,color:#1b5e20
```

**æ€§èƒ½æŒ‡æ ‡è¯¦ç»†å¯¹æ¯”**ï¼š

| è®¾å¤‡ | ååé‡ | å»¶è¿Ÿ | PPS | å¤„ç†æ–¹å¼ | é€‚ç”¨è§„æ¨¡ |
|------|--------|------|-----|----------|----------|
| **é›†çº¿å™¨** | 10Mbps(å…±äº«) | <10Î¼s | 14.88K | ç‰©ç†å±‚è½¬å‘ | å°å‹ç½‘ç»œ |
| **äº¤æ¢æœº** | 100Mbps/ç«¯å£ | <10Î¼s | 148.8K | äºŒå±‚ç¡¬ä»¶è½¬å‘ | ä¸­å‹å±€åŸŸç½‘ |
| **è·¯ç”±å™¨** | 1-10Gbps | 1-10ms | 1.48M | ä¸‰å±‚è½¯ä»¶è½¬å‘ | å¹¿åŸŸç½‘è¿æ¥ |
| **ä¸‰å±‚äº¤æ¢æœº** | 10-100Gbps | <10Î¼s | 14.88M | ä¸‰å±‚ç¡¬ä»¶è½¬å‘ | å¤§å‹ä¼ä¸šç½‘ |

**PPSè®¡ç®—æ–¹æ³•**ï¼š
```mermaid
flowchart LR
    A["æœ€å°å¸§64å­—èŠ‚"] --> B["åŠ ä¸Šå¼€é”€20å­—èŠ‚"]
    B --> C["æ€»è®¡84å­—èŠ‚"]
    C --> D["è½¬æ¢ä¸ºæ¯”ç‰¹ï¼š84Ã—8=672bit"]
    D --> E["PPS = å¸¦å®½(bps) Ã· 672"]
    
    style A fill:#e3f2fd,stroke:#1976d2,stroke-width:2px,color:#0d47a1
    style E fill:#e8f5e8,stroke:#2e7d32,stroke-width:2px,color:#1b5e20
```

**å»¶è¿Ÿæ„æˆåˆ†æ**ï¼š
```mermaid
pie title ç½‘ç»œè®¾å¤‡å»¶è¿Ÿæ„æˆ
    "ä¼ æ’­å»¶è¿Ÿ" : 30
    "ä¼ è¾“å»¶è¿Ÿ" : 25
    "æ’é˜Ÿå»¶è¿Ÿ" : 25
    "å¤„ç†å»¶è¿Ÿ" : 20
```

> **æ€§èƒ½ä¼˜åŒ–å»ºè®®**ï¼š
> - å±€åŸŸç½‘å†…ä¼˜å…ˆé€‰æ‹©äº¤æ¢æœºå’Œä¸‰å±‚äº¤æ¢æœº
> - å¹¿åŸŸç½‘è¿æ¥å¿…é¡»ä½¿ç”¨è·¯ç”±å™¨
> - é«˜æ€§èƒ½åœºæ™¯è€ƒè™‘ç¡¬ä»¶è½¬å‘è®¾å¤‡
> - æ ¹æ®å®é™…æµé‡é€‰æ‹©åˆé€‚çš„ç«¯å£é€Ÿç‡

### åŠŸèƒ½ç‰¹æ€§å¯¹æ¯”

#### **åè®®æ”¯æŒçŸ©é˜µ**

```mermaid
graph TB
    subgraph Devices["ç½‘ç»œè®¾å¤‡"]
        Hub["é›†çº¿å™¨"]
        Bridge["ç½‘æ¡¥"]
        Switch["äº¤æ¢æœº"]
        Router["è·¯ç”±å™¨"]
        L3SW["ä¸‰å±‚äº¤æ¢æœº"]
    end
    
    subgraph Protocols["åè®®åŠŸèƒ½"]
        MAC["MACå­¦ä¹ "]
        VLAN["VLANæ”¯æŒ"]
        STP["STPåè®®"]
        Routing["è·¯ç”±åè®®"]
        NAT["NATè½¬æ¢"]
        QoS["QoSæ”¯æŒ"]
    end
    
    Bridge --> MAC
    Switch --> MAC
    L3SW --> MAC
    
    Switch --> VLAN
    L3SW --> VLAN
    
    Bridge --> STP
    Switch --> STP
    L3SW --> STP
    
    Router --> Routing
    L3SW --> Routing
    
    Router --> NAT
    L3SW --> NAT
    
    Router --> QoS
    L3SW --> QoS
    
    style Hub fill:#ffebee,stroke:#d32f2f,stroke-width:2px,color:#b71c1c
    style Bridge fill:#fff3e0,stroke:#f57c00,stroke-width:2px,color:#e65100
    style Switch fill:#e3f2fd,stroke:#1976d2,stroke-width:2px,color:#0d47a1
    style Router fill:#e8f5e8,stroke:#2e7d32,stroke-width:2px,color:#1b5e20
    style L3SW fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px,color:#4a148c
```

**åŠŸèƒ½æ”¯æŒè¯¦ç»†å¯¹æ¯”**ï¼š

| åè®®/åŠŸèƒ½ | é›†çº¿å™¨ | ç½‘æ¡¥ | äº¤æ¢æœº | è·¯ç”±å™¨ | ä¸‰å±‚äº¤æ¢æœº | å®ç°å¤æ‚åº¦ |
|-----------|--------|------|--------|--------|------------|------------|
| **MACå­¦ä¹ ** | âŒ | âœ… | âœ… | âŒ | âœ… | ä¸­ç­‰ |
| **VLAN** | âŒ | ğŸ”¶ | âœ… | ğŸ”¶ | âœ… | ä¸­ç­‰ |
| **STP** | âŒ | âœ… | âœ… | âŒ | âœ… | é«˜ |
| **è·¯ç”±åè®®** | âŒ | âŒ | âŒ | âœ… | âœ… | é«˜ |
| **NAT** | âŒ | âŒ | âŒ | âœ… | âœ… | ä¸­ç­‰ |
| **QoS** | âŒ | âŒ | ğŸ”¶ | âœ… | âœ… | é«˜ |
| **ACL** | âŒ | âŒ | ğŸ”¶ | âœ… | âœ… | ä¸­ç­‰ |
| **DHCP** | âŒ | âŒ | âŒ | âœ… | âœ… | ä½ |

**å›¾ä¾‹è¯´æ˜**ï¼š
- âœ… å®Œå…¨æ”¯æŒ 
- ğŸ”¶ éƒ¨åˆ†æ”¯æŒ
- âŒ ä¸æ”¯æŒ

**åŠŸèƒ½æ¼”è¿›æ—¶åº**ï¼š
```mermaid
timeline
    title ç½‘ç»œè®¾å¤‡åŠŸèƒ½æ¼”è¿›
    
    1980s  : é›†çº¿å™¨
           : ç‰©ç†å±‚ä¿¡å·æ”¾å¤§
           : CSMA/CDæ”¯æŒ
    
    1990s  : ç½‘æ¡¥
           : MACåœ°å€å­¦ä¹ 
           : STPåè®®
           
    1990s  : äº¤æ¢æœº
           : å…¨åŒå·¥é€šä¿¡
           : VLANæ”¯æŒ
           
    2000s  : è·¯ç”±å™¨
           : ä¸‰å±‚è·¯ç”±
           : NAT/QoS
           
    2000s  : ä¸‰å±‚äº¤æ¢æœº
           : ç¡¬ä»¶è·¯ç”±
           : é«˜å¯†åº¦ç«¯å£
```

---

## 9.6 ç½‘ç»œæ¶æ„è®¾è®¡æŒ‡å—

### åˆ†å±‚ç½‘ç»œè®¾è®¡

#### **ä¸‰å±‚æ¶æ„æ¨¡å‹**

```mermaid
graph TD
    subgraph Core["æ ¸å¿ƒå±‚"]
        C1["æ ¸å¿ƒäº¤æ¢æœº1"]
        C2["æ ¸å¿ƒäº¤æ¢æœº2"]
        C1 ===|å†—ä½™é“¾è·¯| C2
    end
    
    subgraph Distribution["æ±‡èšå±‚"]
        D1["æ±‡èšäº¤æ¢æœº1"]
        D2["æ±‡èšäº¤æ¢æœº2"]
        D3["æ±‡èšè·¯ç”±å™¨"]
        D1 ---|å†—ä½™| D2
    end
    
    subgraph Access["æ¥å…¥å±‚"]
        A1["æ¥å…¥äº¤æ¢æœº1"]
        A2["æ¥å…¥äº¤æ¢æœº2"]
        A3["æ¥å…¥äº¤æ¢æœº3"]
        A4["æ— çº¿AP"]
    end
    
    subgraph Users["ç»ˆç«¯ç”¨æˆ·"]
        U1["PC"]
        U2["æœåŠ¡å™¨"]
        U3["æ‰“å°æœº"]
        U4["ç§»åŠ¨è®¾å¤‡"]
    end
    
    C1 --- D1
    C1 --- D2
    C2 --- D2
    C2 --- D1
    
    D1 --- A1
    D1 --- A2
    D2 --- A2
    D2 --- A3
    D3 --- A4
    
    A1 --- U1
    A2 --- U2
    A3 --- U3
    A4 --- U4
    
    style Core fill:#e8f5e8,stroke:#2e7d32,stroke-width:2px,color:#1b5e20
    style Distribution fill:#fff3e0,stroke:#f57c00,stroke-width:2px,color:#e65100
    style Access fill:#e3f2fd,stroke:#1976d2,stroke-width:2px,color:#0d47a1
    style Users fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px,color:#4a148c
```

**å„å±‚åŠŸèƒ½ç‰¹æ€§**ï¼š

| å±‚æ¬¡ | ä¸»è¦åŠŸèƒ½ | å…³é”®ç‰¹æ€§ | è®¾å¤‡é€‰æ‹© | è®¾è®¡åŸåˆ™ |
|------|---------|---------|----------|----------|
| **æ ¸å¿ƒå±‚** | é«˜é€Ÿè½¬å‘ã€å†—ä½™å¤‡ä»½ | é«˜å¯é æ€§ã€é«˜æ€§èƒ½ | æ ¸å¿ƒäº¤æ¢æœºã€é«˜ç«¯è·¯ç”±å™¨ | é€Ÿåº¦ä¼˜å…ˆã€é¿å…ç­–ç•¥å¤„ç† |
| **æ±‡èšå±‚** | ç­–ç•¥æ§åˆ¶ã€è·¯ç”±æ±‡èš | VLANé—´è·¯ç”±ã€QoS | ä¸‰å±‚äº¤æ¢æœºã€æ±‡èšè·¯ç”±å™¨ | ç­–ç•¥æ‰§è¡Œã€è´Ÿè½½å‡è¡¡ |
| **æ¥å…¥å±‚** | ç”¨æˆ·æ¥å…¥ã€ç«¯å£å®‰å…¨ | ç«¯å£å¯†åº¦ã€æˆæœ¬æ§åˆ¶ | æ¥å…¥äº¤æ¢æœºã€æ— çº¿AP | åŠŸèƒ½ä¸°å¯Œã€æˆæœ¬æ•æ„Ÿ |

#### **è®¾å¤‡é€‰å‹åŸåˆ™**
1. **æ ¸å¿ƒå±‚è¦æ±‚**
   - é«˜å¯é æ€§ï¼šåŒæœºçƒ­å¤‡
   - é«˜æ€§èƒ½ï¼šçº¿é€Ÿè½¬å‘
   - å¯æ‰©å±•æ€§ï¼šæ¨¡å—åŒ–è®¾è®¡

2. **æ±‡èšå±‚è¦æ±‚**
   - è·¯ç”±åŠŸèƒ½ï¼šä¸‰å±‚äº¤æ¢
   - ç­–ç•¥æ§åˆ¶ï¼šACLã€QoS
   - å†—ä½™è®¾è®¡ï¼šå¤šé“¾è·¯å¤‡ä»½

3. **æ¥å…¥å±‚è¦æ±‚**
   - ç«¯å£å¯†åº¦ï¼šæ”¯æŒè¶³å¤Ÿç”¨æˆ·
   - å®‰å…¨åŠŸèƒ½ï¼šç«¯å£å®‰å…¨ã€VLAN
   - æˆæœ¬æ§åˆ¶ï¼šæ€§ä»·æ¯”ä¼˜å…ˆ

### å®é™…ç½‘ç»œæ¡ˆä¾‹

#### **ä¼ä¸šå›­åŒºç½‘ç»œæ¡ˆä¾‹**

```mermaid
graph TB
    Internet["äº’è”ç½‘<br/>Internet"]
    
    subgraph DMZ["DMZåŒºåŸŸ"]
        FW["é˜²ç«å¢™<br/>Firewall"]
        Web["WebæœåŠ¡å™¨"]
        Mail["é‚®ä»¶æœåŠ¡å™¨"]
    end
    
    subgraph Core["æ ¸å¿ƒå±‚"]
        CS1["æ ¸å¿ƒäº¤æ¢æœº1<br/>Core-SW1"]
        CS2["æ ¸å¿ƒäº¤æ¢æœº2<br/>Core-SW2"]
        CS1 ===|å†—ä½™é“¾è·¯| CS2
    end
    
    subgraph Dist_Sales["æ±‡èšå±‚-é”€å”®éƒ¨"]
        DS1["æ±‡èšäº¤æ¢æœº1<br/>Sales-Dist-SW1"]
        DS2["æ±‡èšäº¤æ¢æœº2<br/>Sales-Dist-SW2"]
        DS1 ---|å †å | DS2
    end
    
    subgraph Dist_Engineering["æ±‡èšå±‚-å·¥ç¨‹éƒ¨"]
        DE1["æ±‡èšäº¤æ¢æœº1<br/>Eng-Dist-SW1"]
        DE2["æ±‡èšäº¤æ¢æœº2<br/>Eng-Dist-SW2"]
        DE1 ---|å †å | DE2
    end
    
    subgraph Access_Sales["æ¥å…¥å±‚-é”€å”®éƒ¨"]
        AS1["æ¥å…¥äº¤æ¢æœº1<br/>Sales-Access-SW1"]
        AS2["æ¥å…¥äº¤æ¢æœº2<br/>Sales-Access-SW2"]
        AP1["æ— çº¿AP1"]
    end
    
    subgraph Access_Engineering["æ¥å…¥å±‚-å·¥ç¨‹éƒ¨"]
        AE1["æ¥å…¥äº¤æ¢æœº1<br/>Eng-Access-SW1"]
        AE2["æ¥å…¥äº¤æ¢æœº2<br/>Eng-Access-SW2"]
        Server["æœåŠ¡å™¨æœºæŸœ"]
    end
    
    subgraph Users["ç»ˆç«¯ç”¨æˆ·"]
        U1["é”€å”®PC"]
        U2["å·¥ç¨‹å¸ˆPC"]
        U3["ç§»åŠ¨è®¾å¤‡"]
        U4["åº”ç”¨æœåŠ¡å™¨"]
    end
    
    Internet --- FW
    FW --- Web
    FW --- Mail
    FW --- CS1
    
    CS1 ---|å…‰çº¤é“¾è·¯| DS1
    CS1 ---|å¤‡ä»½é“¾è·¯| DS2
    CS2 ---|å…‰çº¤é“¾è·¯| DS2
    CS2 ---|å¤‡ä»½é“¾è·¯| DS1
    
    CS1 ---|å…‰çº¤é“¾è·¯| DE1
    CS1 ---|å¤‡ä»½é“¾è·¯| DE2
    CS2 ---|å…‰çº¤é“¾è·¯| DE2
    CS2 ---|å¤‡ä»½é“¾è·¯| DE1
    
    DS1 --- AS1
    DS2 --- AS2
    DS1 --- AP1
    
    DE1 --- AE1
    DE2 --- AE2
    DE1 --- Server
    
    AS1 --- U1
    AS2 --- U1
    AP1 -.-> U3
    
    AE1 --- U2
    AE2 --- U2
    Server --- U4
    
    style Internet fill:#ffebee,stroke:#d32f2f,stroke-width:2px,color:#b71c1c
    style DMZ fill:#fff3e0,stroke:#f57c00,stroke-width:2px,color:#e65100
    style Core fill:#e8f5e8,stroke:#2e7d32,stroke-width:3px,color:#1b5e20
    style Dist_Sales fill:#e3f2fd,stroke:#1976d2,stroke-width:2px,color:#0d47a1
    style Dist_Engineering fill:#e1f5fe,stroke:#0277bd,stroke-width:2px,color:#01579b
    style Access_Sales fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px,color:#4a148c
    style Access_Engineering fill:#fce4ec,stroke:#c2185b,stroke-width:2px,color:#880e4f
    style Users fill:#e0f2f1,stroke:#00695c,stroke-width:2px,color:#004d40
```

**ç½‘ç»œè®¾è®¡ç‰¹ç‚¹**ï¼š

| å±‚æ¬¡/åŒºåŸŸ | è®¾å¤‡é…ç½® | å†—ä½™è®¾è®¡ | VLANè§„åˆ’ | å®‰å…¨ç­–ç•¥ |
|----------|----------|----------|----------|----------|
| **DMZåŒºåŸŸ** | é˜²ç«å¢™+æœåŠ¡å™¨ | åŒé“¾è·¯å¤‡ä»½ | æœåŠ¡å™¨VLAN | ä¸¥æ ¼ACLæ§åˆ¶ |
| **æ ¸å¿ƒå±‚** | åŒæ ¸å¿ƒäº¤æ¢æœº | å…¨å†—ä½™ | ç®¡ç†VLAN | æœ€å°åŒ–ç­–ç•¥ |
| **æ±‡èšå±‚** | å †å äº¤æ¢æœº | åŒä¸Šè” | éƒ¨é—¨VLAN | QoSç­–ç•¥ |
| **æ¥å…¥å±‚** | æ™®é€šäº¤æ¢æœº | åŒå½’å± | ç”¨æˆ·VLAN | ç«¯å£å®‰å…¨ |

**æµé‡æµå‘åˆ†æ**ï¼š
```mermaid
flowchart TD
    A["ç”¨æˆ·ç»ˆç«¯"] --> B["æ¥å…¥äº¤æ¢æœº"]
    B --> C["æ±‡èšäº¤æ¢æœº"]
    C --> D["æ ¸å¿ƒäº¤æ¢æœº"]
    D --> E["å‡ºå£è·¯ç”±å™¨"]
    E --> F["äº’è”ç½‘"]
    
    C -.->|VLANé—´é€šä¿¡| C
    D -.->|éƒ¨é—¨é—´é€šä¿¡| D
    
    style A fill:#e3f2fd,stroke:#1976d2,stroke-width:2px,color:#0d47a1
    style F fill:#ffebee,stroke:#d32f2f,stroke-width:2px,color:#b71c1c
```
