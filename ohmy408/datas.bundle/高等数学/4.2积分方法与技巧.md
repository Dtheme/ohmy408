# 4.2 积分方法与技巧
 
## 目录

1. [第一类换元积分法（凑微分法）](#1-第一类换元积分法凑微分法)
2. [第二类换元积分法（变量替换法）](#2-第二类换元积分法变量替换法)
3. [分部积分法](#3-分部积分法)
4. [有理函数的积分](#4-有理函数的积分)
5. [三角函数积分技巧](#5-三角函数积分技巧)
6. [特殊函数积分方法](#6-特殊函数积分方法)
7. [综合应用与练习](#7-综合应用与练习)

---

## 1. 第一类换元积分法（凑微分法）

### 1.1 基本原理与公式

> **定理1.1（第一类换元积分法）**
> 
> 设  $f(u)$ 具有原函数 $F(u)$，$u = \varphi(x)$ 可导，则：
> $$\int f[\varphi(x)] \varphi'(x) \, dx = F[\varphi(x)] + C$$
> 即：
> $$\int f(u) \, du = F(u) + C$$

**核心思想**：将复合函数的积分转化为简单函数的积分。

**适用场景**：
- 被积函数具有 $f[\varphi(x)] \cdot \varphi'(x)$ 的结构
- 内层函数 $\varphi(x)$ 的导数 $\varphi'(x)$ 在被积函数中出现（或可以凑出）
- 换元后的积分 $\int f(u) du$ 比原积分更简单
- 特别适用于：复合三角函数、复合指数函数、复合对数函数等

**操作步骤**：
1. **识别复合结构**：找出内层函数 $u = \varphi(x)$
2. **凑出微分**：将 $\varphi'(x) dx$ 凑成 $du$
3. **变量替换**：用 $u$ 替换 $\varphi(x)$
4. **计算积分**：计算简化后的积分
5. **回代**：将结果中的 $u$ 换回 $\varphi(x)$

**判断标准**：
- 观察是否存在"外函数的内层"与"内层的导数"的搭配
- 检查是否可以通过常数因子调整来凑出标准形式
- 验证换元后的积分确实更容易计算

### 1.2 基本凑微分技巧

#### **线性函数凑微分**

> **例题1.1**：计算 $\int \sin(3x + 2) \, dx$

**解答**：
设  $u = 3x + 2$，则 $du = 3 \, dx$，$dx = \frac{1}{3} du$
$$\int \sin(3x + 2) \, dx = \frac{1}{3} \int \sin u \, du = -\frac{1}{3} \cos u + C = -\frac{1}{3} \cos(3x + 2) + C$$

#### **幂函数凑微分**

> **例题1.2**：计算 $\int x(x^2 + 1)^5 \, dx$

**解答**：
设  $u = x^2 + 1$，则 $du = 2x \, dx$，$x \, dx = \frac{1}{2} du$
$$\int x(x^2 + 1)^5 \, dx = \frac{1}{2} \int u^5 \, du = \frac{1}{2} \cdot \frac{u^6}{6} + C = \frac{(x^2 + 1)^6}{12} + C$$

#### **指数函数凑微分**

> **例题1.3**：计算 $\int x e^{x^2} \, dx$

**解答**：
设  $u = x^2$，则 $du = 2x \, dx$，$x \, dx = \frac{1}{2} du$
$$\int x e^{x^2} \, dx = \frac{1}{2} \int e^u \, du = \frac{1}{2} e^u + C = \frac{1}{2} e^{x^2} + C$$

### 1.3 三角函数凑微分

#### **基本三角凑微分**

> **例题1.4**：计算 $\int \tan x \, dx$

**解答**：
$$\int \tan x \, dx = \int \frac{\sin x}{\cos x} \, dx$$
设  $u = \cos x$，则 $du = -\sin x \, dx$，$\sin x \, dx = -du$
$$\int \frac{\sin x}{\cos x} \, dx = \int \frac{-du}{u} = -\ln|u| + C = -\ln|\cos x| + C = \ln|\sec x| + C$$

#### **复杂三角凑微分**

> **例题1.5**：计算 $\int \sin^3 x \cos x \, dx$

**解答**：
设  $u = \sin x$，则 $du = \cos x \, dx$
$$\int \sin^3 x \cos x \, dx = \int u^3 \, du = \frac{u^4}{4} + C = \frac{\sin^4 x}{4} + C$$

### 1.4 对数函数凑微分

> **例题1.6**：计算 $\int \frac{1}{x \ln x} \, dx$

**解答**：
设  $u = \ln x$，则 $du = \frac{1}{x} \, dx$
$$\int \frac{1}{x \ln x} \, dx = \int \frac{1}{u} \, du = \ln|u| + C = \ln|\ln x| + C$$

### 1.5 复杂反三角函数凑微分

这类积分需要敏锐地观察到分母恰好是分子（复合函数）的导数，是凑微分法的高级应用。

> **例题1.7**：计算 $\int \frac{\arcsin \sqrt{x}}{\sqrt{x(1-x)}} \, dx$

**解答**：
这是一个需要"凑两次"的典型例子，关键是观察分母与分子的导数关系。

**第一步**：分析复合函数的导数
设  $u = \arcsin \sqrt{x}$，我们需要计算 $\frac{du}{dx}$：

$$\frac{d}{dx}[\arcsin \sqrt{x}] = \frac{1}{\sqrt{1-(\sqrt{x})^2}} \cdot \frac{d}{dx}[\sqrt{x}] = \frac{1}{\sqrt{1-x}} \cdot \frac{1}{2\sqrt{x}}$$

$$= \frac{1}{2\sqrt{x}\sqrt{1-x}} = \frac{1}{2\sqrt{x(1-x)}}$$

**第二步**：识别凑微分结构
因此 $du = \frac{1}{2\sqrt{x(1-x)}} dx$，即：
$$\frac{dx}{\sqrt{x(1-x)}} = 2du$$

**第三步**：进行换元积分
$$\int \frac{\arcsin \sqrt{x}}{\sqrt{x(1-x)}} \, dx = \int u \cdot 2 \, du = 2 \int u \, du = 2 \cdot \frac{u^2}{2} + C = u^2 + C$$

**第四步**：回代得到最终结果
$$\int \frac{\arcsin \sqrt{x}}{\sqrt{x(1-x)}} \, dx = (\arcsin \sqrt{x})^2 + C$$

**验证**：我们可以通过求导验证结果:

$\frac{d}{dx}[(\arcsin \sqrt{x})^2] = 2(\arcsin \sqrt{x}) \cdot \frac{1}{2\sqrt{x(1-x)}} = \frac{\arcsin \sqrt{x}}{\sqrt{x(1-x)}}$   ✓

**解题要点**：
- **关键观察**：分母 $\sqrt{x(1-x)}$ 恰好与分子 $\arcsin \sqrt{x}$ 的导数（除了常数因子）相关
- **技巧总结**：对于形如 $\int \frac{f(\varphi(x))}{\varphi'(x)} dx$ 的积分，可以设  $u = \varphi(x)$ 进行凑微分
- **计算细节**：复合函数求导时要特别注意链式法则的正确应用

### 1.6 常见凑微分模式总结

#### **基础凑微分类型**

| 被积函数类型 | 凑微分方法 | 替换 | 适用场景 |
|:-------------|:-----------|:-----|:---------|
| $f(ax + b) \cdot 1$ | 乘以 $\frac{1}{a}$ | $u = ax + b$ | 线性函数复合 |
| $f(x^n) \cdot x^{n-1}$ | 乘以 $\frac{1}{n}$ | $u = x^n$ | 幂函数复合 |
| $f(e^x) \cdot e^x$ | 直接替换 | $u = e^x$ | 指数函数复合 |
| $f(\ln x) \cdot \frac{1}{x}$ | 直接替换 | $u = \ln x$ | 对数函数复合 |
| $f(\sin x) \cdot \cos x$ | 直接替换 | $u = \sin x$ | 三角函数复合 |
| $f(\cos x) \cdot (-\sin x)$ | 直接替换 | $u = \cos x$ | 三角函数复合 |
| $f(\tan x) \cdot \sec^2 x$ | 直接替换 | $u = \tan x$ | 三角函数复合 |

**基础类型例题演示**：

1. **线性函数复合**： $\int (2x + 3)^5 \, dx \overset{u=2x+3}{\longrightarrow} \frac{1}{2}\int u^5 \, du = \frac{(2x+3)^6}{12} + C$

2. **幂函数复合**： $\int x^2 \sqrt{x^3} \, dx \overset{u=x^3}{\longrightarrow} \frac{1}{3}\int u^{1/2} \, du = \frac{2(x^3)^{3/2}}{9} + C$

3. **指数函数复合**： $\int e^x \cdot e^{e^x} \, dx \overset{u=e^x}{\longrightarrow} \int e^u \, du = e^{e^x} + C$

4. **对数函数复合**： $\int \frac{(\ln x)^2}{x} \, dx \overset{u=\ln x}{\longrightarrow} \int u^2 \, du = \frac{(\ln x)^3}{3} + C$

5. **正弦复合**： $\int \sin^3 x \cos x \, dx \overset{u=\sin x}{\longrightarrow} \int u^3 \, du = \frac{\sin^4 x}{4} + C$

6. **余弦复合**： $\int \cos^2 x \sin x \, dx \overset{u=\cos x}{\longrightarrow} -\int u^2 \, du = -\frac{\cos^3 x}{3} + C$

7. **正切复合**： $\int \tan^2 x \sec^2 x \, dx \overset{u=\tan x}{\longrightarrow} \int u^2 \, du = \frac{\tan^3 x}{3} + C$

#### **扩展三角函数类型**

| 被积函数类型 | 凑微分方法 | 替换 | 适用场景 |
|:-------------|:-----------|:-----|:---------|
| $f(\cot x) \cdot (-\csc^2 x)$ | 直接替换 | $u = \cot x$ | 余切函数复合 |
| $f(\sec x) \cdot \sec x \tan x$ | 直接替换 | $u = \sec x$ | 正割函数复合 |
| $f(\csc x) \cdot (-\csc x \cot x)$ | 直接替换 | $u = \csc x$ | 余割函数复合 |
| $f(\sin^2 x) \cdot \sin x \cos x$ | 乘以 $\frac{1}{2}$ | $u = \sin^2 x$ | 正弦平方复合 |
| $f(\cos^2 x) \cdot (-\sin x \cos x)$ | 乘以 $\frac{1}{2}$ | $u = \cos^2 x$ | 余弦平方复合 |

**扩展三角函数例题演示**：

1. **余切复合**： $\int \cot^3 x \csc^2 x \, dx \overset{u=\cot x}{\longrightarrow} -\int u^3 \, du = -\frac{\cot^4 x}{4} + C$

2. **正割复合**： $\int \sec^2 x \cdot \sec x \tan x \, dx \overset{u=\sec x}{\longrightarrow} \int u^2 \, du = \frac{\sec^3 x}{3} + C$

3. **余割复合**： $\int \csc x \cot x \, dx \overset{u=\csc x}{\longrightarrow} -\int du = -\csc x + C$

4. **正弦平方复合**： $\int (\sin^2 x)^2 \sin x \cos x \, dx \overset{u=\sin^2 x}{\longrightarrow} \frac{1}{2}\int u^2 \, du = \frac{\sin^6 x}{6} + C$

5. **余弦平方复合**： $\int \sqrt{\cos^2 x} \sin x \cos x \, dx \overset{u=\cos^2 x}{\longrightarrow} -\frac{1}{2}\int u^{1/2} \, du = -\frac{(\cos^2 x)^{3/2}}{3} + C$

#### **反三角函数类型**

| 被积函数类型 | 凑微分方法 | 替换 | 适用场景 |
|:-------------|:-----------|:-----|:---------|
| $f(\arcsin x) \cdot \frac{1}{\sqrt{1-x^2}}$ | 直接替换 | $u = \arcsin x$ | 反正弦复合 |
| $f(\arccos x) \cdot \frac{-1}{\sqrt{1-x^2}}$ | 直接替换 | $u = \arccos x$ | 反余弦复合 |
| $f(\arctan x) \cdot \frac{1}{1+x^2}$ | 直接替换 | $u = \arctan x$ | 反正切复合 |
| $f(\arcsin \sqrt{x}) \cdot \frac{1}{2\sqrt{x(1-x)}}$ | 乘以 $2$ | $u = \arcsin \sqrt{x}$ | 复合反三角函数 |

**反三角函数例题演示**：

1. **反正弦复合**： $\int \frac{(\arcsin x)^3}{\sqrt{1-x^2}} \, dx \overset{u=\arcsin x}{\longrightarrow} \int u^3 \, du = \frac{(\arcsin x)^4}{4} + C$

2. **反余弦复合**： $\int \frac{\arccos x}{\sqrt{1-x^2}} \, dx \overset{u=\arccos x}{\longrightarrow} -\int u \, du = -\frac{(\arccos x)^2}{2} + C$

3. **反正切复合**： $\int \frac{\arctan x}{1+x^2} \, dx \overset{u=\arctan x}{\longrightarrow} \int u \, du = \frac{(\arctan x)^2}{2} + C$

4. **复合反三角函数**： $\int \frac{\arcsin \sqrt{x}}{\sqrt{x(1-x)}} \, dx \overset{u=\arcsin \sqrt{x}}{\longrightarrow} 2\int u \, du = (\arcsin \sqrt{x})^2 + C$

#### **复合指数对数类型**

| 被积函数类型 | 凑微分方法 | 替换 | 适用场景 |
|:-------------|:-----------|:-----|:---------|
| $f(e^{ax}) \cdot ae^{ax}$ | 乘以 $\frac{1}{a}$ | $u = e^{ax}$ | 指数函数复合 |
| $f(\ln(ax+b)) \cdot \frac{a}{ax+b}$ | 乘以 $\frac{1}{a}$ | $u = \ln(ax+b)$ | 对数函数复合 |
| $f(a^x) \cdot a^x \ln a$ | 乘以 $\frac{1}{\ln a}$ | $u = a^x$ | 一般指数函数 |
| $f(\log_a x) \cdot \frac{1}{x \ln a}$ | 乘以 $\ln a$ | $u = \log_a x$ | 一般对数函数 |

**复合指数对数例题演示**：

1. **参数指数复合**： $\int 2e^{2x} \cdot (e^{2x})^2 \, dx \overset{u=e^{2x}}{\longrightarrow} \frac{1}{2}\int 2u \cdot u^2 \, du = \frac{(e^{2x})^4}{4} + C$

2. **参数对数复合**： $\int \frac{(\ln(3x+1))^2}{3x+1} \, dx \overset{u=\ln(3x+1)}{\longrightarrow} \frac{1}{3}\int u^2 \, du = \frac{(\ln(3x+1))^3}{9} + C$

3. **一般指数函数**： $\int (2^x)^2 \cdot 2^x \ln 2 \, dx \overset{u=2^x}{\longrightarrow} \frac{1}{\ln 2}\int u^2 \, du = \frac{(2^x)^3}{3\ln 2} + C$

4. **一般对数函数**： $\int \frac{\log_2 x}{x \ln 2} \, dx \overset{u=\log_2 x}{\longrightarrow} \ln 2 \int u \, du = \frac{\ln 2 \cdot (\log_2 x)^2}{2} + C$

#### **根式函数类型**

| 被积函数类型 | 凑微分方法 | 替换 | 适用场景 |
|:-------------|:-----------|:-----|:---------|
| $f(\sqrt{x}) \cdot \frac{1}{2\sqrt{x}}$ | 乘以 $2$ | $u = \sqrt{x}$ | 平方根复合 |
| $f(\sqrt{ax+b}) \cdot \frac{a}{2\sqrt{ax+b}}$ | 乘以 $\frac{2}{a}$ | $u = \sqrt{ax+b}$ | 一次根式复合 |
| $f(\sqrt[n]{x}) \cdot \frac{1}{n}x^{\frac{1-n}{n}}$ | 乘以 $n$ | $u = \sqrt[n]{x}$ | n次根式复合 |
| $f(\sqrt{x^2 \pm a^2}) \cdot \frac{x}{\sqrt{x^2 \pm a^2}}$ | 直接替换 | $u = \sqrt{x^2 \pm a^2}$ | 二次根式复合 |

**根式函数例题演示**：

1. **平方根复合**： $\int (\sqrt{x})^3 \cdot \frac{1}{2\sqrt{x}} \, dx \overset{u=\sqrt{x}}{\longrightarrow} 2\int u^2 \, du = \frac{2(\sqrt{x})^3}{3} + C$

2. **一次根式复合**： $\int \sqrt{2x+1} \cdot \frac{2}{2\sqrt{2x+1}} \, dx \overset{u=\sqrt{2x+1}}{\longrightarrow} \frac{2}{2}\int u \, du = \frac{(\sqrt{2x+1})^2}{2} + C$

3. **三次根式复合**： $\int (\sqrt[3]{x})^2 \cdot \frac{1}{3x^{2/3}} \, dx \overset{u=\sqrt[3]{x}}{\longrightarrow} 3\int u^2 \, du = \frac{(\sqrt[3]{x})^3}{1} = x + C$

4. **二次根式复合**： $\int \frac{x}{\sqrt{x^2 + 1}} \, dx \overset{u=\sqrt{x^2+1}}{\longrightarrow} \int du = \sqrt{x^2 + 1} + C$

#### **双曲函数类型**

| 被积函数类型 | 凑微分方法 | 替换 | 适用场景 |
|:-------------|:-----------|:-----|:---------|
| $f(\sinh x) \cdot \cosh x$ | 直接替换 | $u = \sinh x$ | 双曲正弦复合 |
| $f(\cosh x) \cdot \sinh x$ | 直接替换 | $u = \cosh x$ | 双曲余弦复合 |
| $f(\tanh x) \cdot \operatorname{sech}^2 x$ | 直接替换 | $u = \tanh x$ | 双曲正切复合 |
| $f(\operatorname{sech} x) \cdot (-\operatorname{sech} x \tanh x)$ | 直接替换 | $u = \operatorname{sech} x$ | 双曲正割复合 |

**双曲函数例题演示**：

1. **双曲正弦复合**： $\int \sinh^2 x \cosh x \, dx \overset{u=\sinh x}{\longrightarrow} \int u^2 \, du = \frac{\sinh^3 x}{3} + C$

2. **双曲余弦复合**： $\int \cosh^3 x \sinh x \, dx \overset{u=\cosh x}{\longrightarrow} \int u^3 \, du = \frac{\cosh^4 x}{4} + C$

3. **双曲正切复合**： $\int \tanh x \operatorname{sech}^2 x \, dx \overset{u=\tanh x}{\longrightarrow} \int u \, du = \frac{\tanh^2 x}{2} + C$

4. **双曲正割复合**： $\int \operatorname{sech} x \tanh x \, dx \overset{u=\operatorname{sech} x}{\longrightarrow} -\int du = -\operatorname{sech} x + C$

#### **分式函数凑微分类型**

| 被积函数类型 | 凑微分方法 | 替换 | 适用场景 |
|:-------------|:-----------|:-----|:---------|
| $\frac{g'(x)}{g(x)}$ | 直接替换 | $u = \ln\|g(x)\|$ | 对数微分型 |
| $\frac{g'(x)}{\sqrt{g(x)}}$ | 乘以 $\frac{1}{2}$ | $u = \sqrt{g(x)}$ | 根式分母型 |
| $\frac{g'(x)}{(g(x))^n}$ | 乘以 $\frac{1}{1-n}$ | $u = g(x)$ | 负幂分母型 $(n \neq 1)$ |
| $\frac{g'(x)}{g(x)\ln g(x)}$ | 直接替换 | $u = \ln(\ln g(x))$ | 重对数型 |

**分式函数凑微分例题演示**：

1. **根式分母型**： $\int \frac{2x}{\sqrt{x^2+1}} \, dx \overset{u=\sqrt{x^2+1}}{\longrightarrow} \frac{1}{2} \cdot 2\int du = 2\sqrt{x^2+1} + C$

2. **负幂分母型**： $\int \frac{3x^2}{(x^3+1)^2} \, dx \overset{u=x^3+1}{\longrightarrow} \frac{1}{1-2} \cdot 3\int \frac{du}{u^2} = -\frac{3}{x^3+1} + C$

3. **重对数型**： $\int \frac{1}{x \ln x \ln(\ln x)} \, dx \overset{u=\ln(\ln x)}{\longrightarrow} \int \frac{du}{u} = \ln|\ln(\ln x)| + C$

#### **混合三角函数类型**

| 被积函数类型 | 凑微分方法 | 替换 | 适用场景 |
|:-------------|:-----------|:-----|:---------|
| $f(\sin x + \cos x) \cdot (\cos x - \sin x)$ | 直接替换 | $u = \sin x + \cos x$ | 三角和差复合 |
| $f(\sin x - \cos x) \cdot (\cos x + \sin x)$ | 直接替换 | $u = \sin x - \cos x$ | 三角和差复合 |
| $f(\tan x + \cot x) \cdot (\sec^2 x - \csc^2 x)$ | 直接替换 | $u = \tan x + \cot x$ | 三角倒数和 |
| $\frac{1}{\sin x \cos x} \cdot g'(\tan x - \cot x)$ | 替换处理 | $u = \tan x - \cot x$ | 特殊三角复合 |

**混合三角函数例题演示**：

1. **三角和差复合**： $\int (\sin x + \cos x)^3(\cos x - \sin x) \, dx \overset{u=\sin x + \cos x}{\longrightarrow} \int u^3 \, du = \frac{(\sin x + \cos x)^4}{4} + C$

2. **三角差复合**： $\int \frac{\cos x + \sin x}{\sin x - \cos x} \, dx \overset{u=\sin x - \cos x}{\longrightarrow} -\int \frac{du}{u} = -\ln|\sin x - \cos x| + C$

3. **三角倒数和**： $\int (\tan x + \cot x)(\sec^2 x - \csc^2 x) \, dx \overset{u=\tan x + \cot x}{\longrightarrow} \int u \, du = \frac{(\tan x + \cot x)^2}{2} + C$

#### **对数指数扩展类型**

| 被积函数类型 | 凑微分方法 | 替换 | 适用场景 |
|:-------------|:-----------|:-----|:---------|
| $g'(x) \cdot \ln(g(x))$ | 直接替换 | $u = \ln(g(x))$ | 对数复合型 |
| $\frac{g'(x)}{g(x)(\ln g(x))^n}$ | 乘以 $\frac{1}{1-n}$ | $u = \ln g(x)$ | 对数幂分母 $(n \neq 1)$ |
| $g'(x) \cdot g(x) \ln g(x)$ | 特殊处理 | 分部或替换 | 指数对数混合 |
| $\frac{g'(x) \cdot f'(g(x))}{f(g(x))}$ | 链式替换 | $u = f(g(x))$ | 复合对数微分 |

**对数指数扩展例题演示**：

1. **对数复合型**： $\int 2x \ln(x^2 + 1) \, dx \overset{u=\ln(x^2+1)}{\longrightarrow} \int u \, du = \frac{(\ln(x^2 + 1))^2}{2} + C$

2. **对数幂分母**： $\int \frac{2x}{(x^2+1)(\ln(x^2+1))^2} \, dx \overset{u=\ln(x^2+1)}{\longrightarrow} \frac{1}{1-2}\int \frac{du}{u^2} = \frac{1}{\ln(x^2+1)} + C$

3. **复合对数微分**： $\int \frac{2x \cos(x^2)}{\sin(x^2)} \, dx \overset{u=\sin(x^2)}{\longrightarrow} \int \frac{du}{u} = \ln|\sin(x^2)| + C$

#### **通用模式**

| 被积函数类型 | 凑微分方法 | 替换 | 适用场景 |
|:-------------|:-----------|:-----|:---------|
| $\frac{f(\varphi(x))}{\varphi'(x)}$ | 设  $u = \varphi(x)$ | $du = \varphi'(x)dx$  | 复杂复合函数 |
| $g'(x) \cdot g(x)^n$ | 乘以 $\frac{1}{n+1}$ | $u = g(x)$ | 幂函数型复合 |
| $g'(x) \cdot e^{g(x)}$ | 直接替换 | $u = g(x)$ | 指数函数型复合 |
| $\varphi'(x) \cdot f(\varphi(x))$ | 直接替换 | $u = \varphi(x)$ | 标准复合函数 |


**通用模式例题演示**：

1. **复杂复合函数**： $\int (x^2+1)^3 \cdot 2x \, dx \overset{u=x^2+1}{\longrightarrow} \frac{1}{2}\int u^3 \, du = \frac{(x^2+1)^4}{8} + C$

2. **幂函数型复合**： $\int 3x^2(x^3+1)^4 \, dx \overset{u=x^3+1}{\longrightarrow} \frac{1}{3}\int 3u^4 \, du = \frac{3(x^3+1)^5}{15} = \frac{(x^3+1)^5}{5} + C$

3. **指数函数型复合**： $\int 2x e^{x^2} \, dx \overset{u=x^2}{\longrightarrow} \int e^u \, du = e^{x^2} + C$

4. **标准复合函数**： $\int \sin(x^2) \cdot 2x \, dx \overset{u=x^2}{\longrightarrow} \int \sin u \, du = -\cos(x^2) + C$



---

## 2. 第二类换元积分法（变量替换法）

### 2.1 基本原理

> **定理2.1（第二类换元积分法）**
> 
> 设  $x = \psi(t)$，$\psi(t)$ 在区间 $[\alpha, \beta]$ 上单调可导，且 $\psi'(t) \neq 0$，则：
> $$\int f(x) \, dx = \int f[\psi(t)] \psi'(t) \, dt$$
> 计算右端积分后，再用 $t = \psi^{-1}(x)$ 回代。

**核心思想**：通过引入新变量 $t$，将复杂的积分化为简单的积分。

**适用场景**：
- 第一类换元法无法直接应用时
- 被积函数含有根式、分式或复杂表达式
- 三角替换：处理含 $\sqrt{a^2 \pm x^2}$ 或 $\sqrt{x^2 \pm a^2}$ 的积分
- 根式替换：处理含 $\sqrt[n]{ax+b}$、 $\sqrt{x}$ 等的积分
- 倒代换：分母次数远高于分子次数的有理函数
- 指数或对数替换：处理某些特殊的指数、对数函数
- [常见特殊积分类型](#常见特殊积分类型)
  
**选择原则**：
1. **三角替换**：当出现 $a^2 \pm x^2$ 的根式时
2. **根式替换**：当被积函数含有根式且直接积分困难时
3. **倒代换**：当 $x \to \infty$ 或 $x \to 0$ 的行为需要分析时
4. **特殊替换**：根据函数特点选择合适的变换

### 2.2 三角替换法

**核心思想**：利用三角恒等式消除根式，将无理函数转化为有理函数。

**适用场景**：专门处理含有二次根式的积分，特别是形如 $\sqrt{a^2 \pm x^2}$ 或 $\sqrt{x^2 \pm a^2}$ 的表达式。

**三角替换的理论基础**：

> **基本原理**：通过三角恒等式将根式表达式转化为三角函数
> - $\sin^2 t + \cos^2 t = 1$ → 处理 $\sqrt{a^2 - x^2}$ 型
> - $1 + \tan^2 t = \sec^2 t$ → 处理 $\sqrt{x^2 + a^2}$ 型  
> - $\sec^2 t - 1 = \tan^2 t$ → 处理 $\sqrt{x^2 - a^2}$ 型

**三角替换公式总结**：

| 根式类型 | 替换方法 | 利用恒等式 | 替换后根式 | 适用条件 |
|:---------|:---------|:-----------|:-----------|:---------|
| $\sqrt{a^2 - x^2}$ | $x = a \sin t$ | $\cos^2 t = 1 - \sin^2 t$ | $a \cos t$ | $\|x\| \leq a$ |
| $\sqrt{x^2 + a^2}$ | $x = a \tan t$ | $\sec^2 t = 1 + \tan^2 t$ | $a \sec t$ | $x \in \mathbb{R}$ |
| $\sqrt{x^2 - a^2}$ | $x = a \sec t$ | $\tan^2 t = \sec^2 t - 1$ | $a \tan t$ | $\|x\| \geq a$ |

#### **处理根式 $\sqrt{a^2 - x^2}$ 的积分**

**理论基础**：利用基本三角恒等式 $\sin^2 t + \cos^2 t = 1$

**替换策略**：设  $x = a \sin t$，则 $\sqrt{a^2 - x^2} = \sqrt{a^2 - a^2\sin^2 t} = a\sqrt{1 - \sin^2 t} = a\cos t$
**适用场景**：被积函数含有 $\sqrt{a^2 - x^2}$ 的根式，且变量范围 $|x| \leq a$

> **例题2.1**：计算 $\int \frac{1}{\sqrt{4 - x^2}} \, dx$

**解答**：

**第一步：选择换元**
- 换元： $x = 2 \sin t$ （利用 $\sin^2 t + \cos^2 t = 1$ 消除根式）
- 微分： $dx = 2 \cos t \, dt$  
- 根式化简： $\sqrt{4 - x^2} = \sqrt{4 - (2\sin t)^2} = \sqrt{4 - 4\sin^2 t} = \sqrt{4(1 - \sin^2 t)} = \sqrt{4\cos^2 t} = 2|\cos t| = 2\cos t$
- **关键恒等式**： $1 - \sin^2 t = \cos^2 t$

**第二步：代入积分**
$$\int \frac{1}{\sqrt{4 - x^2}} \, dx = \int \frac{1}{2 \cos t} \cdot (2 \cos t \, dt) = \int \frac{2 \cos t \, dt}{2 \cos t} = \int dt$$

**第三步：计算积分**
$$\int dt = t + C$$

**第四步：回代原变量**
由 $x = 2 \sin t$ 得 $t = \arcsin \frac{x}{2}$

**最终结果**：
$$\int \frac{1}{\sqrt{4 - x^2}} \, dx = \arcsin \frac{x}{2} + C$$

#### **处理根式 $\sqrt{x^2 + a^2}$ 的积分**

**理论基础**：利用三角恒等式 $1 + \tan^2 t = \sec^2 t$
**替换策略**：设  $x = a \tan t$，则 $\sqrt{x^2 + a^2} = \sqrt{a^2\tan^2 t + a^2} = a\sqrt{\tan^2 t + 1} = a\sec t$
**适用场景**：被积函数含有 $\sqrt{x^2 + a^2}$ 的根式， $x$ 可以取任意实数值

> **例题2.2**：计算 $\int \frac{1}{\sqrt{x^2 + 1}} \, dx$

**解答**：

**第一步：选择换元**
- 换元： $x = \tan t$ （利用 $1 + \tan^2 t = \sec^2 t$ 消除根式）
- 微分： $dx = \sec^2 t \, dt$
- 根式化简： $\sqrt{x^2 + 1} = \sqrt{(\tan t)^2 + 1} = \sqrt{\tan^2 t + 1} = \sqrt{\sec^2 t} = |\sec t| = \sec t$
- **关键恒等式**： $1 + \tan^2 t = \sec^2 t$

**第二步：代入积分**
$$\int \frac{1}{\sqrt{x^2 + 1}} \, dx = \int \frac{1}{\sec t} \cdot (\sec^2 t \, dt) = \int \frac{\sec^2 t \, dt}{\sec t} = \int \sec t \, dt$$

**第三步：计算积分**
$$\int \sec t \, dt = \ln|\sec t + \tan t| + C$$

**第四步：回代原变量**
- $\sec t = \sqrt{x^2 + 1}$
- $\tan t = x$

**最终结果**：
$$\int \frac{1}{\sqrt{x^2 + 1}} \, dx = \ln|x + \sqrt{x^2 + 1}| + C$$

#### **处理根式 $\sqrt{x^2 - a^2}$ 的积分**

**理论基础**：利用三角恒等式 $\sec^2 t - 1 = \tan^2 t$
**替换策略**：设  $x = a \sec t$，则 $\sqrt{x^2 - a^2} = \sqrt{a^2\sec^2 t - a^2} = a\sqrt{\sec^2 t - 1} = a\tan t$
**适用场景**：被积函数含有 $\sqrt{x^2 - a^2}$ 的根式，且 $|x| \geq a$

> **例题2.3**：计算 $\int \frac{1}{\sqrt{x^2 - 4}} \, dx$ （ $x > 2$）

**解答**：

**第一步：选择换元**
- 换元： $x = 2 \sec t$ （利用 $\sec^2 t - 1 = \tan^2 t$ 消除根式）
- 微分： $dx = 2 \sec t \tan t \, dt$
- 根式化简： $\sqrt{x^2 - 4} = \sqrt{(2\sec t)^2 - 4} = \sqrt{4\sec^2 t - 4} = \sqrt{4(\sec^2 t - 1)} = \sqrt{4\tan^2 t} = 2|\tan t| = 2\tan t$
- **关键恒等式**： $\sec^2 t - 1 = \tan^2 t$

**第二步：代入积分**
$$\int \frac{1}{\sqrt{x^2 - 4}} \, dx = \int \frac{1}{2 \tan t} \cdot (2 \sec t \tan t \, dt) = \int \frac{2 \sec t \tan t \, dt}{2 \tan t} = \int \sec t \, dt$$

**第三步：计算积分**
$$\int \sec t \, dt = \ln|\sec t + \tan t| + C$$

**第四步：回代原变量**
- $\sec t = \frac{x}{2}$
- $\tan t = \frac{\sqrt{x^2 - 4}}{2}$

**最终结果**：
$$\int \frac{1}{\sqrt{x^2 - 4}} \, dx = \ln\left|\frac{x}{2} + \frac{\sqrt{x^2 - 4}}{2}\right| + C$$

### 2.3 根式替换法

**核心思想**：通过设根式为新变量，将无理函数转化为有理函数积分。

**理论基础**：
- **有理化原理**：设  $t = \sqrt[n]{f(x)}$，则 $f(x) = t^n$，消除根式
- **反函数思想**：从 $t = g(x)$ 反解出 $x = g^{-1}(t)$，建立变量对应关系
- **微分对应**： $dx = \frac{d}{dt}[g^{-1}(t)] dt$，确保微分元素正确转换

**适用场景**：
- 被积函数含有 $\sqrt[n]{ax + b}$、 $\sqrt{x}$、 $\sqrt[3]{x}$ 等根式
- 同时出现多个不同次数的根式时，选择公共最小次数
- 有理化处理：将无理函数转化为有理函数积分

#### **处理 $\sqrt[n]{ax + b}$ 类型**

**理论基础**：利用 $t^n = ax + b$ 的代数关系消除根式
**替换策略**：
- 设  $t = \sqrt[n]{ax + b}$ （消除根式）
- 反解： $t^n = ax + b$ → $x = \frac{t^n - b}{a}$
- 微分： $dx = \frac{d}{dt}\left(\frac{t^n - b}{a}\right) dt = \frac{n t^{n-1}}{a} dt$
**适用场景**：被积函数主要含有 $\sqrt[n]{ax + b}$ 的根式，替换后可得到有理函数

> **例题2.4**：计算 $\int \frac{1}{x + \sqrt{x}} \, dx$

**解答**：

**第一步：选择换元**
- 换元： $t = \sqrt{x}$ （消除根式 $\sqrt{x}$）
- 反解关系： $t^2 = x$
- 微分对应： $dx = \frac{d}{dt}(t^2) dt = 2t \, dt$
- **核心思想**：将 $\sqrt{x}$ 用 $t$ 表示， $x$ 用 $t^2$ 表示

**第二步：代入积分**
$$\int \frac{1}{x + \sqrt{x}} \, dx = \int \frac{1}{t^2 + t} \cdot (2t \, dt)$$

**第三步：化简被积函数**
$$= \int \frac{2t \, dt}{t^2 + t} = \int \frac{2t \, dt}{t(t + 1)} = \int \frac{2 \, dt}{t + 1}$$
**关键简化**：约去公因子 $t$

**第四步：计算积分**
$$\int \frac{2 \, dt}{t + 1} = 2 \ln|t + 1| + C$$

**第五步：回代原变量**
- 变量对应： $t = \sqrt{x}$
- 代入结果： $2 \ln|t + 1| = 2 \ln|\sqrt{x} + 1| = 2 \ln(\sqrt{x} + 1)$ （因为 $\sqrt{x} + 1 > 0$）

**最终结果**：
$$\int \frac{1}{x + \sqrt{x}} \, dx = 2 \ln(\sqrt{x} + 1) + C$$

### 2.4 倒代换

**核心思想**：通过倒数变换 $x = \frac{1}{t}$ 将高次分母转化为低次，简化积分计算。

**理论基础**：
- **倒数关系**： $x = \frac{1}{t}$ ⟺ $t = \frac{1}{x}$，建立倒数对应
- **次数转换**： $x^n$ 变为 $\frac{1}{t^n}$，高次分母变为低次分子
- **微分变换**： $dx = \frac{d}{dt}\left(\frac{1}{t}\right) dt = -\frac{1}{t^2} dt$
- **渐近分析**： $x \to \infty$ 对应 $t \to 0$，$x \to 0$ 对应 $t \to \infty$

**适用场景**：
- 被积函数的分母次数比分子次数高很多
- 当 $x \to \infty$ 时的渐近行为分析
- 分母含有高次幂的有理函数积分
- 某些含根式的函数，倒代换后根式次数降低

**判断标准**：分母次数 - 分子次数 ≥ 2时，倒代换通常有效
**替换公式**： $x = \frac{1}{t}$，$dx = -\frac{1}{t^2} dt$

> **例题2.5**：计算 $\int \frac{1}{x^2 \sqrt{1 + x^2}} \, dx$

**解答**：

**第一步：选择换元**
- 换元： $x = \frac{1}{t}$ （将高次分母 $x^2$ 转化为低次）
- 反解关系： $t = \frac{1}{x}$
- 微分变换： $dx = \frac{d}{dt}\left(\frac{1}{t}\right) dt = -\frac{1}{t^2} dt$
- 根式变换： $\sqrt{1 + x^2} = \sqrt{1 + \frac{1}{t^2}} = \sqrt{\frac{t^2 + 1}{t^2}} = \frac{\sqrt{t^2 + 1}}{|t|} = \frac{\sqrt{t^2 + 1}}{t}$ （假设  $t > 0$）
- **核心思想**： $x^2$ 变为 $\frac{1}{t^2}$，分母次数降低

**第二步：代入积分**
$$\int \frac{1}{x^2 \sqrt{1 + x^2}} \, dx = \int \frac{1}{\frac{1}{t^2} \cdot \frac{\sqrt{t^2 + 1}}{t}} \cdot \left(-\frac{1}{t^2} dt\right)$$

**第三步：化简被积函数**
分母化简： $\frac{1}{t^2} \cdot \frac{\sqrt{t^2 + 1}}{t} = \frac{\sqrt{t^2 + 1}}{t^3}$

因此：
$$= \int \frac{1}{\frac{\sqrt{t^2 + 1}}{t^3}} \cdot \left(-\frac{1}{t^2}\right) dt = \int \frac{t^3}{\sqrt{t^2 + 1}} \cdot \left(-\frac{1}{t^2}\right) dt = -\int \frac{t}{\sqrt{t^2 + 1}} \, dt$$
**关键简化**： $\frac{t^3}{t^2} = t$，高次项约简

**第四步：计算积分**
对 $-\int \frac{t}{\sqrt{t^2 + 1}} \, dt$，使用凑微分法：
设  $u = t^2 + 1$，则 $du = 2t \, dt$，$t \, dt = \frac{1}{2} du$
$$-\int \frac{t}{\sqrt{t^2 + 1}} \, dt = -\frac{1}{2} \int \frac{du}{\sqrt{u}} = -\frac{1}{2} \cdot 2\sqrt{u} + C = -\sqrt{u} + C = -\sqrt{t^2 + 1} + C$$

**第五步：回代原变量**
- 变量对应： $t = \frac{1}{x}$，则 $t^2 = \frac{1}{x^2}$
- 代入结果： $-\sqrt{t^2 + 1} = -\sqrt{\frac{1}{x^2} + 1} = -\sqrt{\frac{1 + x^2}{x^2}} = -\frac{\sqrt{1 + x^2}}{|x|}$
- 符号处理：由于原积分函数 $\frac{1}{x^2\sqrt{1+x^2}}$ 是偶函数，且当 $x \neq 0$ 时恒为正
- 因此： $-\frac{\sqrt{1 + x^2}}{|x|} = -\frac{\sqrt{1 + x^2}}{|x|} \cdot \frac{x}{x} \cdot \frac{|x|}{|x|} = -\frac{\sqrt{1 + x^2}}{x} \cdot \frac{x}{|x|}$

对于 $x > 0$： $\frac{x}{|x|} = 1$，结果为 $-\frac{\sqrt{1 + x^2}}{x}$  
对于 $x < 0$： $\frac{x}{|x|} = -1$，结果为 $\frac{\sqrt{1 + x^2}}{x}$

**验证一致性**：可以验证 $-\frac{\sqrt{1 + x^2}}{x}$ 对所有 $x \neq 0$ 都给出正确结果

**最终结果**（ $x \neq 0$）：
$$\int \frac{1}{x^2 \sqrt{1 + x^2}} \, dx = -\frac{\sqrt{1 + x^2}}{x} + C$$

### 2.5 第二类换元法总结

**三种换元方法的理论基础与应用对比**：

| 换元类型 | 核心思想 | 理论基础 | 典型换元 | 主要目的 | 适用场景 |
|:---------|:---------|:---------|:---------|:---------|:---------|
| **三角换元** | 利用三角恒等式消根 | $\sin^2 t + \cos^2 t = 1$ <br/> $1 + \tan^2 t = \sec^2 t$ <br/> $\sec^2 t - 1 = \tan^2 t$ | $x = a\sin t$ <br/> $x = a\tan t$ <br/> $x = a\sec t$ | 消除二次根式 | $\sqrt{a^2 \pm x^2}$ <br/> $\sqrt{x^2 \pm a^2}$ |
| **根式换元** | 设根式为新变量 | $t = \sqrt[n]{f(x)}$ → $f(x) = t^n$ | $t = \sqrt{x}$ <br/> $t = \sqrt[3]{x+1}$ | 有理化根式 | $\sqrt[n]{ax+b}$ <br/>多重根式 |
| **倒代换** | 倒数变换降次 | $x = \frac{1}{t}$ → 高次变低次 | $x = \frac{1}{t}$ | 降低分母次数 | 分母次数远高于分子 |



---

#### **常见特殊积分类型**

| 积分类型 |  标准解法  | 解法 | 结果 |
|:---------|:---------|:---------|:-----|
| $\int \tan x \, dx$ | 凑微分法 | $\tan x = \frac{\sin x}{\cos x}$，设  $u = \cos x$，$du = -\sin x \, dx$ | $-\ln\|\cos x\| + C = \ln\|\sec x\| + C$ |
| $\int \cot x \, dx$ | 凑微分法 | $\cot x = \frac{\cos x}{\sin x}$，设  $u = \sin x$，$du = \cos x \, dx$ | $\ln\|\sin x\| + C$ |
| $\int \frac{1}{\sin x} dx$ | 乘除技巧 | 分子分母同乘 $(\csc x + \cot x) = \frac{1+\cos x}{\sin x}$，设  $u = \csc x + \cot x$ | $-\ln\|\csc x + \cot x\| + C$ 或 $\ln\|\tan \frac{x}{2}\| + C$ |
| $\int \frac{1}{\cos x} dx$ | 乘除技巧 | 分子分母同乘 $(\sec x + \tan x) = \frac{1+\sin x}{\cos x}$，设  $u = \sec x + \tan x$ | $\ln\|\sec x + \tan x\| + C$ 或 $\ln\|\tan(\frac{x}{2} + \frac{\pi}{4})\| + C$ |
| $\int \frac{1}{1 + \sin x} dx$ | 乘除技巧 | 分子分母同乘 $(1 - \sin x)$，化为 $\frac{1-\sin x}{\cos^2 x}$ | $\tan x - \sec x + C$ |
| $\int \frac{1}{1 - \sin x} dx$ | 乘除技巧 | 分子分母同乘 $(1 + \sin x)$，化为 $\frac{1+\sin x}{\cos^2 x}$ | $\tan x + \sec x + C$ |
| $\int \frac{1}{1 + \cos x} dx$ | 乘除技巧 | 分子分母同乘 $(1 - \cos x)$，化为 $\frac{1-\cos x}{\sin^2 x}$ | $\tan \frac{x}{2} + C$ |
| $\int \frac{1}{1 - \cos x} dx$ | 乘除技巧 | 分子分母同乘 $(1 + \cos x)$，化为 $\frac{1+\cos x}{\sin^2 x}$ | $-\cot \frac{x}{2} + C$ |
| $\int \frac{1}{\sin x \cos x} dx$ | 恒等变形 | $\frac{1}{\sin x \cos x} = \frac{2}{\sin 2x} = 2\csc 2x$ 或 $= \tan x + \cot x$ | $\ln\|\tan x\| + C$ |
| $\int \sqrt{a^2 - x^2} \, dx$ | 三角替换 | $x = a \sin t$，$dx = a \cos t \, dt$，$\sqrt{a^2-x^2} = a \cos t$ | $\frac{x\sqrt{a^2-x^2}}{2} + \frac{a^2}{2}\arcsin \frac{x}{a} + C$ |
| $\int \sqrt{x^2 + a^2} \, dx$ | 三角替换 | $x = a \tan t$，$dx = a \sec^2 t \, dt$，$\sqrt{x^2+a^2} = a \sec t$ | $\frac{x\sqrt{x^2+a^2}}{2} + \frac{a^2}{2}\ln\|x + \sqrt{x^2+a^2}\| + C$ |
| $\int \sqrt{x^2 - a^2} \, dx$ | 三角替换 | $x = a \sec t$，$dx = a \sec t \tan t \, dt$，$\sqrt{x^2-a^2} = a \tan t$ | $\frac{x\sqrt{x^2-a^2}}{2} - \frac{a^2}{2}\ln\|x + \sqrt{x^2-a^2}\| + C$ |
| $\int \frac{1}{\sqrt{a^2 - x^2}} dx$ | 三角替换 | $x = a \sin t$，$dx = a \cos t \, dt$，$\sqrt{a^2-x^2} = a \cos t$ | $\arcsin \frac{x}{a} + C$ |
| $\int \frac{1}{\sqrt{x^2 + a^2}} dx$ | 三角替换 | $x = a \tan t$，$dx = a \sec^2 t \, dt$，$\sqrt{x^2+a^2} = a \sec t$ | $\ln\|x + \sqrt{x^2+a^2}\| + C$ |
| $\int \frac{1}{\sqrt{x^2 - a^2}} dx$ | 三角替换 | $x = a \sec t$，$dx = a \sec t \tan t \, dt$，$\sqrt{x^2-a^2} = a \tan t$ | $\ln\|x + \sqrt{x^2-a^2}\| + C$ |
| $\int \frac{x}{\sqrt{a^2 - x^2}} dx$ | 凑微分法 | 设  $u = a^2 - x^2$，$du = -2x \, dx$ | $-\sqrt{a^2 - x^2} + C$ |
| $\int \frac{x}{\sqrt{x^2 + a^2}} dx$ | 凑微分法 | 设  $u = x^2 + a^2$，$du = 2x \, dx$ | $\sqrt{x^2 + a^2} + C$ |
| $\int \frac{x}{\sqrt{x^2 - a^2}} dx$ | 凑微分法 | 设  $u = x^2 - a^2$，$du = 2x \, dx$ | $\sqrt{x^2 - a^2} + C$ |
| $\int \frac{1}{\sqrt{ax^2 + bx + c}} dx$ | 配方成上面3种形式+三角替换 | 配方为 $\sqrt{a}\sqrt{(x+\frac{b}{2a})^2 + \frac{4ac-b^2}{4a^2}}$，再用三角替换 | $\frac{1}{\sqrt{a}}\ln\left\|x + \frac{b}{2a} + \sqrt{x^2 + \frac{b}{a}x + \frac{c}{a}}\right\| + C$ |
| $\int \frac{dx}{x^2 + px + q}$ | 配方成上面3种形式+判别式 | 配方为 $(x+\frac{p}{2})^2 + (q-\frac{p^2}{4})$，按 $\Delta = q-\frac{p^2}{4}$ 的符号分类 | $\Delta > 0$: $\frac{1}{\sqrt{\Delta}}\arctan\frac{x+\frac{p}{2}}{\sqrt{\Delta}} + C$ <br/> $\Delta < 0$: $\frac{1}{2\sqrt{-\Delta}}\ln\left\|\frac{x+\frac{p}{2}-\sqrt{-\Delta}}{x+\frac{p}{2}+\sqrt{-\Delta}}\right\| + C$ |
| $\int \frac{1}{x^2 + a^2} dx$ | 反正切公式 | 直接应用反正切积分公式 | $\frac{1}{a}\arctan \frac{x}{a} + C$ |
| $\int \frac{1}{x^2 - a^2} dx$ | 部分分式 | $\frac{1}{x^2-a^2} = \frac{1}{2a}\left(\frac{1}{x-a} - \frac{1}{x+a}\right)$ | $\frac{1}{2a}\ln\left\|\frac{x-a}{x+a}\right\| + C$ |
| $\int \frac{1}{a^2 - x^2} dx$ | 部分分式 | $\frac{1}{a^2-x^2} = \frac{1}{2a}\left(\frac{1}{a-x} + \frac{1}{a+x}\right)$ | $\frac{1}{2a}\ln\left\|\frac{a+x}{a-x}\right\| + C$ |

**部分特殊积分类型解法示例**：

1. **正切积分**： $\int \tan x \, dx$
   
   **详细步骤**：
   $$\int \tan x \, dx = \int \frac{\sin x}{\cos x} \, dx$$
   
   使用凑微分法，设  $u = \cos x$，则 $du = -\sin x \, dx$，$\sin x \, dx = -du$：
   $$\int \frac{\sin x}{\cos x} \, dx = \int \frac{-du}{u} = -\ln|u| + C = -\ln|\cos x| + C$$
   
   **等价形式**：
   $\int \tan x \, dx = -\ln|\cos x| + C = \ln|\sec x| + C$
   
   **验证**： $\frac{d}{dx}[-\ln|\cos x|] = -\frac{1}{\cos x} \cdot (-\sin x) = \frac{\sin x}{\cos x} = \tan x$ ✓

2. **余切积分**： $\int \cot x \, dx$
   
   **详细步骤**：
   $$\int \cot x \, dx = \int \frac{\cos x}{\sin x} \, dx$$
   
   使用凑微分法，设  $u = \sin x$，则 $du = \cos x \, dx$：
   $$\int \frac{\cos x}{\sin x} \, dx = \int \frac{du}{u} = \ln|u| + C = \ln|\sin x| + C$$
   
   **验证**： $\frac{d}{dx}[\ln|\sin x|] = \frac{1}{\sin x} \cdot \cos x = \frac{\cos x}{\sin x} = \cot x$ ✓

3. **余割积分**： $\int \csc x \, dx = \int \frac{1}{\sin x} \, dx$
   
   **详细步骤**：
   $$\frac{1}{\sin x} \cdot \frac{\csc x + \cot x}{\csc x + \cot x} = \frac{\csc x + \cot x}{\sin x(\csc x + \cot x)}$$
   
   注意到： $\sin x(\csc x + \cot x) = \sin x \cdot \frac{1}{\sin x} + \sin x \cdot \frac{\cos x}{\sin x} = 1 + \cos x$
   
   因此： $\int \frac{1}{\sin x} \, dx = \int \frac{\csc x + \cot x}{1 + \cos x} \, dx$
   
   设  $u = \csc x + \cot x = \frac{1 + \cos x}{\sin x}$，则：
   $$\frac{du}{dx} = -\csc x \cot x - \csc^2 x = -\frac{\cos x}{\sin^2 x} - \frac{1}{\sin^2 x} = -\frac{1 + \cos x}{\sin^2 x}$$
   
   即： $du = -\frac{1 + \cos x}{\sin^2 x} dx = -\frac{u}{\sin x} dx$，所以 $\frac{dx}{\sin x} = -\frac{du}{u}$
   
   **结果**：
   $\int \csc x \, dx = -\int \frac{du}{u} = -\ln|u| + C = -\ln|\csc x + \cot x| + C$

4. **正割积分**： $\int \sec x \, dx = \int \frac{1}{\cos x} \, dx$
   
   **详细步骤**：
   $$\frac{1}{\cos x} \cdot \frac{\sec x + \tan x}{\sec x + \tan x} = \frac{\sec x + \tan x}{\cos x(\sec x + \tan x)}$$
   
   注意到： $\cos x(\sec x + \tan x) = \cos x \cdot \frac{1}{\cos x} + \cos x \cdot \frac{\sin x}{\cos x} = 1 + \sin x$
   
   设  $u = \sec x + \tan x = \frac{1 + \sin x}{\cos x}$，则：
   $$\frac{du}{dx} = \sec x \tan x + \sec^2 x = \frac{\sin x}{\cos^2 x} + \frac{1}{\cos^2 x} = \frac{1 + \sin x}{\cos^2 x}$$
   
   即： $du = \frac{1 + \sin x}{\cos^2 x} dx = \frac{u}{\cos x} dx$，所以 $\frac{dx}{\cos x} = \frac{du}{u}$
   
   **结果**：
   $\int \sec x \, dx = \int \frac{du}{u} = \ln|u| + C = \ln|\sec x + \tan x| + C$


5. **正弦余弦乘积积分**： $\int \frac{1}{\sin x \cos x} \, dx$
   
   **方法一（部分分式）**：
   $$\frac{1}{\sin x \cos x} = \frac{2}{2\sin x \cos x} = \frac{2}{\sin 2x} = 2\csc 2x$$
   
   设  $u = 2x$，$du = 2dx$：
   $$\int \frac{1}{\sin x \cos x} \, dx = \int 2\csc 2x \, dx = \int \csc u \, du = -\ln|\csc u + \cot u| + C$$
   $$= -\ln|\csc 2x + \cot 2x| + C$$
   
   **方法二（直接分解）**：
   $$\frac{1}{\sin x \cos x} = \frac{\sin^2 x + \cos^2 x}{\sin x \cos x} = \frac{\sin x}{\cos x} + \frac{\cos x}{\sin x} = \tan x + \cot x$$
   
   $$\int (\tan x + \cot x) \, dx = -\ln|\cos x| + \ln|\sin x| + C = \ln\left|\frac{\sin x}{\cos x}\right| + C = \ln|\tan x| + C$$

6. **根式积分**： $\int \sqrt{4 - x^2} \, dx$
   
   **详细步骤**：
   使用三角替换： $x = 2\sin t$，$dx = 2\cos t \, dt$，$\sqrt{4-x^2} = 2\cos t$
   
   $$\int \sqrt{4 - x^2} \, dx = \int 2\cos t \cdot 2\cos t \, dt = 4\int \cos^2 t \, dt$$
   
   使用降幂公式： $\cos^2 t = \frac{1 + \cos 2t}{2}$
   
   $$= 4 \cdot \frac{1}{2}\int (1 + \cos 2t) \, dt = 2\left(t + \frac{\sin 2t}{2}\right) + C$$
   $$= 2t + \sin 2t + C = 2t + 2\sin t \cos t + C$$
   
   回代： $t = \arcsin\frac{x}{2}$，$\sin t = \frac{x}{2}$，$\cos t = \frac{\sqrt{4-x^2}}{2}$
   
   **结果**：
   $\int \sqrt{4 - x^2} \, dx = 2\arcsin\frac{x}{2} + \frac{x\sqrt{4-x^2}}{2} + C$


7. **根式积分**： $\int \sqrt{x^2 + a^2} \, dx$
   
   **详细步骤**：
   使用三角替换： $x = a\tan t$，$dx = a\sec^2 t \, dt$，$\sqrt{x^2+a^2} = a\sec t$
   
   $$\int \sqrt{x^2 + a^2} \, dx = \int a\sec t \cdot a\sec^2 t \, dt = a^2\int \sec^3 t \, dt$$
   
   对于 $\int \sec^3 t \, dt$，使用分部积分：
   设  $u = \sec t$，$dv = \sec^2 t \, dt$，则 $du = \sec t \tan t \, dt$，$v = \tan t$
   
   $$\int \sec^3 t \, dt = \sec t \tan t - \int \tan^2 t \sec t \, dt$$
   $$= \sec t \tan t - \int (\sec^2 t - 1)\sec t \, dt$$
   $$= \sec t \tan t - \int \sec^3 t \, dt + \int \sec t \, dt$$
   
   设  $I = \int \sec^3 t \, dt$，则：
   $$I = \sec t \tan t - I + \ln|\sec t + \tan t|$$
   $$2I = \sec t \tan t + \ln|\sec t + \tan t|$$
   $$I = \frac{1}{2}[\sec t \tan t + \ln|\sec t + \tan t|]$$
   
   回代： $\sec t = \frac{\sqrt{x^2+a^2}}{a}$，$\tan t = \frac{x}{a}$
   
   **结果**：
   $\int \sqrt{x^2 + a^2} \, dx = \frac{x\sqrt{x^2+a^2}}{2} + \frac{a^2}{2}\ln\left|x + \sqrt{x^2+a^2}\right| + C$


8. **根式积分**： $\int \sqrt{x^2 - a^2} \, dx$
   
   **详细步骤**：
   使用三角替换： $x = a\sec t$，$dx = a\sec t \tan t \, dt$，$\sqrt{x^2-a^2} = a\tan t$
   
   $$\int \sqrt{x^2 - a^2} \, dx = \int a\tan t \cdot a\sec t \tan t \, dt = a^2\int \sec t \tan^2 t \, dt$$
   $$= a^2\int \sec t (\sec^2 t - 1) \, dt = a^2\int (\sec^3 t - \sec t) \, dt$$
   
   利用前面的结果：
   $$= a^2\left[\frac{1}{2}(\sec t \tan t + \ln|\sec t + \tan t|) - \ln|\sec t + \tan t|\right] + C$$
   $$= \frac{a^2}{2}\sec t \tan t - \frac{a^2}{2}\ln|\sec t + \tan t| + C$$
   
   回代： $\sec t = \frac{x}{a}$，$\tan t = \frac{\sqrt{x^2-a^2}}{a}$
   
   **结果**：
   $\int \sqrt{x^2 - a^2} \, dx = \frac{x\sqrt{x^2-a^2}}{2} - \frac{a^2}{2}\ln\left|x + \sqrt{x^2-a^2}\right| + C$

9. **配方积分**： $\int \frac{1}{\sqrt{x^2 + 2x + 5}} \, dx$ 
   
   **详细步骤**：
   配方： $x^2 + 2x + 5 = (x+1)^2 + 4$
   
   设  $u = x+1$，$du = dx$：
   $$\int \frac{1}{\sqrt{x^2 + 2x + 5}} \, dx = \int \frac{1}{\sqrt{u^2 + 4}} \, du$$
   
   使用三角替换： $u = 2\tan t$，$du = 2\sec^2 t \, dt$，$\sqrt{u^2+4} = 2\sec t$
   
   $$= \int \frac{2\sec^2 t \, dt}{2\sec t} = \int \sec t \, dt = \ln|\sec t + \tan t| + C$$
   
   回代： $\sec t = \frac{\sqrt{u^2+4}}{2}$，$\tan t = \frac{u}{2}$
   
   **结果**：
   $\int \frac{1}{\sqrt{x^2 + 2x + 5}} \, dx = \ln\left|\frac{x+1+\sqrt{x^2+2x+5}}{2}\right| + C$
   
   简化为：
   $= \ln|x + 1 + \sqrt{x^2 + 2x + 5}| + C'$

10. **有理函数配方积分**： $\int \frac{1}{x^2 + px + q} \, dx$
   
   **详细步骤**：
   配方： $x^2 + px + q = \left(x + \frac{p}{2}\right)^2 + \left(q - \frac{p^2}{4}\right)$
   
   设  $\Delta = q - \frac{p^2}{4}$ （判别式的相关量）， $u = x + \frac{p}{2}$
   
   **情况1**： $\Delta > 0$ （设  $\Delta = a^2$）
   $$\int \frac{1}{x^2 + px + q} \, dx = \int \frac{1}{u^2 + a^2} \, du = \frac{1}{a}\arctan\frac{u}{a} + C$$
   $$= \frac{1}{\sqrt{q - \frac{p^2}{4}}}\arctan\frac{x + \frac{p}{2}}{\sqrt{q - \frac{p^2}{4}}} + C$$
   
   **情况2**： $\Delta < 0$ （设  $\Delta = -a^2$）
   $$\int \frac{1}{x^2 + px + q} \, dx = \int \frac{1}{u^2 - a^2} \, du = \frac{1}{2a}\ln\left|\frac{u-a}{u+a}\right| + C$$
   $$= \frac{1}{2\sqrt{\frac{p^2}{4} - q}}\ln\left|\frac{x + \frac{p}{2} - \sqrt{\frac{p^2}{4} - q}}{x + \frac{p}{2} + \sqrt{\frac{p^2}{4} - q}}\right| + C$$

#### **凑微分法学习要点总结**

> **识别关键原则**：
> 1. **观察结构**：寻找被积函数中是否存在某个函数及其导数的乘积关系
> 2. **导数匹配**：检查分子（或因子）是否为分母（或另一因子）的导数（或导数的常数倍）
> 3. **系数调整**：通过乘以适当的常数使微分形式完全匹配
> 
> **解题步骤**：
> 1. **结构分析**：识别复合函数的内层函数 $\varphi(x)$
> 2. **导数计算**：求出 $\varphi'(x)$
> 3. **匹配检验**：检查被积函数中是否含有 $\varphi'(x)$ 或其常数倍
> 4. **系数调整**：添加必要的系数使形式完全匹配
> 5. **换元积分**：设  $u = \varphi(x)$，进行积分计算
> 6. **回代结果**：将 $u$ 替换回原变量
> 
> **常见错误避免**：
> - ❌ 忽略常数系数的调整
> - ❌ 混淆正负号（特别是三角函数）
> - ❌ 忘记绝对值（对数函数）
> - ❌ 不验证凑微分的正确性

#### **凑微分法的适用界限**

**重要提醒**：并非所有积分都能用凑微分法求解。当被积函数**不存在**明显的"函数及其导数"的乘积结构时，需要采用其他积分方法：

> **判断原则**：
> - ✅ **适用凑微分**：能找到 $f(\varphi(x)) \cdot \varphi'(x)$ 或 $\frac{f(\varphi(x))}{\varphi'(x)}$ 结构
> - ❌ **不适用凑微分**：缺乏明显的复合函数导数关系
> 
> **替代方法**：
> - **三角替换法**：处理根式积分 $\sqrt{a^2 \pm x^2}$、 $\sqrt{x^2 \pm a^2}$
> - **分部积分法**：处理 $x^n e^x$、 $x^n \ln x$、 $x^n \sin x$ 等
> - **有理函数分解**：处理分式积分 $\frac{P(x)}{Q(x)}$
> - **特殊技巧**：万能代换、乘除技巧、递推公式等

上表中的"常见特殊积分类型"提供了具体的非凑微分法积分及其标准解法。

---

## 3. 分部积分法

### 3.1 基本公式与原理

> **定理3.1（分部积 分公式）**
> 
> 若函数 $u(x)$ 和 $v(x)$ 都可微，则：
> $$\int u \, dv = uv - \int v \, du$$

**推导**：基于乘积的微分法则 $(uv)' = u'v + uv'$

**适用场景**：
- **乘积积分**：被积函数是两个不同类型函数的乘积
- **降次积分**：通过分部使某个函数的次数降低
- **单一函数**：如 $\int \ln x \, dx$、 $\int \arctan x \, dx$ （令 $dv = dx$）
- **递推积分**：如 $\int x^n e^x \, dx$、 $\int x^n \sin x \, dx$
- **循环积分**：如 $\int e^x \sin x \, dx$、 $\int e^x \cos x \, dx$

**选择策略**：
1. 使用ILATE原则选择 $u$
2. 确保 $\int v \, du$ 比原积分简单
3. 对于递推积分，建立递推关系
4. 对于循环积分，建立方程组求解

### 3.2 函数选择原则的建议

#### **"ILATE"原则**

选择 $u$ 的优先级顺序（从高到低）：
- **I**：反三角函数（Inverse trigonometric）
- **L**：对数函数（Logarithmic）
- **A**：代数函数（Algebraic）
- **T**：三角函数（Trigonometric）
- **E**：指数函数（Exponential）

**记忆口诀**："反对幂三指"

> **例题3.1**：计算 $\int x e^x \, dx$

**解答**：
选择： $u = x$ （代数函数）， $dv = e^x \, dx$ （指数函数）
则： $du = dx$，$v = e^x$
$$\int x e^x \, dx = x e^x - \int e^x \, dx = x e^x - e^x + C = e^x(x - 1) + C$$

> **例题3.2**：计算 $\int \ln x \, dx$

**解答**：
选择： $u = \ln x$ （对数函数）， $dv = dx$ （常数函数）
则： $du = \frac{1}{x} dx$，$v = x$
$$\int \ln x \, dx = x \ln x - \int x \cdot \frac{1}{x} \, dx = x \ln x - \int dx = x \ln x - x + C$$

### 3.3 递推积分

对于形如 $\int x^n e^x \, dx$、 $\int x^n \sin x \, dx$ 等需要多次分部积分的情况。

> **例题3.3**：计算 $\int x^2 e^x \, dx$

**解答**：
第一次分部： $u = x^2$，$dv = e^x \, dx$
$$\int x^2 e^x \, dx = x^2 e^x - \int 2x e^x \, dx$$

第二次分部：对 $\int 2x e^x \, dx$，$u = 2x$，$dv = e^x \, dx$
$$\int 2x e^x \, dx = 2x e^x - \int 2 e^x \, dx = 2x e^x - 2 e^x$$

因此：
$$\int x^2 e^x \, dx = x^2 e^x - (2x e^x - 2 e^x) = e^x(x^2 - 2x + 2) + C$$

### 3.4 特殊技巧

#### **循环积分**

对于某些积分，多次分部积分后会回到原积分，可建立方程求解。

> **例题3.4**：计算 $\int e^x \sin x \, dx$

**解答**：
设  $I = \int e^x \sin x \, dx$

第一次分部： $u = \sin x$，$dv = e^x \, dx$
$$I = \sin x \cdot e^x - \int e^x \cos x \, dx$$

第二次分部：对 $\int e^x \cos x \, dx$，$u = \cos x$，$dv = e^x \, dx$
$$\int e^x \cos x \, dx = \cos x \cdot e^x - \int e^x (-\sin x) \, dx = e^x \cos x + \int e^x \sin x \, dx$$

代入得：
$$I = e^x \sin x - (e^x \cos x + I)$$
$$I = e^x \sin x - e^x \cos x - I$$
$$2I = e^x(\sin x - \cos x)$$
$$I = \frac{e^x(\sin x - \cos x)}{2} + C$$

### 3.5 递推公式法

**适用场景**：
- 同类型积分的递推关系建立
- $\int x^n e^x \, dx$、 $\int \sin^n x \, dx$、 $\int \sec^n x \, dx$ 等
- 降低积分的复杂度

**基本思路**：通过分部积分建立递推关系，将高次幂积分转化为低次幂积分。

> **例题3.5**：建立 $I_n = \int (1 + x^2)^n \, dx$ 的递推关系

**解答**：
使用分部积分： $u = (1 + x^2)^n$，$dv = dx$
$$I_n = x(1 + x^2)^n - \int x \cdot n(1 + x^2)^{n-1} \cdot 2x \, dx$$
$$= x(1 + x^2)^n - 2n \int x^2(1 + x^2)^{n-1} \, dx$$
$$= x(1 + x^2)^n - 2n \int (1 + x^2 - 1)(1 + x^2)^{n-1} \, dx$$
$$= x(1 + x^2)^n - 2n[I_n - I_{n-1}]$$

整理得： $(2n + 1)I_n = x(1 + x^2)^n + 2nI_{n-1}$

**递推公式**：
$$I_n = \frac{x(1 + x^2)^n + 2nI_{n-1}}{2n + 1}$$

---

## 4. 有理函数的积分

### 4.1 有理函数的分类与适用场景

有理函数： $R(x) = \frac{P(x)}{Q(x)}$，其中 $P(x)$ 和 $Q(x)$ 是多项式。

**适用场景**：
- 分子、分母都是多项式的函数积分
- 经过三角换元、根式换元后得到的有理函数
- 某些三角函数经万能公式转换后的有理函数
- 部分分式法是有理函数积分的万能方法

**分类与处理策略**：
1. **真分式**： $\deg P(x) < \deg Q(x)$ → 直接进行部分分式分解
2. **假分式**： $\deg P(x) \geq \deg Q(x)$ → 先做多项式长除法，再处理余项

**基本思路**：
- 将复杂的有理函数分解为简单分式的和
- 每个简单分式都有对应的积分公式
- 关键是分母的因式分解和待定系数法

### 4.2 部分分式分解

**基本原理**：将有理函数 $\frac{P(x)}{Q(x)}$ 分解为若干个简单分式的和，每个简单分式都有对应的积分公式。

**分解类型总结**：
1. **真分式**： $\deg P(x) < \deg Q(x)$ → 直接分解
2. **假分式**： $\deg P(x) \geq \deg Q(x)$ → 先做多项式长除法
3. **不重根**： $Q(x) = (x-a_1)(x-a_2)\cdots(x-a_n)$ → $\frac{A_i}{x-a_i}$
4. **重根**：含 $(x-a)^k$ → $\frac{A_1}{x-a} + \frac{A_2}{(x-a)^2} + \cdots + \frac{A_k}{(x-a)^k}$

#### **假分式处理**

**处理原则**：当分子次数 ≥ 分母次数时，必须先进行多项式长除法。

> **例题4.1**：计算 $\int \frac{x^3 + 2x^2 - x + 1}{x^2 + x - 2} \, dx$

**解答**：

**第一步：判断分式类型**
- 分子次数：3
- 分母次数：2
- 由于 $3 > 2$，这是假分式，需要先做长除法

**第二步：多项式长除法** （插入补充一个基础知识点）

**类比思考**：就像数字除法 $1234 \div 56$ 一样，我们用多项式除法来计算 $(x^3+2x^2-x+1) \div (x^2+x-2)$

**数字除法回顾**（帮助理解）：
```
      22  ← 商
   ______
56 | 1234  ← 被除数
     112   ← 2×56（看1234的前三位123，12÷5=2余2）
     ___
      114  ← 123-112=11，下拉4得114
      112  ← 2×56（11÷5=2余1）
      ___
        2  ← 余数
```
关系： $1234 = 56 \times 22 + 2$

**多项式除法**（完全相同的思路）：

**详细步骤**：

**第1步：首项相除**
- 看被除式的最高次项： $x^3$
- 看除式的最高次项： $x^2$ 
- 计算： $x^3 \div x^2 = x$ （这是商的第一项）

**第2步：相乘并相减**
- 用刚得到的 $x$ 乘以整个除式： $x \times (x^2+x-2) = x^3+x^2-2x$
- 从被除式中减去这个结果：
  $(x^3+2x^2-x+1) - (x^3+x^2-2x) = x^2+x+1$

**第3步：重复过程**
- 现在用 $x^2+x+1$ 继续除以 $x^2+x-2$
- 首项相除： $x^2 \div x^2 = 1$ （这是商的第二项）
- 相乘： $1 \times (x^2+x-2) = x^2+x-2$
- 相减： $(x^2+x+1) - (x^2+x-2) = 3$

**第4步：无法继续**
- 余项 $3$ 的次数（0次）小于除式次数（2次），除法结束

**用表格形式整理**：
```
商式：         x   +   1
         ________________
除式 x²+x-2 | x³+2x²-x+1    ← 被除式
             x³+x²-2x       ← x×(x²+x-2)
             ___________
               x²+x+1       ← 第一次相减结果
               x²+x-2       ← 1×(x²+x-2)  
               _______
                   3        ← 最终余式
```

**结果解读**：
- **商式**： $x + 1$
- **余式**： $3$
- **关系式**：被除式 = 除式 × 商式 + 余式

**验证**： $(x^2+x-2)(x+1) + 3 = x^3+x^2-2x+x^2+x-2+3 = x^3+2x^2-x+1$ ✓

**记忆口诀**："除乘减带"
- **除**：首项相除得商的一项
- **乘**：用这一项乘以除式
- **减**：从被除式（余式）中减去
- **带**：带下一项继续（如果还有的话）

**注意事项**：
1. **对齐同类项**：相同次数的项要对齐书写
2. **保持符号**：减法时要特别注意正负号
3. **补齐项次**：如果某次项系数为0，要写成 $0x^n$ 避免遗漏
4. **停止条件**：余式次数 < 除式次数时停止

**实际意义**：通过长除法，我们将假分式转化为多项式+真分式的形式，这样就可以分别处理了！

**快速练习**：试着计算 $\frac{x^2 + 3x + 1}{x + 1}$
<details>
<summary>点击查看答案</summary>

按照"除乘减带"的步骤：
1. $x^2 \div x = x$
2. $x \times (x+1) = x^2 + x$
3. $(x^2 + 3x + 1) - (x^2 + x) = 2x + 1$
4. $2x \div x = 2$  
5. $2 \times (x+1) = 2x + 2$
6. $(2x + 1) - (2x + 2) = -1$

结果： $\frac{x^2 + 3x + 1}{x + 1} = x + 2 - \frac{1}{x + 1}$

验证： $(x+1)(x+2) - 1 = x^2 + 3x + 2 - 1 = x^2 + 3x + 1$ ✓
</details>

因此： $\frac{x^3 + 2x^2 - x + 1}{x^2 + x - 2} = x + 1 + \frac{3}{x^2 + x - 2}$

**第三步：分解剩余的真分式**
对 $\frac{3}{x^2 + x - 2}$ 进行部分分式分解。

首先分解分母： $x^2 + x - 2 = (x + 2)(x - 1)$

$$\frac{3}{(x + 2)(x - 1)} = \frac{A}{x + 2} + \frac{B}{x - 1}$$

**第四步：待定系数法**
通分得： $3 = A(x - 1) + B(x + 2)$

**方法1（代入特殊值）**：
- 令 $x = 1$： $3 = A(0) + B(3)$ → $3 = 3B$ → $B = 1$
- 令 $x = -2$： $3 = A(-3) + B(0)$ → $3 = -3A$ → $A = -1$

**方法2（比较系数）**：
$3 = Ax - A + Bx + 2B = (A + B)x + (-A + 2B)$
- 比较 $x$ 的系数： $0 = A + B$
- 比较常数项： $3 = -A + 2B$
- 解得： $A = -1$，$B = 1$

**第五步：计算积分**
$$\int \frac{x^3 + 2x^2 - x + 1}{x^2 + x - 2} \, dx = \int \left(x + 1 + \frac{-1}{x + 2} + \frac{1}{x - 1}\right) dx$$
$$= \frac{x^2}{2} + x - \ln|x + 2| + \ln|x - 1| + C = \frac{x^2}{2} + x + \ln\left|\frac{x - 1}{x + 2}\right| + C$$

**验证结果**：对结果求导检验：
$$\frac{d}{dx}\left[\frac{x^2}{2} + x + \ln\left|\frac{x - 1}{x + 2}\right|\right] = x + 1 + \frac{1}{\frac{x-1}{x+2}} \cdot \frac{(x+2) - (x-1)}{(x+2)^2}$$
$$= x + 1 + \frac{x+2}{x-1} \cdot \frac{3}{(x+2)^2} = x + 1 + \frac{3}{(x-1)(x+2)} = x + 1 + \frac{3}{x^2+x-2}$$

这正是原被积函数 $\frac{x^3 + 2x^2 - x + 1}{x^2 + x - 2}$ ✓

#### **不重根情况**

若 $Q(x) = (x - a_1)(x - a_2) \cdots (x - a_n)$，且 $a_i$ 互不相同，则：
$$\frac{P(x)}{Q(x)} = \frac{A_1}{x - a_1} + \frac{A_2}{x - a_2} + \cdots + \frac{A_n}{x - a_n}$$

> **例题4.2**：计算 $\int \frac{3x + 1}{x^3 - x^2 - 2x} \, dx$

**解答**：

**第一步：分解分母**
$x^3 - x^2 - 2x = x(x^2 - x - 2) = x(x - 2)(x + 1)$

**分解过程**：
- 提取公因子： $x^3 - x^2 - 2x = x(x^2 - x - 2)$
- 分解二次式： $x^2 - x - 2$，寻找两数之积为 $-2$，和为 $-1$
- 找到 $-2$ 和 $1$： $(x - 2)(x + 1) = x^2 - x - 2$

**第二步：部分分式分解**
$$\frac{3x + 1}{x(x - 2)(x + 1)} = \frac{A}{x} + \frac{B}{x - 2} + \frac{C}{x + 1}$$

**第三步：求待定系数**
通分得： $3x + 1 = A(x - 2)(x + 1) + Bx(x + 1) + Cx(x - 2)$

**方法：代入特殊值**
- 令 $x = 0$： $1 = A(-2)(1) + 0 + 0$ → $1 = -2A$ → $A = -\frac{1}{2}$
- 令 $x = 2$： $7 = 0 + B(2)(3) + 0$ → $7 = 6B$ → $B = \frac{7}{6}$
- 令 $x = -1$： $-2 = 0 + 0 + C(-1)(-3)$ → $-2 = 3C$ → $C = -\frac{2}{3}$

**验证**：
展开 $A(x-2)(x+1) + Bx(x+1) + Cx(x-2)$：
$$-\frac{1}{2}(x^2-x-2) + \frac{7}{6}x(x+1) - \frac{2}{3}x(x-2)$$
$$= -\frac{1}{2}x^2 + \frac{1}{2}x + 1 + \frac{7}{6}x^2 + \frac{7}{6}x - \frac{2}{3}x^2 + \frac{4}{3}x$$

整理之后继续：

**第四步：计算积分**
$$\int \frac{3x + 1}{x^3 - x^2 - 2x} \, dx = -\frac{1}{2}\int \frac{1}{x} \, dx + \frac{7}{6}\int \frac{1}{x - 2} \, dx - \frac{2}{3}\int \frac{1}{x + 1} \, dx$$
$$= -\frac{1}{2}\ln|x| + \frac{7}{6}\ln|x - 2| - \frac{2}{3}\ln|x + 1| + C$$

**验证结果**：对结果求导检验：
$$\frac{d}{dx}\left[-\frac{1}{2}\ln|x| + \frac{7}{6}\ln|x - 2| - \frac{2}{3}\ln|x + 1|\right]$$
$$= -\frac{1}{2x} + \frac{7}{6(x-2)} - \frac{2}{3(x+1)}$$

通分到公分母 $6x(x-2)(x+1)$：
$$= \frac{-3(x-2)(x+1) + 7x(x+1) - 4x(x-2)}{6x(x-2)(x+1)}$$
$$= \frac{-3(x^2-x-2) + 7x(x+1) - 4x(x-2)}{6x(x-2)(x+1)}$$
$$= \frac{-3x^2+3x+6 + 7x^2+7x - 4x^2+8x}{6x(x-2)(x+1)}$$
$$= \frac{18x+6}{6x(x-2)(x+1)} = \frac{6(3x+1)}{6x(x-2)(x+1)} = \frac{3x+1}{x(x-2)(x+1)}$$

这正是原被积函数 $\frac{3x + 1}{x^3 - x^2 - 2x}$ ✓

#### **重根情况**

若 $Q(x)$ 含有 $k$ 重因子 $(x-a)^k$，则对应项为：
$$\frac{A_1}{x-a} + \frac{A_2}{(x-a)^2} + \cdots + \frac{A_k}{(x-a)^k}$$

> **例题4.3**：计算 $\int \frac{x^2 + 1}{(x - 1)^3(x + 2)} \, dx$

**解答**：

**第一步：设置部分分式形式**
由于分母含有三重根 $(x-1)^3$ 和单根 $(x+2)$：
$$\frac{x^2 + 1}{(x - 1)^3(x + 2)} = \frac{A}{x - 1} + \frac{B}{(x - 1)^2} + \frac{C}{(x - 1)^3} + \frac{D}{x + 2}$$

**第二步：通分求系数**
通分得：
$$x^2 + 1 = A(x-1)^2(x+2) + B(x-1)(x+2) + C(x+2) + D(x-1)^3$$

**第三步：代入特殊值法**

**求系数 $C$ **（令 $x = 1$）：
$1 + 1 = 0 + 0 + C(3) + 0$ → $2 = 3C$ → $C = \frac{2}{3}$

**求系数 $D$ **（令 $x = -2$）：
$4 + 1 = 0 + 0 + 0 + D(-3)^3$ → $5 = -27D$ → $D = -\frac{5}{27}$

**求系数 $A$ 和 $B$ **（比较系数法）：
展开右端并整理成标准形式，比较 $x^3$ 和 $x^2$ 的系数。

展开 $A(x-1)^2(x+2) = A(x^2-2x+1)(x+2) = A(x^3+2x^2-2x^2-4x+x+2) = A(x^3-3x+2)$

展开 $B(x-1)(x+2) = B(x^2+x-2)$

展开 $D(x-1)^3 = D(x^3-3x^2+3x-1)$

整理得：
$$x^2 + 1 = (A + D)x^3 + (2A + B - 3D)x^2 + (-3A + B + 3D)x + (2A - 2B + C - D)$$

由于左端最高次项为 $x^2$，所以：
- $x^3$ 系数： $A + D = 0$ → $A = -D = \frac{5}{27}$
- $x^2$ 系数： $2A + B - 3D = 1$ → $2 \cdot \frac{5}{27} + B - 3 \cdot (-\frac{5}{27}) = 1$
  $\frac{10}{27} + B + \frac{15}{27} = 1$ → $B = 1 - \frac{25}{27} = \frac{2}{27}$

**验证**：检查 $x$ 项和常数项系数是否一致（留作练习）。

**第四步：计算积分**
$$\int \frac{x^2 + 1}{(x - 1)^3(x + 2)} \, dx = \frac{5}{27}\int \frac{1}{x - 1} \, dx + \frac{2}{27}\int \frac{1}{(x - 1)^2} \, dx + \frac{2}{3}\int \frac{1}{(x - 1)^3} \, dx - \frac{5}{27}\int \frac{1}{x + 2} \, dx$$

$$= \frac{5}{27}\ln|x - 1| + \frac{2}{27} \cdot \left(-\frac{1}{x - 1}\right) + \frac{2}{3} \cdot \left(-\frac{1}{2(x - 1)^2}\right) - \frac{5}{27}\ln|x + 2| + C$$

$$= \frac{5}{27}\ln\left|\frac{x - 1}{x + 2}\right| - \frac{2}{27(x - 1)} - \frac{1}{3(x - 1)^2} + C$$

### 4.3 二次因式的处理

**基本原理**：对于不可分解的二次因式 $ax^2 + bx + c$ （判别式 $\Delta = b^2 - 4ac < 0$），在部分分式分解中对应项为：
$$\frac{Ax + B}{ax^2 + bx + c}$$

**处理方法**：
1. **分解**：将分子为一次式的分式分解为两部分
2. **配方**：将二次因式配方为 $(u \pm a)^2$ 的形式
3. **替换**：使用三角替换或对数、反正切积分公式

#### **含不可约二次因式的分解**

> **例题4.4**：计算 $\int \frac{x^2 + x + 1}{(x + 1)(x^2 + x + 1)} \, dx$

**解答**：

**第一步：简化分式**
注意到分子 $x^2 + x + 1$ 与分母中的二次因式相同，可以约分：
$$\frac{x^2 + x + 1}{(x + 1)(x^2 + x + 1)} = \frac{1}{x + 1}$$

因此：
$$\int \frac{x^2 + x + 1}{(x + 1)(x^2 + x + 1)} \, dx = \int \frac{1}{x + 1} \, dx = \ln|x + 1| + C$$

> **例题4.5**：计算 $\int \frac{2x + 3}{(x + 1)(x^2 + x + 1)} \, dx$

**解答**：

**第一步：部分分式分解**
$$\frac{2x + 3}{(x + 1)(x^2 + x + 1)} = \frac{A}{x + 1} + \frac{Bx + C}{x^2 + x + 1}$$

**第二步：求待定系数**
通分得： $2x + 3 = A(x^2 + x + 1) + (Bx + C)(x + 1)$

**令 $x = -1$ **：
$2(-1) + 3 = A(1 - 1 + 1) + 0$ → $1 = A$ → $A = 1$

**比较系数法**：
展开 $A(x^2 + x + 1) + (Bx + C)(x + 1) = x^2 + x + 1 + Bx^2 + Bx + Cx + C$
$= (1 + B)x^2 + (1 + B + C)x + (1 + C)$

比较 $2x + 3$：
- $x^2$ 系数： $0 = 1 + B$ → $B = -1$
- $x$ 系数： $2 = 1 + B + C = 1 + (-1) + C = C$ → $C = 2$
- 常数项： $3 = 1 + C = 1 + 2 = 3$ ✓

**第三步：分解积分**
$$\int \frac{2x + 3}{(x + 1)(x^2 + x + 1)} \, dx = \int \frac{1}{x + 1} \, dx + \int \frac{-x + 2}{x^2 + x + 1} \, dx$$

$$= \ln|x + 1| + \int \frac{-x + 2}{x^2 + x + 1} \, dx$$

**第四步：处理含二次因式的积分**
对于 $\int \frac{-x + 2}{x^2 + x + 1} \, dx$，我们将其分解为两部分：

**分解技巧**：设  $-x + 2 = A \cdot \frac{d}{dx}(x^2 + x + 1) + B$
$\frac{d}{dx}(x^2 + x + 1) = 2x + 1$

所以： $-x + 2 = A(2x + 1) + B = 2Ax + A + B$

比较系数：
- $x$ 系数： $-1 = 2A$ → $A = -\frac{1}{2}$
- 常数项： $2 = A + B = -\frac{1}{2} + B$ → $B = \frac{5}{2}$

因此：
$$\int \frac{-x + 2}{x^2 + x + 1} \, dx = -\frac{1}{2} \int \frac{2x + 1}{x^2 + x + 1} \, dx + \frac{5}{2} \int \frac{1}{x^2 + x + 1} \, dx$$

**第五步：计算各部分积分**

**对于第一部分**：
$$-\frac{1}{2} \int \frac{2x + 1}{x^2 + x + 1} \, dx = -\frac{1}{2} \ln(x^2 + x + 1) + C_1$$

**对于第二部分**：
需要配方： $x^2 + x + 1 = \left(x + \frac{1}{2}\right)^2 + \frac{3}{4}$

设  $u = x + \frac{1}{2}$，$du = dx$：
$$\frac{5}{2} \int \frac{1}{x^2 + x + 1} \, dx = \frac{5}{2} \int \frac{1}{u^2 + \frac{3}{4}} \, du = \frac{5}{2} \int \frac{1}{\frac{3}{4}(\frac{4u^2}{3} + 1)} \, du$$

$$= \frac{5}{2} \cdot \frac{4}{3} \int \frac{1}{\left(\frac{2u}{\sqrt{3}}\right)^2 + 1} \, du$$

设  $v = \frac{2u}{\sqrt{3}} = \frac{2(x + \frac{1}{2})}{\sqrt{3}} = \frac{2x + 1}{\sqrt{3}}$，$dv = \frac{2}{\sqrt{3}} du$：

$$= \frac{10}{3} \cdot \frac{\sqrt{3}}{2} \int \frac{1}{v^2 + 1} \, dv = \frac{5\sqrt{3}}{3} \arctan v + C_2$$

$$= \frac{5\sqrt{3}}{3} \arctan\frac{2x + 1}{\sqrt{3}} + C_2$$

**第六步：合并结果**
$$\int \frac{2x + 3}{(x + 1)(x^2 + x + 1)} \, dx = \ln|x + 1| - \frac{1}{2} \ln(x^2 + x + 1) + \frac{5\sqrt{3}}{3} \arctan\frac{2x + 1}{\sqrt{3}} + C$$

**验证结果**：对结果求导检验（省略详细计算）：
$$\frac{d}{dx}\left[\ln|x + 1| - \frac{1}{2} \ln(x^2 + x + 1) + \frac{5\sqrt{3}}{3} \arctan\frac{2x + 1}{\sqrt{3}}\right]$$
$$= \frac{1}{x+1} - \frac{1}{2} \cdot \frac{2x+1}{x^2+x+1} + \frac{5\sqrt{3}}{3} \cdot \frac{1}{1+\frac{(2x+1)^2}{3}} \cdot \frac{2}{\sqrt{3}}$$

经过化简可得原被积函数 $\frac{2x + 3}{(x + 1)(x^2 + x + 1)}$ ✓

#### **含重复二次因式的处理**

> **例题4.6**：计算 $\int \frac{x}{(x^2 + 1)^2} \, dx$

**解答**：

**方法一：直接凑微分**
观察到分子 $x$ 恰好是分母中 $x^2 + 1$ 的导数的一半：
$$\frac{d}{dx}(x^2 + 1) = 2x$$

设  $u = x^2 + 1$，$du = 2x \, dx$，$x \, dx = \frac{1}{2} du$：
$$\int \frac{x}{(x^2 + 1)^2} \, dx = \frac{1}{2} \int \frac{du}{u^2} = \frac{1}{2} \cdot \left(-\frac{1}{u}\right) + C = -\frac{1}{2(x^2 + 1)} + C$$

**方法二：三角替换验证**
设  $x = \tan t$，$dx = \sec^2 t \, dt$，$x^2 + 1 = \sec^2 t$：
$$\int \frac{x}{(x^2 + 1)^2} \, dx = \int \frac{\tan t}{(\sec^2 t)^2} \sec^2 t \, dt = \int \frac{\tan t}{\sec^2 t} \, dt = \int \tan t \cos^2 t \, dt$$
$$= \int \sin t \cos t \, dt = \frac{1}{2} \int \sin 2t \, dt = -\frac{1}{4} \cos 2t + C$$

使用恒等式 $\cos 2t = \cos^2 t - \sin^2 t = \frac{1}{\sec^2 t} - \frac{\tan^2 t}{\sec^2 t} = \frac{1 - \tan^2 t}{\sec^2 t} = \frac{1 - x^2}{x^2 + 1}$：

$$-\frac{1}{4} \cos 2t = -\frac{1}{4} \cdot \frac{1 - x^2}{x^2 + 1} = -\frac{1 - x^2}{4(x^2 + 1)}$$

这与方法一的结果看似不同，但可以验证它们相差一个常数，在不定积分中是等价的。

实际上，使用 $\cos 2t = 1 - 2\sin^2 t$ 更直接：
$$\cos 2t = 1 - 2\sin^2 t = 1 - 2 \cdot \frac{\tan^2 t}{\sec^2 t} = 1 - \frac{2x^2}{x^2 + 1} = \frac{x^2 + 1 - 2x^2}{x^2 + 1} = \frac{1 - x^2}{x^2 + 1}$$

因此结果一致： $-\frac{1}{4} \cos 2t = -\frac{1 - x^2}{4(x^2 + 1)} = -\frac{1}{4(x^2 + 1)} + \frac{x^2}{4(x^2 + 1)}$

与第一种方法相比相差常数 $\frac{1}{4}$，这在不定积分中是允许的。

> **例题4.7**：计算 $\int \frac{1}{(x^2 + 4x + 5)^2} \, dx$

**解答**：

**第一步：配方**
$x^2 + 4x + 5 = (x + 2)^2 + 1$

**第二步：换元**
设  $u = x + 2$，$du = dx$：
$$\int \frac{1}{(x^2 + 4x + 5)^2} \, dx = \int \frac{1}{(u^2 + 1)^2} \, du$$

**第三步：三角替换**
设  $u = \tan t$，$du = \sec^2 t \, dt$，$u^2 + 1 = \sec^2 t$：
$$\int \frac{1}{(u^2 + 1)^2} \, du = \int \frac{\sec^2 t \, dt}{(\sec^2 t)^2} = \int \cos^2 t \, dt$$

**第四步：使用降幂公式**
$$\cos^2 t = \frac{1 + \cos 2t}{2}$$
$$\int \cos^2 t \, dt = \frac{1}{2} \int (1 + \cos 2t) \, dt = \frac{t}{2} + \frac{\sin 2t}{4} + C$$

**第五步：回代**
$\sin 2t = 2\sin t \cos t$，其中：
- $\tan t = u = x + 2$
- $\sin t = \frac{u}{\sqrt{u^2 + 1}} = \frac{x + 2}{\sqrt{(x + 2)^2 + 1}} = \frac{x + 2}{\sqrt{x^2 + 4x + 5}}$
- $\cos t = \frac{1}{\sqrt{u^2 + 1}} = \frac{1}{\sqrt{x^2 + 4x + 5}}$
- $t = \arctan u = \arctan(x + 2)$

因此：
$$\sin 2t = 2 \cdot \frac{x + 2}{\sqrt{x^2 + 4x + 5}} \cdot \frac{1}{\sqrt{x^2 + 4x + 5}} = \frac{2(x + 2)}{x^2 + 4x + 5}$$

**最终结果**：
$$\int \frac{1}{(x^2 + 4x + 5)^2} \, dx = \frac{\arctan(x + 2)}{2} + \frac{x + 2}{2(x^2 + 4x + 5)} + C$$

**验证结果**：对结果求导检验：
$$\frac{d}{dx}\left[\frac{\arctan(x + 2)}{2} + \frac{x + 2}{2(x^2 + 4x + 5)}\right]$$
$$= \frac{1}{2} \cdot \frac{1}{1+(x+2)^2} + \frac{1}{2} \cdot \frac{(x^2+4x+5) - (x+2)(2x+4)}{(x^2+4x+5)^2}$$
$$= \frac{1}{2(x^2+4x+5)} + \frac{1}{2} \cdot \frac{x^2+4x+5 - 2(x+2)^2}{(x^2+4x+5)^2}$$
$$= \frac{1}{2(x^2+4x+5)} + \frac{1}{2} \cdot \frac{x^2+4x+5 - 2(x^2+4x+4)}{(x^2+4x+5)^2}$$
$$= \frac{1}{2(x^2+4x+5)} + \frac{1}{2} \cdot \frac{-x^2-4x-3}{(x^2+4x+5)^2}$$
$$= \frac{1}{2} \cdot \frac{x^2+4x+5 - (x^2+4x+3)}{(x^2+4x+5)^2} = \frac{1}{2} \cdot \frac{2}{(x^2+4x+5)^2} = \frac{1}{(x^2+4x+5)^2}$$

这正是原被积函数 ✓

#### **部分分式分解方法总结**

**关键步骤回顾**：
1. **判断分式类型**：真分式直接分解，假分式先做长除法
2. **分解分母**：找出所有一次因式和不可约二次因式
3. **设置分解形式**：根据因式类型设置对应的部分分式
4. **求待定系数**：使用特殊值法或比较系数法
5. **验证结果**：通过求导验证或代入检验
 
---

## 5. 三角函数积分技巧

### 5.1 基本三角积分

**适用场景总述**：
- 被积函数主要由三角函数构成
- 三角函数的幂次积分： $\sin^m x$、 $\cos^n x$、 $\tan^k x$ 等
- 三角函数的有理组合：如 $\frac{\sin x}{1 + \cos x}$
- 三角函数与代数函数的乘积：如 $x \sin x$ （需结合分部积分）

#### ** $\sin^m x \cos^n x$ 型积分**

**适用场景**：被积函数为正弦和余弦的幂次乘积

**处理策略**：
1. ** $m$ 或 $n$ 之一为奇数** → 用换元法（保留奇数幂的一次项）
2. ** $m$ 和 $n$ 都为偶数** → 用降幂公式转化为低次
3. ** $m$ 和 $n$ 都为奇数** → 任选一个用换元法

> **例题5.1**：计算 $\int \sin^3 x \, dx$

**解答**：
$$\sin^3 x = \sin^2 x \cdot \sin x = (1 - \cos^2 x) \sin x$$
设  $u = \cos x$，$du = -\sin x \, dx$：
$$\int \sin^3 x \, dx = \int (1 - \cos^2 x) \sin x \, dx = -\int (1 - u^2) \, du$$
$$= -u + \frac{u^3}{3} + C = -\cos x + \frac{\cos^3 x}{3} + C$$

> **例题5.2**：计算 $\int \sin^2 x \cos^2 x \, dx$

**解答**：
$$\sin^2 x \cos^2 x = \frac{1}{4} \sin^2 2x = \frac{1}{4} \cdot \frac{1 - \cos 4x}{2} = \frac{1 - \cos 4x}{8}$$
$$\int \sin^2 x \cos^2 x \, dx = \frac{1}{8} \int (1 - \cos 4x) \, dx = \frac{x}{8} - \frac{\sin 4x}{32} + C$$

### 5.2 万能公式

**适用场景**：
- 被积函数是 $\sin x$ 和 $\cos x$ 的有理函数
- 形如 $\frac{a \sin x + b \cos x + c}{d \sin x + e \cos x + f}$ 的积分
- 其他方法都无法处理的三角函数有理式
- 被积函数在 $x = \pi$ 附近有奇点时需谨慎使用

**万能替换公式**：
$$t = \tan \frac{x}{2}$$
则：
$$\sin x = \frac{2t}{1 + t^2}, \quad \cos x = \frac{1 - t^2}{1 + t^2}, \quad dx = \frac{2 \, dt}{1 + t^2}$$

**使用注意事项**：
- 替换后积分区间可能改变
- 计算过程相对复杂，仅在其他方法失效时使用
- 对于特殊形式的三角有理式，优先考虑其他简便方法

> **例题5.3**：计算 $\int \frac{1}{1 + \sin x} \, dx$

**解答**：
设  $t = \tan \frac{x}{2}$：
$$\int \frac{1}{1 + \sin x} \, dx = \int \frac{1}{1 + \frac{2t}{1+t^2}} \cdot \frac{2 \, dt}{1 + t^2}$$
$$= \int \frac{2 \, dt}{1 + t^2 + 2t} = \int \frac{2 \, dt}{(1 + t)^2} = -\frac{2}{1 + t} + C$$
$$= -\frac{2}{1 + \tan \frac{x}{2}} + C$$

### 5.3 三角恒等式的应用

**常用恒等式**：
- $\sin^2 x = \frac{1 - \cos 2x}{2}$
- $\cos^2 x = \frac{1 + \cos 2x}{2}$
- $\sin x \cos x = \frac{\sin 2x}{2}$
- $\tan^2 x = \sec^2 x - 1$
- $\cot^2 x = \csc^2 x - 1$

> **重要参考**：更多三角恒等式请**参见**：[附录A-常用数学表格速查.md](./附录A-常用数学表格速查.md#5-三角函数恒等式表) - 第5节：三角函数恒等式表，包含：
> - 基本关系式：平方关系、商数关系、倒数关系
> - 和差角公式： $\sin(A \pm B)$、 $\cos(A \pm B)$、 $\tan(A \pm B)$
> - 和差化积公式：正弦和差、余弦和差
> - 积化和差公式：各种三角函数乘积的展开
> - 倍角公式：二倍角、三倍角公式
> - 半角公式：半角的各种表达形式
> - 万能公式：半角替换公式
> - 降幂公式： $\sin^2 x$、 $\cos^2 x$ 的降次表达
> - 辅助角公式： $a\sin x + b\cos x$ 的合成

### 5.4 特殊三角积分技巧

#### **华里士公式（Wallis公式）**

对于 $\int_0^{\pi/2} \sin^n x \, dx$ 和 $\int_0^{\pi/2} \cos^n x \, dx$：

$$I_n = \int_0^{\pi/2} \sin^n x \, dx = \int_0^{\pi/2} \cos^n x \, dx = \begin{cases}
\frac{n-1}{n} \cdot \frac{n-3}{n-2} \cdots \frac{1}{2} \cdot \frac{\pi}{2} & n \text{为偶数} \\
\frac{n-1}{n} \cdot \frac{n-3}{n-2} \cdots \frac{2}{3} \cdot 1 & n \text{为奇数}
\end{cases}$$

> **例题5.4**：计算 $\int_0^{\pi/2} \sin^4 x \, dx$

**解答**：
使用华里士公式， $n = 4$ （偶数）：
$$\int_0^{\pi/2} \sin^4 x \, dx = \frac{3}{4} \cdot \frac{1}{2} \cdot \frac{\pi}{2} = \frac{3\pi}{16}$$

#### **递推积分公式**

> **例题5.5**：建立 $I_n = \int \sin^n x \, dx$ 的递推关系

**解答**：
$$I_n = \int \sin^n x \, dx = \int \sin^{n-1} x \cdot \sin x \, dx$$
使用分部积分， $u = \sin^{n-1} x$，$dv = \sin x \, dx$：
$$I_n = -\sin^{n-1} x \cos x + (n-1) \int \sin^{n-2} x \cos^2 x \, dx$$
$$= -\sin^{n-1} x \cos x + (n-1) \int \sin^{n-2} x (1 - \sin^2 x) \, dx$$
$$= -\sin^{n-1} x \cos x + (n-1)I_{n-2} - (n-1)I_n$$

整理得：
$$nI_n = -\sin^{n-1} x \cos x + (n-1)I_{n-2}$$
$$I_n = -\frac{\sin^{n-1} x \cos x}{n} + \frac{n-1}{n}I_{n-2}$$

### 5.5 常用积分表补充

**常用积分公式速查**：

| 函数类型 | 积分公式 | 备注 |
|:---------|:---------|:-----|
| $\int \frac{1}{\sqrt{a^2-x^2}} \, dx$ | $\arcsin \frac{x}{a} + C$ | $\|x\| < a$ |
| $\int \frac{1}{a^2+x^2} \, dx$ | $\frac{1}{a}\arctan \frac{x}{a} + C$ | $a \neq 0$ |
| $\int \frac{1}{\sqrt{x^2 \pm a^2}} \, dx$ | $\ln\|x + \sqrt{x^2 \pm a^2}\| + C$ | |
| $\int \sec x \, dx$ | $\ln\|\sec x + \tan x\| + C$ | |
| $\int \csc x \, dx$ | $-\ln\|\csc x + \cot x\| + C$ | |
| $\int \tan x \, dx$ | $-\ln\|\cos x\| + C$ | |
| $\int \cot x \, dx$ | $\ln\|\sin x\| + C$ | |
| $\int \sec^2 x \, dx$ | $\tan x + C$ | |
| $\int \csc^2 x \, dx$ | $-\cot x + C$ | |
| $\int \sec x \tan x \, dx$ | $\sec x + C$ | |
| $\int \csc x \cot x \, dx$ | $-\csc x + C$ | |

**计算技巧提醒**：
1. **熟记基本积分表**：掌握常用函数的原函数
2. **掌握恒等变形**：三角恒等式、代数恒等式的灵活运用
3. **合理选择方法**：根据函数特点选择最优方法
4. **规范计算步骤**：减少计算错误，提高准确性
5. **验证结果**：通过求导验证积分结果的正确性

---

## 6. 特殊函数积分方法

### 6.1 含根式函数的积分

**适用场景**：
- 被积函数含有各种根式表达式
- 根式与代数函数的组合
- 多重根式的处理
- 分母含根式的有理化

#### ** $\sqrt{ax + b}$ 类型**

**方法**：直接换元 $t = \sqrt{ax + b}$
**适用场景**：被积函数主要含有一次根式，换元后可化为有理函数

> **例题6.1**：计算 $\int x \sqrt{2x + 1} \, dx$

**解答**：
设  $t = \sqrt{2x + 1}$，则 $t^2 = 2x + 1$，$x = \frac{t^2 - 1}{2}$，$dx = t \, dt$
$$\int x \sqrt{2x + 1} \, dx = \int \frac{t^2 - 1}{2} \cdot t \cdot t \, dt = \frac{1}{2} \int (t^4 - t^2) \, dt$$
$$= \frac{1}{2}\left(\frac{t^5}{5} - \frac{t^3}{3}\right) + C = \frac{t^3}{6}(3t^2 - 5) + C$$
$$= \frac{(2x + 1)^{3/2}}{6}[3(2x + 1) - 5] + C = \frac{(2x + 1)^{3/2}(6x - 2)}{6} + C$$

### 6.2 含绝对值函数的积分

**适用场景**：
- 被积函数含有 $|f(x)|$ 形式的绝对值
- 分段函数积分
- 需要讨论函数符号的积分

**方法**：分区间讨论，去掉绝对值符号
**处理步骤**：
1. 找出使 $f(x) = 0$ 的分界点
2. 在各区间内确定 $f(x)$ 的符号
3. 分别在各区间内去掉绝对值符号
4. 分段积分并求和

> **例题6.2**：计算 $\int |x - 1| \, dx$ 在区间 $[0, 3]$ 上的积分

**解答**：
当 $x \geq 1$ 时， $|x - 1| = x - 1$
当 $x < 1$ 时， $|x - 1| = -(x - 1) = 1 - x$

$$\int_0^3 |x - 1| \, dx = \int_0^1 (1 - x) \, dx + \int_1^3 (x - 1) \, dx$$

### 6.3 分段函数的积分

**适用场景**：
- 被积函数在不同区间有不同的表达式
- 实际问题中的分段定义函数
- 周期函数的积分

**方法**：按分段点分别计算，注意连续性
**处理原则**：
1. 明确各段的定义域和表达式
2. 在分段点处检查函数的连续性
3. 分别计算各段积分
4. 注意积分常数的连续性条件

### 6.4 对称性积分

**适用场景**：
- 利用积分区域的对称性简化计算
- 奇偶函数在对称区间上的积分
- 周期函数的积分性质
- 含参数的定积分计算

**常用对称性质**：
1. **奇偶性**：
   - $\int_{-a}^a f(x) \, dx = 2\int_0^a f(x) \, dx$ （ $f$ 为偶函数）
   - $\int_{-a}^a f(x) \, dx = 0$ （ $f$ 为奇函数）

2. **周期性**：
   - $\int_a^{a+T} f(x) \, dx = \int_0^T f(x) \, dx$ （ $f$ 的周期为 $T$）

3. **替换对称性**：
   - $\int_0^a f(x) \, dx = \int_0^a f(a-x) \, dx$

> **例题6.3**：计算 $\int_0^{\pi} x \sin x \, dx$

**解答**：
设  $I = \int_0^{\pi} x \sin x \, dx$，令 $t = \pi - x$：
$$I = \int_0^{\pi} (\pi - t) \sin(\pi - t) \, dt = \int_0^{\pi} (\pi - t) \sin t \, dt$$
$$= \pi \int_0^{\pi} \sin t \, dt - \int_0^{\pi} t \sin t \, dt = \pi \cdot 2 - I$$

因此： $2I = 2\pi$，$I = \pi$

### 6.5 含参积分法

**适用场景**：
- 通过引入参数将复杂积分转化为简单积分
- 利用参数微分或积分的性质
- 某些无法直接计算的积分

**基本方法**：通过参数化被积函数，利用参数的微分或积分性质求解。

> **例题6.4**：计算 $\int_0^1 \frac{x^a - x^b}{\ln x} \, dx$ （ $a, b > 0$）

**解答**：
设  $I(t) = \int_0^1 x^t \, dx = \frac{1}{t+1}$
则 $I'(t) = \int_0^1 x^t \ln x \, dx = -\frac{1}{(t+1)^2}$

注意到：
$$\int_0^1 \frac{x^a - x^b}{\ln x} \, dx = \int_0^1 \left(\int_b^a x^t \, dt\right) \, dx = \int_b^a \left(\int_0^1 x^t \, dx\right) dt$$
$$= \int_b^a \frac{1}{t+1} \, dt = \ln(a+1) - \ln(b+1) = \ln\frac{a+1}{b+1}$$

---

## 7. 综合应用与练习

### 7.1 换元积分综合应用

> **例题7.1**：计算 $\int \frac{\sqrt{x}}{\sqrt{x} + 1} \, dx$

**解题思路**：根式换元

**详细解答**：
设  $t = \sqrt{x}$，则 $x = t^2$，$dx = 2t \, dt$
$$\int \frac{\sqrt{x}}{\sqrt{x} + 1} \, dx = \int \frac{t}{t + 1} \cdot 2t \, dt = 2 \int \frac{t^2}{t + 1} \, dt$$

进行多项式长除法： $\frac{t^2}{t + 1} = t - 1 + \frac{1}{t + 1}$
$$2 \int \frac{t^2}{t + 1} \, dt = 2 \int \left(t - 1 + \frac{1}{t + 1}\right) dt$$
$$= 2\left(\frac{t^2}{2} - t + \ln|t + 1|\right) + C = t^2 - 2t + 2\ln|t + 1| + C$$
$$= x - 2\sqrt{x} + 2\ln(\sqrt{x} + 1) + C$$

### 7.2 分部积分综合应用

> **例题7.2**：计算 $\int x^2 \ln x \, dx$

**解题思路**：对数函数用分部积分

**详细解答**：
选择： $u = \ln x$，$dv = x^2 \, dx$
则： $du = \frac{1}{x} dx$，$v = \frac{x^3}{3}$
$$\int x^2 \ln x \, dx = \frac{x^3}{3} \ln x - \int \frac{x^3}{3} \cdot \frac{1}{x} \, dx$$
$$= \frac{x^3 \ln x}{3} - \frac{1}{3} \int x^2 \, dx = \frac{x^3 \ln x}{3} - \frac{x^3}{9} + C$$
$$= \frac{x^3}{9}(3 \ln x - 1) + C$$

### 7.3 综合方法应用

> **例题7.3**：计算 $\int e^{2x} \sin 3x \, dx$

**解题思路**：循环分部积分

**详细解答**：
设  $I = \int e^{2x} \sin 3x \, dx$

第一次分部： $u = \sin 3x$，$dv = e^{2x} \, dx$
$$I = \frac{1}{2} e^{2x} \sin 3x - \int \frac{1}{2} e^{2x} \cdot 3 \cos 3x \, dx$$
$$= \frac{e^{2x} \sin 3x}{2} - \frac{3}{2} \int e^{2x} \cos 3x \, dx$$

第二次分部：对 $\int e^{2x} \cos 3x \, dx$，$u = \cos 3x$，$dv = e^{2x} \, dx$
$$\int e^{2x} \cos 3x \, dx = \frac{e^{2x} \cos 3x}{2} + \frac{3}{2} \int e^{2x} \sin 3x \, dx$$

代入得：
$$I = \frac{e^{2x} \sin 3x}{2} - \frac{3}{2}\left(\frac{e^{2x} \cos 3x}{2} + \frac{3}{2} I\right)$$
$$I = \frac{e^{2x} \sin 3x}{2} - \frac{3 e^{2x} \cos 3x}{4} - \frac{9I}{4}$$
$$I + \frac{9I}{4} = \frac{e^{2x}(2 \sin 3x - 3 \cos 3x)}{4}$$
$$\frac{13I}{4} = \frac{e^{2x}(2 \sin 3x - 3 \cos 3x)}{4}$$
$$I = \frac{e^{2x}(2 \sin 3x - 3 \cos 3x)}{13} + C$$

---

### 7.4 综合练习
 
#### 7.4.1 基础练习解答 
 

**题目1**： $\int 2x \cos(x^2) \, dx$

**解答**：
这是典型的凑微分法应用。
设  $u = x^2$，则 $du = 2x \, dx$
$$\int 2x \cos(x^2) \, dx = \int \cos u \, du = \sin u + C = \sin(x^2) + C$$

**验证**： $\frac{d}{dx}[\sin(x^2)] = \cos(x^2) \cdot 2x = 2x\cos(x^2)$ ✓

**题目2**： $\int \frac{x}{x^2 + 1} \, dx$

**解答**：
这也是凑微分法的应用。
设  $u = x^2 + 1$，则 $du = 2x \, dx$，$x \, dx = \frac{1}{2} du$
$$\int \frac{x}{x^2 + 1} \, dx = \frac{1}{2} \int \frac{du}{u} = \frac{1}{2} \ln|u| + C = \frac{1}{2} \ln(x^2 + 1) + C$$

**注意**：由于 $x^2 + 1 > 0$，可以去掉绝对值符号。

**题目3**： $\int x e^{2x} \, dx$

**解答**：
这是分部积分法的典型应用。按ILATE原则：
选择： $u = x$ （代数函数）， $dv = e^{2x} \, dx$ （指数函数）
则： $du = dx$，$v = \frac{1}{2}e^{2x}$

$$\int x e^{2x} \, dx = x \cdot \frac{1}{2}e^{2x} - \int \frac{1}{2}e^{2x} \, dx$$
$$= \frac{x e^{2x}}{2} - \frac{1}{2} \cdot \frac{1}{2} e^{2x} + C = \frac{x e^{2x}}{2} - \frac{e^{2x}}{4} + C$$
$$= \frac{e^{2x}}{4}(2x - 1) + C$$

**题目4**： $\int \frac{x^2}{x - 1} \, dx$

**解答**：
这是假分式，需要先进行多项式长除法。
$$\frac{x^2}{x - 1} = x + 1 + \frac{1}{x - 1}$$

**长除法过程**：
$$x^2 = (x - 1)(x + 1) + 1$$
因此：
$$\int \frac{x^2}{x - 1} \, dx = \int \left(x + 1 + \frac{1}{x - 1}\right) dx$$
$$= \frac{x^2}{2} + x + \ln|x - 1| + C$$
 
> **练习7.2**：计算下列不定积分

**题目1**： $\int \sqrt{x^2 + 1} \, dx$

**解答**：
使用三角替换： $x = \tan t$，$dx = \sec^2 t \, dt$，$\sqrt{x^2 + 1} = \sec t$

$$\int \sqrt{x^2 + 1} \, dx = \int \sec t \cdot \sec^2 t \, dt = \int \sec^3 t \, dt$$

对于 $\int \sec^3 t \, dt$，使用分部积分：
设  $u = \sec t$，$dv = \sec^2 t \, dt$
则 $du = \sec t \tan t \, dt$，$v = \tan t$

$$\int \sec^3 t \, dt = \sec t \tan t - \int \tan^2 t \sec t \, dt$$
$$= \sec t \tan t - \int (\sec^2 t - 1) \sec t \, dt$$
$$= \sec t \tan t - \int \sec^3 t \, dt + \int \sec t \, dt$$

设  $I = \int \sec^3 t \, dt$，则：
$$I = \sec t \tan t - I + \ln|\sec t + \tan t|$$
$$2I = \sec t \tan t + \ln|\sec t + \tan t|$$
$$I = \frac{1}{2}[\sec t \tan t + \ln|\sec t + \tan t|] + C$$

回代 $x = \tan t$，$\sec t = \sqrt{x^2 + 1}$：
$$\int \sqrt{x^2 + 1} \, dx = \frac{1}{2}[x\sqrt{x^2 + 1} + \ln|x + \sqrt{x^2 + 1}|] + C$$

**题目2**： $\int \frac{1}{x^2 + 2x + 2} \, dx$

**解答**：
首先配方： $x^2 + 2x + 2 = (x + 1)^2 + 1$

设  $u = x + 1$，$du = dx$：
$$\int \frac{1}{x^2 + 2x + 2} \, dx = \int \frac{1}{u^2 + 1} \, du = \arctan u + C = \arctan(x + 1) + C$$

**题目3**： $\int \sin^3 x \cos^2 x \, dx$

**解答**：
由于 $\sin x$ 的幂次为奇数，使用换元法：
$$\sin^3 x = \sin^2 x \cdot \sin x = (1 - \cos^2 x) \sin x$$

设  $u = \cos x$，$du = -\sin x \, dx$：
$$\int \sin^3 x \cos^2 x \, dx = \int (1 - \cos^2 x) \cos^2 x \sin x \, dx$$
$$= -\int (1 - u^2) u^2 \, du = -\int (u^2 - u^4) \, du$$
$$= -\left(\frac{u^3}{3} - \frac{u^5}{5}\right) + C = -\frac{\cos^3 x}{3} + \frac{\cos^5 x}{5} + C$$

**题目4**： $\int x^2 \ln x \, dx$

**解答**：
使用分部积分法，按ILATE原则：
选择： $u = \ln x$ （对数函数）， $dv = x^2 \, dx$ （代数函数）
则： $du = \frac{1}{x} dx$，$v = \frac{x^3}{3}$

$$\int x^2 \ln x \, dx = \frac{x^3}{3} \ln x - \int \frac{x^3}{3} \cdot \frac{1}{x} \, dx$$
$$= \frac{x^3 \ln x}{3} - \frac{1}{3} \int x^2 \, dx = \frac{x^3 \ln x}{3} - \frac{x^3}{9} + C$$
$$= \frac{x^3}{9}(3 \ln x - 1) + C$$
 
> **练习7.3**：计算下列不定积分

**题目1**： $\int \frac{x^3 + 1}{x^2 + x + 1} \, dx$

**解答**：
首先注意到： $x^3 + 1 = (x + 1)(x^2 - x + 1)$

进行多项式长除法：
$$\frac{x^3 + 1}{x^2 + x + 1} = \frac{(x + 1)(x^2 - x + 1)}{x^2 + x + 1}$$

让我们直接做长除法：
$$x^3 + 1 = (x^2 + x + 1) \cdot x + (-x^2 + 1)$$
$$-x^2 + 1 = (x^2 + x + 1) \cdot (-1) + (x + 2)$$

因此：
$$\frac{x^3 + 1}{x^2 + x + 1} = x - 1 + \frac{x + 2}{x^2 + x + 1}$$

对于 $\frac{x + 2}{x^2 + x + 1}$，配方： $x^2 + x + 1 = (x + \frac{1}{2})^2 + \frac{3}{4}$

设  $x + \frac{1}{2} = \frac{\sqrt{3}}{2} \tan t$，经过计算得：

$$\int \frac{x^3 + 1}{x^2 + x + 1} \, dx = \frac{x^2}{2} - x + \frac{1}{2}\ln(x^2 + x + 1) + \frac{\sqrt{3}}{3}\arctan\frac{2x + 1}{\sqrt{3}} + C$$

**题目2**： $\int e^x \sin x \cos x \, dx$

**解答**：
首先利用三角恒等式： $\sin x \cos x = \frac{1}{2}\sin 2x$

$$\int e^x \sin x \cos x \, dx = \frac{1}{2} \int e^x \sin 2x \, dx$$

对 $\int e^x \sin 2x \, dx$ 使用循环分部积分：
设  $I = \int e^x \sin 2x \, dx$

第一次分部： $u = \sin 2x$，$dv = e^x dx$
$$I = e^x \sin 2x - \int e^x \cdot 2\cos 2x \, dx = e^x \sin 2x - 2\int e^x \cos 2x \, dx$$

第二次分部：对 $\int e^x \cos 2x \, dx$，$u = \cos 2x$，$dv = e^x dx$
$$\int e^x \cos 2x \, dx = e^x \cos 2x - \int e^x \cdot (-2\sin 2x) \, dx = e^x \cos 2x + 2I$$

代入得：
$$I = e^x \sin 2x - 2(e^x \cos 2x + 2I) = e^x \sin 2x - 2e^x \cos 2x - 4I$$
$$5I = e^x(\sin 2x - 2\cos 2x)$$
$$I = \frac{e^x(\sin 2x - 2\cos 2x)}{5}$$

因此：
$$\int e^x \sin x \cos x \, dx = \frac{1}{2} \cdot \frac{e^x(\sin 2x - 2\cos 2x)}{5} + C = \frac{e^x(\sin 2x - 2\cos 2x)}{10} + C$$

**题目3**： $\int \frac{\sqrt{x} - 1}{\sqrt{x} + 1} \, dx$

**解答**：
使用根式有理化技巧：
$$\frac{\sqrt{x} - 1}{\sqrt{x} + 1} = \frac{(\sqrt{x} - 1)(\sqrt{x} - 1)}{(\sqrt{x} + 1)(\sqrt{x} - 1)} = \frac{(\sqrt{x} - 1)^2}{x - 1} = \frac{x - 2\sqrt{x} + 1}{x - 1}$$

或者更直接地，设  $t = \sqrt{x}$，则 $x = t^2$，$dx = 2t \, dt$：
$$\int \frac{\sqrt{x} - 1}{\sqrt{x} + 1} \, dx = \int \frac{t - 1}{t + 1} \cdot 2t \, dt = 2\int \frac{t(t - 1)}{t + 1} \, dt$$
$$= 2\int \frac{t^2 - t}{t + 1} \, dt$$

进行长除法： $\frac{t^2 - t}{t + 1} = t - 2 + \frac{2}{t + 1}$

$$= 2\int \left(t - 2 + \frac{2}{t + 1}\right) dt$$
$$= 2\left(\frac{t^2}{2} - 2t + 2\ln|t + 1|\right) + C$$
$$= t^2 - 4t + 4\ln|t + 1| + C = x - 4\sqrt{x} + 4\ln(\sqrt{x} + 1) + C$$

**题目4**： $\int \frac{1}{(x^2 + 1)^2} \, dx$

**解答**：
使用三角替换： $x = \tan t$，$dx = \sec^2 t \, dt$，$x^2 + 1 = \sec^2 t$

$$\int \frac{1}{(x^2 + 1)^2} \, dx = \int \frac{\sec^2 t \, dt}{(\sec^2 t)^2} = \int \cos^2 t \, dt$$

使用降幂公式： $\cos^2 t = \frac{1 + \cos 2t}{2}$
$$\int \cos^2 t \, dt = \frac{1}{2} \int (1 + \cos 2t) \, dt = \frac{t}{2} + \frac{\sin 2t}{4} + C$$

由于 $\sin 2t = 2\sin t \cos t = 2 \cdot \frac{x}{\sqrt{x^2 + 1}} \cdot \frac{1}{\sqrt{x^2 + 1}} = \frac{2x}{x^2 + 1}$

且 $t = \arctan x$，所以：
$$\int \frac{1}{(x^2 + 1)^2} \, dx = \frac{\arctan x}{2} + \frac{x}{2(x^2 + 1)} + C$$
 
> **练习7.4**：计算下列不定积分

**题目1**： $\int \frac{x^4}{(x^2 + 1)^3} \, dx$

**解答**：
使用三角替换： $x = \tan t$，$dx = \sec^2 t \, dt$

$$\int \frac{x^4}{(x^2 + 1)^3} \, dx = \int \frac{\tan^4 t}{\sec^6 t} \sec^2 t \, dt = \int \frac{\tan^4 t}{\sec^4 t} \, dt = \int \tan^4 t \cos^4 t \, dt$$
$$= \int \sin^4 t \, dt$$

使用递推公式或降幂：
$$\sin^4 t = (\sin^2 t)^2 = \left(\frac{1 - \cos 2t}{2}\right)^2 = \frac{1 - 2\cos 2t + \cos^2 2t}{4}$$
$$= \frac{1 - 2\cos 2t + \frac{1 + \cos 4t}{2}}{4} = \frac{3 - 4\cos 2t + \cos 4t}{8}$$

$$\int \sin^4 t \, dt = \frac{1}{8}(3t - 2\sin 2t + \frac{\sin 4t}{4}) + C$$

回代 $t = \arctan x$，$\sin 2t = \frac{2x}{x^2+1}$，$\sin 4t = \frac{4x(1-x^2)}{(x^2+1)^2}$：

$$\int \sin^4 t \, dt = \frac{1}{8}(3t - 2\sin 2t + \frac{\sin 4t}{4}) + C$$
$$= \frac{3\arctan x}{8} - \frac{x}{2(x^2+1)} + \frac{x(1-x^2)}{8(x^2+1)^2} + C$$

化简最后一项： $\frac{x(1-x^2)}{8(x^2+1)^2} = \frac{x}{8(x^2+1)^2} - \frac{x^3}{8(x^2+1)^2}$

**最终结果**：
$$\int \frac{x^4}{(x^2 + 1)^3} \, dx = \frac{3\arctan x}{8} - \frac{x}{2(x^2+1)} + \frac{x(1-x^2)}{8(x^2+1)^2} + C$$

**题目2**： $\int \frac{\ln(x + \sqrt{1 + x^2})}{x^2} \, dx$

**解答**：
这个积分涉及反双曲函数。注意到 $\ln(x + \sqrt{1 + x^2}) = \sinh^{-1} x$

使用分部积分： $u = \sinh^{-1} x$，$dv = \frac{1}{x^2} dx$
则 $du = \frac{1}{\sqrt{1 + x^2}} dx$，$v = -\frac{1}{x}$

$$\int \frac{\sinh^{-1} x}{x^2} \, dx = -\frac{\sinh^{-1} x}{x} + \int \frac{1}{x\sqrt{1 + x^2}} \, dx$$

对于后一个积分，使用替换 $u = \frac{1}{x}$：
最终结果较为复杂，涉及反双曲函数的组合。

**题目3**： $\int \sin(\ln x) \, dx$

**解答**：
设  $t = \ln x$，则 $x = e^t$，$dx = e^t dt$

$$\int \sin(\ln x) \, dx = \int \sin t \cdot e^t \, dt$$

这是循环分部积分的典型例子。设  $I = \int e^t \sin t \, dt$

第一次分部： $u = \sin t$，$dv = e^t dt$
$$I = e^t \sin t - \int e^t \cos t \, dt$$

第二次分部： $u = \cos t$，$dv = e^t dt$
$$\int e^t \cos t \, dt = e^t \cos t + \int e^t \sin t \, dt = e^t \cos t + I$$

代入得：
$$I = e^t \sin t - (e^t \cos t + I) = e^t(\sin t - \cos t) - I$$
$$2I = e^t(\sin t - \cos t)$$
$$I = \frac{e^t(\sin t - \cos t)}{2}$$

回代 $t = \ln x$，$e^t = x$：
$$\int \sin(\ln x) \, dx = \frac{x[\sin(\ln x) - \cos(\ln x)]}{2} + C$$

**题目4**： $\int \frac{1}{\sqrt{x} + \sqrt[3]{x}} \, dx$

**解答**：
设  $t = \sqrt[6]{x}$，则 $x = t^6$，$dx = 6t^5 dt$
$$\sqrt{x} = t^3, \quad \sqrt[3]{x} = t^2$$

$$\int \frac{1}{\sqrt{x} + \sqrt[3]{x}} \, dx = \int \frac{6t^5}{t^3 + t^2} \, dt = \int \frac{6t^5}{t^2(t + 1)} \, dt = 6\int \frac{t^3}{t + 1} \, dt$$

进行长除法： $\frac{t^3}{t + 1} = t^2 - t + 1 - \frac{1}{t + 1}$

$$= 6\int \left(t^2 - t + 1 - \frac{1}{t + 1}\right) dt$$
$$= 6\left(\frac{t^3}{3} - \frac{t^2}{2} + t - \ln|t + 1|\right) + C$$
$$= 2t^3 - 3t^2 + 6t - 6\ln|t + 1| + C$$

回代 $t = \sqrt[6]{x}$：
$$= 2\sqrt{x} - 3\sqrt[3]{x} + 6\sqrt[6]{x} - 6\ln(\sqrt[6]{x} + 1) + C$$
 
> **例题7.5**：**变上限积分求导**
> 
> 设  $f(x) = \int_1^{x^2} \frac{\ln t}{t} \, dt$，求 $f'(x)$

**解答**：
这是变上限积分函数求导的典型例题。使用链式法则：

若 $F(x) = \int_a^{g(x)} f(t) \, dt$，则 $F'(x) = f(g(x)) \cdot g'(x)$

在本题中： $g(x) = x^2$，$f(t) = \frac{\ln t}{t}$

因此：
$$f'(x) = \frac{\ln(x^2)}{x^2} \cdot \frac{d}{dx}(x^2) = \frac{2\ln x}{x^2} \cdot 2x = \frac{4\ln x}{x}$$

**验证**：我们也可以先计算原函数。
设  $u = \ln t$，$du = \frac{1}{t} dt$，则：
$$\int \frac{\ln t}{t} \, dt = \int u \, du = \frac{u^2}{2} + C = \frac{(\ln t)^2}{2} + C$$

因此：
$$f(x) = \left[\frac{(\ln t)^2}{2}\right]_1^{x^2} = \frac{(\ln x^2)^2}{2} - \frac{(\ln 1)^2}{2} = \frac{(2\ln x)^2}{2} = 2(\ln x)^2$$

求导： $f'(x) = 2 \cdot 2\ln x \cdot \frac{1}{x} = \frac{4\ln x}{x}$ ✓

> **例题7.6**：**分部积分高级应用**
> 
> 计算 $\int x^2 \arctan x \, dx$

**解答**：
这是分部积分的典型应用。按ILATE原则：
选择： $u = \arctan x$ （反三角函数）， $dv = x^2 dx$ （代数函数）
则： $du = \frac{1}{1+x^2} dx$，$v = \frac{x^3}{3}$

$$\int x^2 \arctan x \, dx = \frac{x^3}{3} \arctan x - \int \frac{x^3}{3} \cdot \frac{1}{1+x^2} \, dx$$
$$= \frac{x^3}{3} \arctan x - \frac{1}{3} \int \frac{x^3}{1+x^2} \, dx$$

对于 $\int \frac{x^3}{1+x^2} \, dx$，进行长除法：
$$\frac{x^3}{1+x^2} = x - \frac{x}{1+x^2}$$

因此：
$$\int \frac{x^3}{1+x^2} \, dx = \int x \, dx - \int \frac{x}{1+x^2} \, dx = \frac{x^2}{2} - \frac{1}{2}\ln(1+x^2)$$

最终结果：
$$\int x^2 \arctan x \, dx = \frac{x^3}{3} \arctan x - \frac{1}{3}\left(\frac{x^2}{2} - \frac{1}{2}\ln(1+x^2)\right) + C$$
$$= \frac{x^3}{3} \arctan x - \frac{x^2}{6} + \frac{\ln(1+x^2)}{6} + C$$

> **例题7.7**：**对称性积分**
> 
> 设  $\int_0^1 f(x) dx = A$，计算 $\int_0^1 x f(1-x) dx$

**解答**：
这是利用对称性质的典型例题。

设  $I = \int_0^1 x f(1-x) dx$

**关键技巧：构造对称积分**

考虑积分 $I$ 与其对称形式的关系。对积分 $I$ 作变量替换 $t = 1-x$，$dt = -dx$：

当 $x = 0$ 时， $t = 1$；当 $x = 1$ 时， $t = 0$

$$I = \int_0^1 x f(1-x) dx = \int_1^0 (1-t) f(t) (-dt) = \int_0^1 (1-t) f(t) dt$$

因此：
$$I = \int_0^1 (1-t) f(t) dt = \int_0^1 f(t) dt - \int_0^1 t f(t) dt = A - \int_0^1 t f(t) dt$$

**关键观察**：现在考虑 $\int_0^1 t f(t) dt$。

注意到，我们又可以对 $\int_0^1 t f(t) dt$ 作变量替换 $s = 1-t$：
$$\int_0^1 t f(t) dt = \int_0^1 (1-s) f(1-s) ds$$

而 $\int_0^1 (1-s) f(1-s) ds$ 正是我们刚才得到的 $I$ 的表达式！

所以： $\int_0^1 t f(t) dt = I$

代入前面的等式：
$$I = A - I$$
$$2I = A$$
$$I = \frac{A}{2}$$

**验证**：这个结果表明，对于任意可积函数 $f(x)$，都有
$$\int_0^1 x f(1-x) dx = \frac{1}{2} \int_0^1 f(x) dx$$

这是一个重要的积分对称性公式。
