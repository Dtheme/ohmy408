# 5.2 一阶微分方程求解方法
 
## 目录

1. [可分离变量的微分方程](#1-可分离变量的微分方程)
2. [齐次微分方程](#2-齐次微分方程)
3. [一阶线性微分方程](#3-一阶线性微分方程)
4. [伯努利方程](#4-伯努利方程)
5. [其他特殊类型的一阶方程](#5-其他特殊类型的一阶方程)
6. [综合技巧与典型题型](#6-综合技巧与典型题型)
7. [重要公式汇总](#7-重要公式汇总)

 
---

## 1. 可分离变量的微分方程

### 1.1 可分离变量方程的定义

> **定义1.1（可分离变量方程）**
> 
> 形如 $\frac{dy}{dx} = f(x)g(y)$ 的微分方程称为**可分离变量的微分方程**。

**标准形式**：
$$\frac{dy}{dx} = f(x)g(y)$$

或写成微分形式：
$$M(x)dx + N(y)dy = 0$$

其中 $M(x)$ 只含 $x$， $N(y)$ 只含 $y$ 。

### 1.2 求解方法

> **求解步骤**：
> 
> 1. **分离变量**：将方程改写为 $\frac{dy}{g(y)} = f(x)dx$
> 2. **两边积分**： $\int \frac{dy}{g(y)} = \int f(x)dx$
> 3. **求出通解**：计算积分并加上积分常数

**注意事项**：
- 分离变量时要注意 $g(y) \neq 0$ 的条件
- 如果 $g(y) = 0$ 有解，需要单独讨论这些解
- 积分常数的处理要规范

**详细解题流程**：

 **第一步：识别与变形**
 
 判断方程是否可以写成 $\frac{dy}{dx} = f(x) \cdot g(y)$ 的形式
 - 如果不是标准形式，需要先变形
 - 检查分母 $g(y)$ 是否可能为零

 **第二步：分离变量**
 
 将变量分离： $\frac{dy}{g(y)} = f(x)dx$
 - **关键技巧**：把所有含 $y$ 的项（包括 $dy$）移到左边
 - 把所有含 $x$ 的项（包括 $dx$）移到右边

 **第三步：两边积分**
 
 $\int \frac{dy}{g(y)} = \int f(x)dx + C$
 - **积分技巧**：左右两边的积分可能需要不同的积分方法
 - **常数处理**：只在一边写积分常数 $C$ 即可

 **第四步：解出 $y$**
 
 从积分结果中解出 $y = \phi(x, C)$
 - 有时需要使用指数、对数等运算
 - 注意解的定义域

 **第五步：检查遗漏解**
 
 检查使 $g(y) = 0$ 的 $y$ 值是否也是方程的解

> **例题1.1**：求解微分方程  $\frac{dy}{dx} = 2xy$

**解答**：
1. **分离变量**： $\frac{dy}{y} = 2x dx$ （这里假设  $y \neq 0$）

2. **两边积分**：
   $$\int \frac{dy}{y} = \int 2x dx$$
   $$\ln|y| = x^2 + C_1$$

3. **求通解**：
   $$|y| = e^{x^2 + C_1} = e^{C_1} \cdot e^{x^2}$$
   $$y = \pm e^{C_1} \cdot e^{x^2} = Ce^{x^2}$$
   
   其中 $C = \pm e^{C_1}$ 是任意非零常数。

4. **讨论 $y = 0$ 的情况**：
   当 $y = 0$ 时， $y' = 0$，代入原方程： $0 = 2x \cdot 0 = 0$，成立。
   
   因此 $y = 0$ 也是方程的解。

**通解**： $y = Ce^{x^2}$ （ $C$ 为任意常数）

> **例题1.2**：求解初值问题 $\begin{cases} \frac{dy}{dx} = \frac{x}{y} \\ y(1) = 2 \end{cases}$

**解答**：
1. **分离变量**： $y dy = x dx$

2. **两边积分**：
   $$\int y dy = \int x dx$$
   $$\frac{y^2}{2} = \frac{x^2}{2} + C$$

3. **利用初值条件**：
   $y(1) = 2$，即当 $x = 1$ 时 $y = 2$
   $$4 = 1 + 2C \Rightarrow C = \frac{3}{2}$$

4. **特解**： $y^2 = x^2 + 3$，即 $y = \pm\sqrt{x^2 + 3}$
   
   由于 $y(1) = 2 > 0$，取 $y = \sqrt{x^2 + 3}$

### 1.3 可化为分离变量的方程

#### （1）形如 $y' = f(ax + by + c)$ 的方程

> **求解方法**：令 $u = ax + by + c$，则 $\frac{du}{dx} = a + b\frac{dy}{dx}$

> **例题1.3**：求解 $\frac{dy}{dx} = (x + y + 1)^2$

**解答**：
设  $u = x + y + 1$，则：
$$\frac{du}{dx} = 1 + \frac{dy}{dx}$$
$$\frac{dy}{dx} = \frac{du}{dx} - 1$$

代入原方程：
$$\frac{du}{dx} - 1 = u^2$$
$$\frac{du}{dx} = u^2 + 1$$

分离变量：
$$\frac{du}{u^2 + 1} = dx$$

积分：
$$\int \frac{du}{u^2 + 1} = \int dx$$
$$\arctan u = x + C$$

回代后：
$$\arctan(x + y + 1) = x + C$$
两边取正切：
$$x + y + 1 = \tan(x + C)$$
$$y = \tan(x + C) - x - 1$$

#### （2）形如 $\frac{dy}{dx} = f\left(\frac{y}{x}\right)$ 的方程

这类方程实际上是齐次方程，将在下一节详细讨论。

### 1.4 可分离变量方程的常见变形

> **常见变形类型**：

1. **隐式形式**： $M(x)N(y)dx + P(x)Q(y)dy = 0$
   - 变形为： $\frac{M(x)}{P(x)}dx + \frac{Q(y)}{N(y)}dy = 0$

2. **带系数形式**： $a \frac{dy}{dx} = b f(x)g(y)$
   - 先整理系数： $\frac{dy}{dx} = \frac{b}{a} f(x)g(y)$

3. **反函数形式**： $\frac{dx}{dy} = f(y)g(x)$
   - 按 $x$ 关于 $y$ 的函数处理

> **例题1.4**：求解 $(1 + x^2)dy - xy dx = 0$

**解答**：
1. **重新整理**：
   $(1 + x^2)dy = xy dx$
   
   $$\frac{dy}{y} = \frac{x}{1 + x^2}dx$$

2. **积分**：
   $$\int \frac{dy}{y} = \int \frac{x}{1 + x^2}dx$$
   
   左边： $\ln|y|$
   
   右边：设 $u = 1 + x^2$，则 $du = 2x dx$
   $$\int \frac{x}{1 + x^2}dx = \frac{1}{2}\int \frac{du}{u} = \frac{1}{2}\ln|u| = \frac{1}{2}\ln(1 + x^2)$$

3. **通解**：
   $$\ln|y| = \frac{1}{2}\ln(1 + x^2) + C_1$$
   $$|y| = e^{C_1} \sqrt{1 + x^2}$$
   $$y = C\sqrt{1 + x^2}$$

### 1.5 一种解微分方程的技巧：对调x、y的方法

> 当方程求解困难时，考虑对调$x$和$y$的角色，或者形式是反函数形式

#### （1）基本原理

当方程 $\frac{dy}{dx} = f(x,y)$ 难以求解时，可以考虑反函数：
$$\frac{dx}{dy} = \frac{1}{\frac{dy}{dx}} = \frac{1}{f(x,y)} = g(x,y)$$

如果$g(x,y)$的形式更简单，就先求出$x = \phi(y,C)$，再通过反函数得到$y = \psi(x,C)$

#### （2）适用情况判断

> **何时考虑对调x、y**：
> - 当$\frac{dy}{dx}$形式复杂，但$\frac{dx}{dy}$形式简单时
> - 当方程中$y$出现在分母，但$x$不在分母时  
> - 当变换后可以化为已知类型（可分离变量、线性等）时

> **例题1.5**：求解 $\frac{dy}{dx} = \frac{x}{y^2 + 1}$ （对调前后对比）

**解答方法一（直接求解）**：
原方程可分离变量：
$$(y^2 + 1)dy = x dx$$
$$\int (y^2 + 1)dy = \int x dx$$
$$\frac{y^3}{3} + y = \frac{x^2}{2} + C$$

**解答方法二（对调x、y）**：
$$\frac{dx}{dy} = \frac{y^2 + 1}{x}$$

这也是可分离变量的：
$$x dx = (y^2 + 1)dy$$

得到相同结果。这个例子中两种方法难度相当。

> **例题1.6**：求解 $\frac{dy}{dx} = \frac{y^2}{x^2 + xy + y^2}$ （对调x、y的优势体现）

**解答**：
**方法一（直接求解）**：尝试齐次方程方法，但计算复杂。

**方法二（对调x、y）**：
$$\frac{dx}{dy} = \frac{x^2 + xy + y^2}{y^2} = \frac{x^2}{y^2} + \frac{x}{y} + 1$$

令$v = \frac{x}{y}$，则$x = vy$，$\frac{dx}{dy} = v + y\frac{dv}{dy}$

代入：
$$v + y\frac{dv}{dy} = v^2 + v + 1$$
$$y\frac{dv}{dy} = v^2 + 1$$
$$\frac{dv}{v^2 + 1} = \frac{dy}{y}$$

积分：
$$\arctan v = \ln|y| + C$$
$$\arctan \frac{x}{y} = \ln|y| + C$$

**对比**：对调后求解更简洁！

#### （3）常见的x、y对调情形

> **情形1**：分母含有$y$的高次项
> 
> 例如：$\frac{dy}{dx} = \frac{f(x,y)}{y^n}$ 型，对调后变为$\frac{dx}{dy} = \frac{y^n}{f(x,y)}$

> **情形2**：$y$在根号内  
> 
> 例如：$\frac{dy}{dx} = \frac{g(x,y)}{\sqrt{y}}$ 型

> **情形3**：含参数的方程
> 
> 有时对调可以更容易分离参数

> **例题1.7**：求解 $\frac{dy}{dx} = \frac{x + y}{y}$ （混合技巧）

**解答**：
**方法一（直接）**：
$$\frac{dy}{dx} = \frac{x}{y} + 1$$

这不是标准类型，求解较复杂。

**方法二（对调x、y）**：
$$\frac{dx}{dy} = \frac{y}{x + y}$$

令$u = x + y$，则$x = u - y$，$\frac{dx}{dy} = \frac{du}{dy} - 1$

代入：
$$\frac{du}{dy} - 1 = \frac{y}{u}$$
$$\frac{du}{dy} = \frac{y}{u} + 1 = \frac{y + u}{u}$$
$$\frac{u du}{y + u} = dy$$

这仍然复杂。让我们回到原方程用另一种方法：

**方法三（重新分析原方程）**：
$$\frac{dy}{dx} = \frac{x + y}{y} = \frac{x}{y} + 1$$

移项：
$$\frac{dy}{dx} - 1 = \frac{x}{y}$$
$$y\left(\frac{dy}{dx} - 1\right) = x$$
$$y \frac{dy}{dx} - y = x$$

两边对$x$积分（注意$y$是$x$的函数）：
$$\int y dy - \int y dx = \int x dx$$

这需要更仔细的处理。实际上，我们可以重写为：
$$y dy - y dx = x dx$$
$$y dy = (x + y)dx$$
$$\frac{y dy}{x + y} = dx$$

这提示我们用另一种替换。

**最佳方法（混合技巧）**：
设$v = x + y$，则$y = v - x$，$\frac{dy}{dx} = \frac{dv}{dx} - 1$

原方程变为：
$$\frac{dv}{dx} - 1 = \frac{v}{v - x}$$
$$\frac{dv}{dx} = \frac{v}{v - x} + 1 = \frac{v + v - x}{v - x} = \frac{2v - x}{v - x}$$

这仍较复杂，说明此题确实需要特殊技巧。

#### （4）x、y对调技巧的判断原则

> **快速判断是否应该对调x、y**：
> 
> 1. **复杂度对比**：比较$\frac{dy}{dx}$和$\frac{dx}{dy}$的复杂程度
> 2. **分母观察**：如果$y$在分母且次数较高，考虑对调
> 3. **类型识别**：对调后是否能化为熟悉的方程类型
> 4. **变量分离**：对调后是否更容易分离变量

> **例题1.8**：求解 $\frac{dy}{dx} = \frac{1 + y^2}{xy}$ （最适合对调的例子）

**解答**：
**直接求解**：原方程不易处理。

**对调x、y**：
$$\frac{dx}{dy} = \frac{xy}{1 + y^2}$$

分离变量：
$$\frac{dx}{x} = \frac{y dy}{1 + y^2}$$

积分：
$$\ln|x| = \frac{1}{2}\ln(1 + y^2) + C$$
$$\ln|x| = \ln\sqrt{1 + y^2} + C$$
$$x = K\sqrt{1 + y^2}$$

其中$K = \pm e^C$。



---

## 2. 齐次微分方程

### 2.1 齐次方程的定义

> **定义2.1（齐次微分方程）**
> 
> 形如 $\frac{dy}{dx} = f\left(\frac{y}{x}\right)$ 的微分方程称为**齐次微分方程**。

**等价形式**：
- $\frac{dy}{dx} = f\left(\frac{y}{x}\right)$
- $M(x,y)dx + N(x,y)dy = 0$，其中 $M(x,y)$ 和 $N(x,y)$ 都是 $x,y$ 的齐次函数且次数相同

> **齐次函数的定义**：如果 $f(tx,ty) = t^n f(x,y)$，则称 $f(x,y)$ 为 $n$ 次齐次函数。

### 2.2 齐次方程的求解方法

> **求解步骤**：
> 
> 1. **变量替换**：令 $v = \frac{y}{x}$，则 $y = vx$， $\frac{dy}{dx} = v + x\frac{dv}{dx}$
> 2. **代入原方程**： $v + x\frac{dv}{dx} = f(v)$
> 3. **分离变量**： $x\frac{dv}{dx} = f(v) - v$，即 $\frac{dv}{f(v) - v} = \frac{dx}{x}$
> 4. **积分求解**： $\int \frac{dv}{f(v) - v} = \int \frac{dx}{x}$
> 5. **回代变量**：将 $v = \frac{y}{x}$ 代回得到 $y$ 与 $x$ 的关系

**详细解题思路**：

> **为什么用 $v = \frac{y}{x}$ 替换？**
> 
> - 齐次方程的特点是右端只依赖于 $\frac{y}{x}$ 的值
> - 引入比值变量 $v$ 后，"二元问题"变成"一元问题"
> - 这就像用"相对坐标"替代"绝对坐标"

> **替换后的导数处理**：
> 
> 如果 $y = vx$，那么：
> $$\frac{dy}{dx} = \frac{d(vx)}{dx} = v \frac{dx}{dx} + x \frac{dv}{dx} = v + x\frac{dv}{dx}$$
> 
> 这是**乘积求导法则**的应用！

> **分离变量的技巧**：
> 
> 从 $v + x\frac{dv}{dx} = f(v)$ 得到：
> $$x\frac{dv}{dx} = f(v) - v$$
> 
> 当 $f(v) - v \neq 0$ 时，可以分离变量：
> $$\frac{dv}{f(v) - v} = \frac{dx}{x}$$

`注意`：如果 $f(v) - v = 0$，即 $f(v) = v$，需要单独讨论！

> **例题2.1**：求解微分方程  $\frac{dy}{dx} = \frac{y}{x} + \frac{x}{y}$

**解答**：
1. **验证齐次性**：
   $$\frac{dy}{dx} = \frac{y}{x} + \frac{x}{y} = \frac{y^2 + x^2}{xy}$$
   
   右端可写成 $\frac{y}{x}$ 的函数： $f\left(\frac{y}{x}\right) = \frac{y}{x} + \frac{x}{y} = \frac{y}{x} + \frac{1}{\frac{y}{x}}$

2. **变量替换**：
   令 $v = \frac{y}{x}$，则 $y = vx$， $\frac{dy}{dx} = v + x\frac{dv}{dx}$

3. **代入方程**：
   $$v + x\frac{dv}{dx} = v + \frac{1}{v}$$
   $$x\frac{dv}{dx} = \frac{1}{v}$$

4. **分离变量**：
   $$v dv = \frac{dx}{x}$$

5. **积分**：
   $$\int v dv = \int \frac{dx}{x}$$
   $$\frac{v^2}{2} = \ln|x| + C$$

6. **回代**：
   $$\frac{1}{2}\left(\frac{y}{x}\right)^2 = \ln|x| + C$$
   $$\frac{y^2}{2x^2} = \ln|x| + C$$
   $$y^2 = 2x^2(\ln|x| + C)$$

### 2.3 可化为齐次的方程

#### （1）形如 $\frac{dy}{dx} = f\left(\frac{a_1x + b_1y + c_1}{a_2x + b_2y + c_2}\right)$ 的方程

**情况一**： $c_1 = c_2 = 0$
此时方程已经是齐次的。

**情况二**： $c_1, c_2$ 不全为零，且 $\frac{a_1}{a_2} \neq \frac{b_1}{b_2}$

> **求解方法**：
> 
> 1. 解方程组 $\begin{cases} a_1x + b_1y + c_1 = 0 \\ a_2x + b_2y + c_2 = 0 \end{cases}$，得解 $(h, k)$
> 2. 令 $u = x - h$， $v = y - k$，代入原方程
> 3. 得到关于 $u, v$ 的齐次方程，按齐次方程方法求解

> **例题2.2**：求解 $\frac{dy}{dx} = \frac{x + y - 1}{x - y + 1}$

**解答**：
1. **求平移量**：
   解方程组 $\begin{cases} x + y - 1 = 0 \\ x - y + 1 = 0 \end{cases}$
   
   得 $x = 0, y = 1$，即 $(h, k) = (0, 1)$

2. **变量替换**：
   令 $u = x - 0 = x$， $v = y - 1$，则 $x = u$， $y = v + 1$
   
   $\frac{dy}{dx} = \frac{dv}{du}$

3. **代入方程**：
   $$\frac{dv}{du} = \frac{u + (v + 1) - 1}{u - (v + 1) + 1} = \frac{u + v}{u - v}$$

4. **齐次方程求解**：
   令 $w = \frac{v}{u}$，则 $v = wu$， $\frac{dv}{du} = w + u\frac{dw}{du}$
   
   $$w + u\frac{dw}{du} = \frac{u + wu}{u - wu} = \frac{1 + w}{1 - w}$$
   
   $$u\frac{dw}{du} = \frac{1 + w}{1 - w} - w = \frac{1 + w^2}{1 - w}$$

5. **分离变量积分**：
   $$\frac{1 - w}{1 + w^2} dw = \frac{du}{u}$$
   
   $$\int \frac{1 - w}{1 + w^2} dw = \int \frac{du}{u}$$
   
   左边： $\int \frac{1}{1 + w^2} dw - \int \frac{w}{1 + w^2} dw = \arctan w - \frac{1}{2}\ln(1 + w^2)$
   
   右边： $\ln|u|$
   
   $$\arctan w - \frac{1}{2}\ln(1 + w^2) = \ln|u| + C$$

6. **回代**：
   $$\arctan \frac{v}{u} - \frac{1}{2}\ln\left(1 + \frac{v^2}{u^2}\right) = \ln|u| + C$$
   
   即：
   $$\arctan \frac{y - 1}{x} - \frac{1}{2}\ln\left(1 + \frac{(y - 1)^2}{x^2}\right) = \ln|x| + C$$

> **例题2.3**：求解 $\frac{dy}{dx} = \frac{2x + y + 1}{x + 2y + 4}$

**解答**：
1. **验证可化为齐次的条件**：
   这里 $a_1 = 2, b_1 = 1, c_1 = 1$，$a_2 = 1, b_2 = 2, c_2 = 4$
   
   - $c_1, c_2$ 不全为零
   - $\frac{a_1}{a_2} = \frac{2}{1} = 2 \neq \frac{1}{2} = \frac{b_1}{b_2}$
   
   满足可化为齐次的条件。

2. **求平移量**：
   解方程组 $\begin{cases} 2x + y + 1 = 0 \\ x + 2y + 4 = 0 \end{cases}$
   
   从第一个方程： $y = -2x - 1$
   
   代入第二个方程：
   $$x + 2(-2x - 1) + 4 = 0$$
   $$x - 4x - 2 + 4 = 0$$
   $$-3x + 2 = 0$$
   $$x = \frac{2}{3}$$
   
   $$y = -2 \cdot \frac{2}{3} - 1 = -\frac{4}{3} - 1 = -\frac{7}{3}$$
   
   所以 $(h, k) = \left(\frac{2}{3}, -\frac{7}{3}\right)$

3. **变量替换**：
   令 $u = x - \frac{2}{3}$， $v = y + \frac{7}{3}$
   
   则 $x = u + \frac{2}{3}$， $y = v - \frac{7}{3}$
   
   **求导数关系**：
   - 对 $u = x - \frac{2}{3}$ 求微分：$du = dx$
   - 对 $v = y + \frac{7}{3}$ 求微分：$dv = dy$
   
   因此：$$\frac{dy}{dx} = \frac{dv}{du}$$

4. **代入原方程**：
   $$\frac{dv}{du} = \frac{2\left(u + \frac{2}{3}\right) + \left(v - \frac{7}{3}\right) + 1}{\left(u + \frac{2}{3}\right) + 2\left(v - \frac{7}{3}\right) + 4}$$
   
   **分子**：
   $$2u + \frac{4}{3} + v - \frac{7}{3} + 1 = 2u + v + \frac{4}{3} - \frac{7}{3} + \frac{3}{3} = 2u + v$$
   
   **分母**：
   $$u + \frac{2}{3} + 2v - \frac{14}{3} + 4 = u + 2v + \frac{2}{3} - \frac{14}{3} + \frac{12}{3} = u + 2v$$
   
   所以方程化为：
   $$\frac{dv}{du} = \frac{2u + v}{u + 2v}$$

5. **齐次方程求解**：
   令 $w = \frac{v}{u}$，则 $v = wu$， $\frac{dv}{du} = w + u\frac{dw}{du}$
   
   $$w + u\frac{dw}{du} = \frac{2u + wu}{u + 2wu} = \frac{u(2 + w)}{u(1 + 2w)} = \frac{2 + w}{1 + 2w}$$
   
   $$u\frac{dw}{du} = \frac{2 + w}{1 + 2w} - w = \frac{2 + w - w(1 + 2w)}{1 + 2w} = \frac{2 + w - w - 2w^2}{1 + 2w} = \frac{2 - 2w^2}{1 + 2w}$$

6. **分离变量**：
   $$\frac{1 + 2w}{2 - 2w^2} dw = \frac{du}{u}$$
   $$\frac{1 + 2w}{2(1 - w^2)} dw = \frac{du}{u}$$
   $$\frac{1 + 2w}{2(1 - w)(1 + w)} dw = \frac{du}{u}$$

7. **部分分式分解，分解下面这个部分**：
   $$\frac{1 + 2w}{2(1 - w)(1 + w)} = \frac{A}{1 - w} + \frac{B}{1 + w}$$
   
   $$1 + 2w = A(1 + w) + B(1 - w) = (A + B) + w(A - B)$$
   
   比较系数：
   - 常数项： $1 = A + B$
   - $w$ 的系数： $2 = A - B$
   
   解得： $A = \frac{3}{2}$， $B = -\frac{1}{2}$
   
   $$\frac{1 + 2w}{2(1 - w)(1 + w)} = \frac{1}{2}\left(\frac{3}{1 - w} - \frac{1}{1 + w}\right)$$

8. **积分**：
   $$\int \frac{1}{2}\left(\frac{3}{1 - w} - \frac{1}{1 + w}\right) dw = \int \frac{du}{u}$$
   
   $$\frac{1}{2}\left(-3\ln|1 - w| - \ln|1 + w|\right) = \ln|u| + C_1$$
   
   $$-\frac{3}{2}\ln|1 - w| - \frac{1}{2}\ln|1 + w| = \ln|u| + C_1$$
   
   $$-\frac{1}{2}\ln|(1 - w)^3(1 + w)| = \ln|u| + C_1$$

9. **回代变量**：
   $$-\frac{1}{2}\ln\left|\left(1 - \frac{v}{u}\right)^3\left(1 + \frac{v}{u}\right)\right| = \ln|u| + C_1$$
   
   $$-\frac{1}{2}\ln\left|\frac{(u - v)^3(u + v)}{u^4}\right| = \ln|u| + C_1$$
   
   $$-\frac{1}{2}\ln|(u - v)^3(u + v)| + 2\ln|u| = \ln|u| + C_1$$
   
   $$\ln|u| - \frac{1}{2}\ln|(u - v)^3(u + v)| = C_1$$

10. **最终回代**：
    将 $u = x - \frac{2}{3}$， $v = y + \frac{7}{3}$ 代回：
    
    $$\ln\left|x - \frac{2}{3}\right| - \frac{1}{2}\ln\left|\left(x - \frac{2}{3} - y - \frac{7}{3}\right)^3\left(x - \frac{2}{3} + y + \frac{7}{3}\right)\right| = C$$
    
    即：
    $$\ln\left|x - \frac{2}{3}\right| - \frac{1}{2}\ln|(x - y - 3)^3(x + y + 1)| = C$$

---

## 3. 一阶线性微分方程

### 3.1 一阶线性方程的标准形式

> **定义3.1（一阶线性微分方程）**
> 
> 形如 $\frac{dy}{dx} + P(x)y = Q(x)$ 的微分方程称为**一阶线性微分方程**。

**分类**：
- **齐次线性方程**： $\frac{dy}{dx} + P(x)y = 0$ （ $Q(x) = 0$）
- **非齐次线性方程**： $\frac{dy}{dx} + P(x)y = Q(x)$ （ $Q(x) \neq 0$）

### 3.2 一阶齐次线性方程的求解

> **方程**： $\frac{dy}{dx} + P(x)y = 0$

**求解方法**：
$$\frac{dy}{dx} = -P(x)y$$

分离变量：
$$\frac{dy}{y} = -P(x)dx$$

积分：
$$\ln|y| = -\int P(x)dx + C_1$$

> **齐次线性方程的通解**：
> $$y = Ce^{-\int P(x)dx}$$
> 其中 $C$ 为任意常数。

> **例题3.1**：求解 $\frac{dy}{dx} + 2xy = 0$

**解答**：
这是齐次线性方程，其中 $P(x) = 2x$

$$y = Ce^{-2x^2}$$

### 3.3 一阶非齐次线性方程的求解

> **方程**： $\frac{dy}{dx} + P(x)y = Q(x)$

#### 方法一：常数变易法

> **求解步骤**：
> 
> 1. **求齐次方程通解**： $y_h = Ce^{-\int P(x)dx}$
> 2. **设非齐次方程解**： $y = C(x)e^{-\int P(x)dx}$
> 3. **求 $C(x)$ **：代入原方程确定 $C(x)$
> 4. **写出通解**

**常数变易法的思想精髓**：

> **第一步：解齐次方程**
> 
> 先解对应的齐次方程 $\frac{dy}{dx} + P(x)y = 0$
> - 这相当于找到"基本骨架"
> - 解齐次方程的分离变量：$\frac{dy}{y} = -P(x)dx$
> - 积分：$\ln|y| = -\int P(x)dx + C_1$
> - 齐次解： $y_h = Ce^{-\int P(x)dx}$

> **第二步：常数"变"易**
> 
> 将齐次解中的常数 $C$ 变为 $x$ 的函数 $C(x)$：
> $$y = C(x)e^{-\int P(x)dx}$$
> 
> **直观理解**：原来的"固定常数"现在"随机应变"
> 
> **数学依据**：齐次解给出了解的"形式结构"，非齐次项会"调整"这个常数

> **第三步：确定 $C(x)$**
> 
> 计算 $\frac{dy}{dx}$（用乘积求导法则）：
> $$\frac{dy}{dx} = C'(x)e^{-\int P(x)dx} + C(x) \cdot \frac{d}{dx}[e^{-\int P(x)dx}]$$
> $$= C'(x)e^{-\int P(x)dx} - C(x)P(x)e^{-\int P(x)dx}$$
> 
> 代入原方程：
> $$C'(x)e^{-\int P(x)dx} - C(x)P(x)e^{-\int P(x)dx} + P(x)C(x)e^{-\int P(x)dx} = Q(x)$$
> 
> **关键观察**：中间两项相消！
> $$C'(x)e^{-\int P(x)dx} = Q(x)$$
> 
> 
> 解出：
> $$C'(x) = Q(x)e^{\int P(x)dx}$$
> 
> 积分：
> $$C(x) = \int Q(x)e^{\int P(x)dx}dx + K$$

> **第四步：写出通解**
> 
> 将 $C(x)$ 代入 $y = C(x)e^{-\int P(x)dx}$：
> $$y = \left[\int Q(x)e^{\int P(x)dx}dx + K\right]e^{-\int P(x)dx}$$
> 
> 整理得：
> $$y = e^{-\int P(x)dx}\left[\int Q(x)e^{\int P(x)dx}dx + C\right]$$


`这就得到了通解公式，这个公式可以直接使用，继续看下面例题`

> **例题3.2**：求解 $\frac{dy}{dx} + y = e^x$

**解答**：
1. **齐次方程通解**：
   $\frac{dy}{dx} + y = 0$ 的通解为 $y_h = Ce^{-x}$

2. **设非齐次解**：
   $y = C(x)e^{-x}$，则 $\frac{dy}{dx} = C'(x)e^{-x} - C(x)e^{-x}$

3. **代入原方程**：
   $$C'(x)e^{-x} - C(x)e^{-x} + C(x)e^{-x} = e^x$$
   $$C'(x)e^{-x} = e^x$$
   $$C'(x) = e^{2x}$$

4. **积分求 $C(x)$ **：
   $$C(x) = \int e^{2x}dx = \frac{1}{2}e^{2x} + K$$

5. **通解**：
   $$y = \left(\frac{1}{2}e^{2x} + K\right)e^{-x} = \frac{1}{2}e^x + Ke^{-x}$$

#### 方法二：通解公式法

> 
> 通过上面常数变易法的推导，我们发现每次求解一阶线性方程时，都会经历相同的步骤，最终得到相同形式的结果。这提示我们：能否将这个推导过程"一般化"，得到一个通用的公式？

> **公式法的本质**：公式法实际上是将常数变易法的推导过程"通用化"后得到的直接结果

**从常数变易法到通解公式的推导过程**：

回顾常数变易法的核心步骤：
1. 齐次解： $y_h = Ce^{-\int P(x)dx}$
2. 设非齐次解： $y = C(x)e^{-\int P(x)dx}$
3. 通过代入原方程得到： $C'(x) = Q(x)e^{\int P(x)dx}$
4. 积分得： $C(x) = \int Q(x)e^{\int P(x)dx}dx + K$

**通用公式的形成**：
将第4步的结果代入第2步：
$$y = C(x)e^{-\int P(x)dx} = \left[\int Q(x)e^{\int P(x)dx}dx + K\right]e^{-\int P(x)dx}$$

整理得到：
$$y = e^{-\int P(x)dx}\left[\int Q(x)e^{\int P(x)dx}dx + K\right]$$

令 $C = K$，就得到了：

> **一阶线性非齐次方程通解公式**：
> $$y = e^{-\int P(x)dx}\left[\int Q(x)e^{\int P(x)dx}dx + C\right]$$

 公式法就是由常数变易法推导出来的“通用结果形式”

**使用公式法的注意事项**：
- 必须先将方程化为标准形式 $\frac{dy}{dx} + P(x)y = Q(x)$
- 积分 $\int P(x)dx$ 和 $\int Q(x)e^{\int P(x)dx}dx$ 的计算要准确
- 理解公式的来源有助于避免使用错误

> **例题3.3**：用公式法求解 $\frac{dy}{dx} + \frac{y}{x} = x^2$

**解答(公式法)**：

这里 $P(x) = \frac{1}{x}$， $Q(x) = x^2$

1. **计算积分**：
   $$\int P(x)dx = \int \frac{1}{x}dx = \ln|x|$$

2. **应用公式**：
   $$y = e^{-\ln|x|}\left[\int x^2 \cdot e^{\ln|x|}dx + C\right]$$
   $$= \frac{1}{x}\left[\int x^2 \cdot x dx + C\right]$$
   $$= \frac{1}{x}\left[\int x^3 dx + C\right]$$
   $$= \frac{1}{x}\left[\frac{x^4}{4} + C\right]$$
   $$= \frac{x^3}{4} + \frac{C}{x}$$

> **对比例题3.3'**：用常数变易法求解上面例题 $\frac{dy}{dx} + \frac{y}{x} = x^2$

**解答（常数变易法）**：
1. **求齐次方程通解**：
   $\frac{dy}{dx} + \frac{y}{x} = 0$ 的通解为 $y_h = \frac{C}{x}$

2. **设非齐次解**：
   $y = \frac{C(x)}{x}$，则 $\frac{dy}{dx} = \frac{C'(x)}{x} - \frac{C(x)}{x^2}$

3. **代入原方程**：
   $$\frac{C'(x)}{x} - \frac{C(x)}{x^2} + \frac{1}{x} \cdot \frac{C(x)}{x} = x^2$$
   $$\frac{C'(x)}{x} - \frac{C(x)}{x^2} + \frac{C(x)}{x^2} = x^2$$
   $$\frac{C'(x)}{x} = x^2$$
   $$C'(x) = x^3$$

4. **积分求 $C(x)$**：
   $$C(x) = \int x^3 dx = \frac{x^4}{4} + K$$

5. **通解**：
   $$y = \frac{C(x)}{x} = \frac{\frac{x^4}{4} + K}{x} = \frac{x^3}{4} + \frac{K}{x}$$



### 3.4 初值问题的求解

> **例题3.4**：求解初值问题 $\begin{cases} \frac{dy}{dx} - 2y = 4x \\ y(0) = 1 \end{cases}$

**解答**：
1. **化标准形式**： $\frac{dy}{dx} + (-2)y = 4x$
   
   这里 $P(x) = -2$， $Q(x) = 4x$

2. **应用通解公式**：
   $$\int P(x)dx = \int (-2)dx = -2x$$
   
   $$y = e^{2x}\left[\int 4x \cdot e^{-2x}dx + C\right]$$

3. **计算积分** $\int 4x e^{-2x}dx$ （用分部积分）：
   设  $u = 4x$， $dv = e^{-2x}dx$
   则 $du = 4dx$， $v = -\frac{1}{2}e^{-2x}$
   
   $$\int 4x e^{-2x}dx = 4x \cdot \left(-\frac{1}{2}e^{-2x}\right) - \int 4 \cdot \left(-\frac{1}{2}e^{-2x}\right)dx$$
   $$= -2xe^{-2x} + 2\int e^{-2x}dx$$
   $$= -2xe^{-2x} + 2 \cdot \left(-\frac{1}{2}e^{-2x}\right)$$
   $$= -2xe^{-2x} - e^{-2x} = -e^{-2x}(2x + 1)$$

4. **通解**：
   $$y = e^{2x}[-e^{-2x}(2x + 1) + C] = -(2x + 1) + Ce^{2x}$$

5. **利用初值条件**：
   $y(0) = 1$，即 $1 = -(0 + 1) + C \cdot 1 = -1 + C$
   
   所以 $C = 2$

6. **特解**： $y = -(2x + 1) + 2e^{2x} = 2e^{2x} - 2x - 1$

> **例题3.5**：求解 $\frac{dy}{dx} + \frac{2y}{x} = x^3$ （ $x > 0$）

**解答**：
这是一阶线性方程，其中 $P(x) = \frac{2}{x}$， $Q(x) = x^3$

1. **计算积分**：
   $$\int P(x)dx = \int \frac{2}{x}dx = 2\ln x$$

2. **应用公式**：
   $$y = e^{-2\ln x}\left[\int x^3 \cdot e^{2\ln x}dx + C\right]$$
   $$= \frac{1}{x^2}\left[\int x^3 \cdot x^2 dx + C\right]$$
   $$= \frac{1}{x^2}\left[\int x^5 dx + C\right]$$
   $$= \frac{1}{x^2}\left[\frac{x^6}{6} + C\right]$$
   $$= \frac{x^4}{6} + \frac{C}{x^2}$$

**验证**：
$$\frac{dy}{dx} = \frac{4x^3}{6} - \frac{2C}{x^3} = \frac{2x^3}{3} - \frac{2C}{x^3}$$

$$\frac{dy}{dx} + \frac{2y}{x} = \frac{2x^3}{3} - \frac{2C}{x^3} + \frac{2}{x}\left(\frac{x^4}{6} + \frac{C}{x^2}\right)$$
$$= \frac{2x^3}{3} - \frac{2C}{x^3} + \frac{x^3}{3} + \frac{2C}{x^3} = x^3   \text{验证正确}$$ 

### 3.4 线性方程的多种变形

> 识别和处理各种"伪装"的线性方程

#### （1）标准化技巧

> 非标准系数的处理
> 
> 对于 $a(x)\frac{dy}{dx} + b(x)y = c(x)$ 形式，要**先除以** $a(x)$ 化为标准形式

> **例题3.6**：求解 $x\frac{dy}{dx} + 2y = x^3$ （$x > 0$）

**解答**：
1. **标准化**：
   $$\frac{dy}{dx} + \frac{2}{x}y = x^2$$
   
   这里 $P(x) = \frac{2}{x}$，$Q(x) = x^2$

2. **应用公式**：
   $$\int P(x)dx = \int \frac{2}{x}dx = 2\ln|x| = \ln x^2$$
   
   $$y = \frac{1}{x^2}\left[\int x^2 \cdot x^2 dx + C\right] = \frac{1}{x^2}\left[\frac{x^5}{5} + C\right] = \frac{x^3}{5} + \frac{C}{x^2}$$

#### （2）反函数形式的线性方程

> $x$关于$y$的线性方程
> 
> 形如 $\frac{dx}{dy} + P(y)x = Q(y)$ 的方程

> **例题3.7**：求解 $\frac{dx}{dy} + x = y^2$

**解答**：
这是关于$x$的一阶线性方程：
$$x = e^{-\int 1 dy}\left[\int y^2 e^{\int 1 dy} dy + C\right]$$
$$= e^{-y}\left[\int y^2 e^y dy + C\right]$$

计算 $\int y^2 e^y dy$（两次分部积分）：
$$\int y^2 e^y dy = y^2 e^y - 2ye^y + 2e^y = e^y(y^2 - 2y + 2)$$

所以：
$$x = e^{-y}[e^y(y^2 - 2y + 2) + C] = y^2 - 2y + 2 + Ce^{-y}$$

#### （3）含参数的线性方程与共振现象



> **例题3.8**：求解 $\frac{dy}{dx} + \lambda y = e^x$，其中$\lambda$为实参数

**求解要点**：含参数方程需要分情况讨论，特别注意使积分分母为零的特殊参数值。

**简化分析**：
- 当 $\lambda \neq -1$ 时：$y = \frac{e^x}{1+\lambda} + Ce^{-\lambda x}$
- 当 $\lambda = -1$ 时：$y = (x + C)e^x$

**关键观察**：$\lambda = -1$ 时出现 $xe^x$ 项，但这**不是共振**，而是积分技术问题。

##### 3.3.2 共振现象：定义与识别

> **共振现象的定义**
> 
> 对于一阶线性方程 $\frac{dy}{dx} + P(x)y = Q(x)$，当非齐次项 $Q(x)$ 恰好是对应齐次方程的解时，就发生**共振现象**。
> 
> **数学表述**：
>
> $$
> \frac{dy}{dx} + P(x)y = Q(x)
> $$
>
> 齐次解为：
> 
> $$
> y_h = C \cdot \mu(x) \quad \text{其中 } \mu(x) = e^{-\int P(x)\,dx}
> $$
> 
> 如果：
> 
> $$
> \exists C_0 \in \mathbb{R} \quad \text{使得} \quad Q(x) = C_0 \cdot \mu(x)
> $$
> 
>  那么我们就说非齐次项 \( Q(x) \) 与齐次解发生**共振**。

**共振识别三步法**：
1. **求齐次解基本形式** $f(x) = e^{-\int P(x)dx}$
2. **检查** $Q(x)$ 是否等于 $kf(x)$
3. **判断**：若相等则共振，否则无共振

##### 3.3.3 共振问题的正确解法

> **核心方法：常数变易法**
> 
> 共振问题**必须**使用常数变易法求解，通解公式在共振时会失效。

**标准解题步骤**：

> **例题3.9**：求解 $\frac{dy}{dx} + y = e^{-x}$

**第一步：共振判断**
- 齐次解： $y_h = Ce^{-x}$，基本形式 $f(x) = e^{-x}$
- 非齐次项： $Q(x) = e^{-x}$
- **判断**：$Q(x) = 1 \cdot f(x)$ → **发生共振**

**第二步：应用常数变易法**
设 $y = C(x)e^{-x}$，求导：
$$\frac{dy}{dx} = C'(x)e^{-x} - C(x)e^{-x}$$

**第三步：代入原方程**
$$C'(x)e^{-x} - C(x)e^{-x} + C(x)e^{-x} = e^{-x}$$
$$C'(x)e^{-x} = e^{-x}$$
$$C'(x) = 1$$

**第四步：积分求解**
$$C(x) = x + K$$

**第五步：写出通解**
$$y = (x + K)e^{-x} = xe^{-x} + Ke^{-x}$$

**共振解的特征**：通解 = 齐次解 + $x \times$ 齐次解基本形式

> **例题3.10**：求解 $\frac{dy}{dx} + \frac{y}{x} = \frac{1}{x}$ （$x > 0$）

**第一步：共振判断**
- 齐次解： $y_h = \frac{C}{x}$，基本形式 $f(x) = \frac{1}{x}$
- 非齐次项： $Q(x) = \frac{1}{x}$
- **判断**：$Q(x) = 1 \cdot f(x)$ → **发生共振**

**第二步：常数变易法求解**
设 $y = \frac{C(x)}{x}$，求导：$\frac{dy}{dx} = \frac{C'(x)}{x} - \frac{C(x)}{x^2}$

代入原方程：$\frac{C'(x)}{x} = \frac{1}{x}$ → $C'(x) = 1$ → $C(x) = x + K$

**第三步：写出通解**
$$y = \frac{x + K}{x} = 1 + \frac{K}{x}$$

**共振特征**：常数项 $1$ 对应于 $x \cdot \frac{1}{x}$

##### 3.3.4 共振问题解法要点总结

> **共振解法的核心原则**

1. **识别共振**：$Q(x) = k \cdot f(x)$（$f(x)$为齐次解基本形式）
2. **选择方法**：共振时**必须**用常数变易法
3. **解的形式**：共振解 = 齐次解 + $x \times$ 齐次解基本形式
4. **验证结果**：通解中应出现 $x$ 因子

> **常见共振类型速查**

| 齐次解基本形式 | 共振条件 | 共振解的特解部分 |
|:---------------|:---------|:----------------|
| $e^{ax}$ | $Q(x) = ke^{ax}$ | $Axe^{ax}$ |
| $\frac{1}{x}$ | $Q(x) = \frac{k}{x}$ | $A\ln\|x\|$ |
| $x^n$ | $Q(x) = kx^n$ | $Ax^{n+1}$ |
| $\sin(ax)$ | $Q(x) = k\sin(ax)$ | $Ax\sin(ax)$ |

> **解题流程图**

```
开始 → 求齐次解基本形式f(x) → Q(x)=kf(x)吗
                                 |？ 
                           ↙否        ↘是
                      用通解公式      用常数变易法
                          ↓              ↓
                      正常求解        特解含x因子
                          ↘              ↙
                               结束
```

 
#### （4）变系数线性方程的特殊情况

> 利用已知解求通解
> 
> 如果已知齐次方程的一个特解，可以用它构造通解

> **例题3.9**：已知 $y_1 = x$ 是方程 $x\frac{dy}{dx} - y = 0$ 的解，求原方程的通解

**解答**：
1. **验证特解**：
   $y_1 = x$，$y_1' = 1$
   代入：$x \cdot 1 - x = 0$ ✓

2. **化标准形式**：
   $$\frac{dy}{dx} - \frac{1}{x}y = 0$$

3. **求通解**：
$$
y = Ce^{\int \frac{1}{x} \, dx} = Ce^{\ln|x|} = C|x| = Cx \quad \text{（当 } x > 0 \text{ 时）}
$$



这确实包含了特解 $y_1 = x$（当$C = 1$时）。

#### （5）常见的组合技巧

> 线性方程与初值问题的结合

> **例题3.10**：求解初值问题 $\begin{cases} (1+x^2)\frac{dy}{dx} + 2xy = \frac{1}{1+x^2} \\ y(0) = 1 \end{cases}$

**解答**：
1. **标准化**：
   $$\frac{dy}{dx} + \frac{2x}{1+x^2}y = \frac{1}{(1+x^2)^2}$$

2. **识别积分**：
   $$\int \frac{2x}{1+x^2}dx = \ln(1+x^2)$$

3. **应用公式**：
   $$y = \frac{1}{1+x^2}\left[\int \frac{1}{(1+x^2)^2} \cdot (1+x^2) dx + C\right]$$
   $$= \frac{1}{1+x^2}\left[\int \frac{1}{1+x^2} dx + C\right]$$
   $$= \frac{1}{1+x^2}[\arctan x + C]$$

4. **利用初值**：
   $y(0) = 1$，即 $\frac{1}{1}[\arctan 0 + C] = 1$
   所以 $0 + C = 1$，$C = 1$

5. **特解**：
   $$y = \frac{\arctan x + 1}{1+x^2}$$

#### （6）综合型题目

> 与其他知识点的综合
> 
> 线性方程经常与定积分、级数等结合出题

> **例题3.11**：求解 $\frac{dy}{dx} + \frac{y}{x} = \frac{\sin x}{x}$，并求 $\int_0^{\pi} y(x) dx$

**解答**：
1. **求通解**：
   $$y = \frac{1}{x}\left[\int \sin x dx + C\right] = \frac{-\cos x + C}{x}$$

2. **确定初值条件**：
   如果要求定积分有意义，需要 $y(x)$ 在 $[0,\pi]$ 上连续。
   
   当 $x \to 0^+$ 时，要使 $y(x)$ 有限，需要：
   $$\lim_{x \to 0^+} \frac{-\cos x + C}{x} = \lim_{x \to 0^+} \frac{-(1) + C}{x}$$
   
   要使极限存在且有限，必须 $C = 1$。

3. **特解**：
   $$y = \frac{1 - \cos x}{x}$$

4. **计算定积分**：
   $$\int_0^{\pi} \frac{1 - \cos x}{x} dx$$
   
   这是一个特殊积分，需要用级数展开或特殊技巧。

### 3.5 初值问题的求解

初值问题是指在微分方程的基础上，给定一个初始条件的问题。

> **例题3.12**：求解初值问题 $\begin{cases} \frac{dy}{dx} - 2y = 4x \\ y(0) = 1 \end{cases}$

**解答**：
1. **化标准形式**： $\frac{dy}{dx} + (-2)y = 4x$
   
   这里 $P(x) = -2$， $Q(x) = 4x$
   
2. **应用通解公式**：
   $$\int P(x)dx = \int (-2)dx = -2x$$

   $$y = e^{2x}\left[\int 4x \cdot e^{-2x}dx + C\right]$$

3. **计算积分** $\int 4x e^{-2x}dx$ （用分部积分）：
   设 $u = 4x$， $dv = e^{-2x}dx$
   则 $du = 4dx$， $v = -\frac{1}{2}e^{-2x}$
   
   $$\int 4x e^{-2x}dx = 4x \cdot \left(-\frac{1}{2}e^{-2x}\right) - \int 4 \cdot \left(-\frac{1}{2}e^{-2x}\right)dx$$
   $$= -2xe^{-2x} + 2\int e^{-2x}dx$$
   $$= -2xe^{-2x} + 2 \cdot \left(-\frac{1}{2}e^{-2x}\right)$$
   $$= -2xe^{-2x} - e^{-2x} = -e^{-2x}(2x + 1)$$

4. **通解**：
   $$y = e^{2x}[-e^{-2x}(2x + 1) + C] = -(2x + 1) + Ce^{2x}$$

5. **利用初值条件**：
   $y(0) = 1$，即 $1 = -(0 + 1) + C \cdot 1 = -1 + C$
   
   所以 $C = 2$

6. **特解**： $y = -(2x + 1) + 2e^{2x} = 2e^{2x} - 2x - 1$

---

## 4. 伯努利方程

### 4.1 伯努利方程的定义

> **定义4.1（伯努利方程）**
> 
> 形如 $\frac{dy}{dx} + P(x)y = Q(x)y^n$ （ $n \neq 0, 1$）的微分方程称为**伯努利方程**。

**特殊情况**：
- 当 $n = 0$ 时，方程变为一阶线性方程
- 当 $n = 1$ 时，方程可分离变量

### 4.2 伯努利方程的求解方法

> **标准求解流程**：
> 
> 1. **原方程**： $\frac{dy}{dx} + P(x)y = Q(x)y^n$
> 2. **两边除以 $y^n$ **： $y^{-n}\frac{dy}{dx} + P(x)y^{1-n} = Q(x)$
> 3. **变量替换**：令 $z = y^{1-n}$，则 $\frac{dz}{dx} = (1-n)y^{-n}\frac{dy}{dx}$
> 4. **重要关系**： $y^{-n}\frac{dy}{dx} = \frac{1}{1-n}\frac{dz}{dx}$
> 5. **代入得线性方程**： $\frac{1}{1-n}\frac{dz}{dx} + P(x)z = Q(x)$
> 6. **化简**： $\frac{dz}{dx} + (1-n)P(x)z = (1-n)Q(x)$

**核心思想**：通过变量替换 $z = y^{1-n}$ 将非线性的伯努利方程转化为关于 $z$ 的一阶线性方程。

> **为什么用 $z = y^{1-n}$ 替换？**
> 
> **数学原理**：
> - 当 $n > 1$ 时， $1-n < 0$，所以 $z = y^{1-n} = \frac{1}{y^{n-1}}$
> - 当 $0 < n < 1$ 时， $1-n > 0$，所以 $z = y^{1-n}$
> - 这个替换能够"消除" $y$ 的非线性项

> **例题4.2**：求解伯努利方程  $\frac{dy}{dx} + y = xy^2$

**解答**：
1. **识别参数**：
   对比标准形式 $\frac{dy}{dx} + P(x)y = Q(x)y^n$
   
   这里 $P(x) = 1$， $Q(x) = x$， $n = 2$
   
2. **变量替换**：
   令 $z = y^{1-2} = y^{-1} = \frac{1}{y}$

   则 $y = \frac{1}{z}$， $\frac{dy}{dx} = -\frac{1}{z^2}\frac{dz}{dx}$

3. **代入原方程**：
   $$-\frac{1}{z^2}\frac{dz}{dx} + \frac{1}{z} = x \cdot \frac{1}{z^2}$$
   
   两边乘以 $-z^2$：
   $$\frac{dz}{dx} - z = -x$$
   
   即： $\frac{dz}{dx} + (-1)z = -x$

4. **求解线性方程**：
   这是关于 $z$ 的一阶线性方程，其中 $P(x) = -1$， $Q(x) = -x$
   
   $$z = e^{x}\left[\int (-x)e^{-x}dx + C\right]$$
   
   计算 $\int (-x)e^{-x}dx$ （分部积分）：
   $$\int (-x)e^{-x}dx = xe^{-x} - \int e^{-x}dx = xe^{-x} + e^{-x} = e^{-x}(x + 1)$$
   
   所以：
   $$z = e^x[e^{-x}(x + 1) + C] = (x + 1) + Ce^x$$

5. **回代求 $y$ **：
   $$y = \frac{1}{z} = \frac{1}{(x + 1) + Ce^x}$$

### 4.3 伯努利方程的识别与变形技巧

#### （1）快速识别伪装的伯努利方程

> **识别要点**：
> 
> - **标准形式**： $\frac{dy}{dx} + P(x)y = Q(x)y^n$ （ $n \neq 0, 1$）
> - **变形形式**：需要通过变形才能识别的伯努利方程
> - **关键特征**：含有 $y$ 的不同次幂项

> **例题4.3**：求解 $x\frac{dy}{dx} - 2y = 3xy^{1/2}$

**解答**：
1. **化标准形式**：
   $$\frac{dy}{dx} - \frac{2}{x}y = 3y^{1/2}$$
   
   这是伯努利方程，其中 $P(x) = -\frac{2}{x}$， $Q(x) = 3$， $n = \frac{1}{2}$

2. **变量替换**：
   令 $z = y^{1-1/2} = y^{1/2} = \sqrt{y}$
   
   则 $y = z^2$， $\frac{dy}{dx} = 2z\frac{dz}{dx}$

3. **代入原方程**：
   $$2z\frac{dz}{dx} - \frac{2}{x} \cdot z^2 = 3z$$
   
   两边除以 $z$（假设 $z \neq 0$）：
   $$2\frac{dz}{dx} - \frac{2}{x}z = 3$$
   
   即：
   $$\frac{dz}{dx} - \frac{z}{x} = \frac{3}{2}$$

4. **求解线性方程**：
   $$z = x\left[\frac{3}{2}\ln|x| + C\right]$$

5. **回代求 $y$**：
   $$y = z^2 = x^2\left[\frac{3}{2}\ln|x| + C\right]^2$$

#### （2）特殊情况的处理

> **情况1**： $n = 0$ 的情况
> 
> 当 $n = 0$ 时，方程 $\frac{dy}{dx} + P(x)y = Q(x)y^0 = Q(x)$ 退化为**一阶线性方程**

> **情况2**： $n = 1$ 的情况
> 
> 当 $n = 1$ 时，方程 $\frac{dy}{dx} + P(x)y = Q(x)y$ 可以重写为：
> $\frac{dy}{dx} = [Q(x) - P(x)]y$
> 
> 这是**可分离变量**的方程

> **情况3**：负指数的情况
> 
> 当 $n < 0$ 时，设 $n = -m$ （ $m > 0$），方程变为：
> $$\frac{dy}{dx} + P(x)y = Q(x)y^{-m}$$
> 
> 仍可用 $z = y^{1-n} = y^{1+m}$ 的替换

#### （3）与其他方程类型的区分

> **区分技巧表**：

| 方程特征 | 方程类型 | 关键标志 |
|:---------|:---------|:---------|
| $\frac{dy}{dx} = f(x)g(y)$ | 可分离变量 | 右端为 $x,y$ 函数的乘积 |
| $\frac{dy}{dx} = f(\frac{y}{x})$ | 齐次方程 | 右端只依赖于 $\frac{y}{x}$ |
| $\frac{dy}{dx} + P(x)y = Q(x)$ | 一阶线性 | $y$ 的最高次数为1，无其他次幂 |
| $\frac{dy}{dx} + P(x)y = Q(x)y^n$ | 伯努利方程 | 同时含有 $y^1$ 和 $y^n$ 项 |

#### （4）常见的伪装形式

> **例题4.4**：识别并求解 $y\frac{dy}{dx} + x = y^2$

**解答**：
1. **重新整理**：
   $$y\frac{dy}{dx} = y^2 - x$$
   $$\frac{dy}{dx} = y - \frac{x}{y}$$
   $$\frac{dy}{dx} = y - xy^{-1}$$
   $$\frac{dy}{dx} - y = -xy^{-1}$$

2. **识别类型**：
   这是伯努利方程，其中 $P(x) = -1$， $Q(x) = -x$， $n = -1$

3. **变量替换**：
   令 $z = y^{1-(-1)} = y^2$
   
   则 $\frac{dz}{dx} = 2y\frac{dy}{dx}$，所以 $y\frac{dy}{dx} = \frac{1}{2}\frac{dz}{dx}$

4. **代入原方程**：
   $$\frac{1}{2}\frac{dz}{dx} + x = z$$
   $$\frac{dz}{dx} - 2z = -2x$$

5. **求解得**： $z = e^{2x}(\int (-2x)e^{-2x}dx + C)$

**识别技巧总结**：
- **观察次幂**：是否同时含有 $y$ 的不同次幂
- **标准化**：将方程化为 $\frac{dy}{dx} + P(x)y = Q(x)y^n$ 形式
- **特殊检查**：注意 $n = 0, 1$ 的特殊情况
- **变形敏感**：有些方程需要先变形才能识别

---

## 5. 其他特殊类型的一阶方程

### 5.1 形如 $f(x,y,y') = 0$ 的方程

#### （1）可解出 $y'$ 的方程： $y' = f(x,y)$
按前面介绍的各种方法求解。

#### （2）可解出 $y$ 的方程： $y = f(x,y')$

> **求解方法**：
> 
> 1. 设  $p = y'$，则方程变为 $y = f(x,p)$
> 2. 对 $x$ 求导： $p = \frac{\partial f}{\partial x} + \frac{\partial f}{\partial p} \cdot \frac{dp}{dx}$
> 3. 解关于 $p$ 和 $x$ 的微分方程
> 4. 得到 $p = \varphi(x,C)$ 后，代入 $y = f(x,p)$ 得到通解

#### （3）可解出 $x$ 的方程： $x = f(y,y')$

类似于情况（2），设  $p = y'$，然后利用 $\frac{dx}{dy} = \frac{1}{p}$ 求解。

### 5.2 不显含 $x$ 的方程： $f(y,y') = 0$

> **求解方法**：
> 
> 设  $p = y'$，则 $y'' = \frac{dp}{dx} = \frac{dp}{dy} \cdot \frac{dy}{dx} = p\frac{dp}{dy}$
> 
> 方程降为一阶： $f(y,p) = 0$

### 5.3 不显含 $y$ 的方程： $f(x,y') = 0$

> **求解方法**：
> 
> 设  $p = y'$，方程变为 $f(x,p) = 0$
> 
> 解出 $p = \varphi(x)$，然后积分： $y = \int \varphi(x)dx + C$

---

## 6. 综合技巧与典型题型


### 6.1 万能替换法：参数化技巧

> **核心思想**：当直接求解困难时，引入参数或新变量简化问题

#### （1）角度参数化

> **例题6.1**：求解 $\frac{dy}{dx} = \frac{x + y + \sqrt{x^2 + y^2}}{x - y + \sqrt{x^2 + y^2}}$

**解答**：
设 $x = r\cos\theta$， $y = r\sin\theta$，则 $\sqrt{x^2 + y^2} = r$

代入原方程：
$$\frac{d(r\sin\theta)}{d(r\cos\theta)} = \frac{r\cos\theta + r\sin\theta + r}{r\cos\theta - r\sin\theta + r}$$

这种参数化将复杂的代数式转化为三角函数，但计算仍然复杂。
让我们尝试更直接的方法。

**更好的方法**：设 $v = \frac{y}{x}$，则这是齐次方程：
$$\frac{dy}{dx} = \frac{1 + v + \sqrt{1 + v^2}}{1 - v + \sqrt{1 + v^2}}$$

#### （2）双曲函数参数化

> **例题6.2**：求解含有 $\sqrt{x^2 - a^2}$ 的微分方程

当方程中出现 $\sqrt{x^2 - a^2}$ 时，可以设 $x = a\sec t$ 或 $x = a\cosh t$

### 6.2 多重变换的组合技巧

> **核心原则**：一次变换不够时，进行多次变换

#### （1）先对调，再变量替换

> **例题6.3**：求解 $\frac{dy}{dx} = \frac{y^2 - x}{xy^3}$

**解答方法一（直接）**：很难处理。

**解答方法二（先对调）**：
$$\frac{dx}{dy} = \frac{xy^3}{y^2 - x}$$

仍然复杂。

**解答方法三（双重技巧）**：
首先重写原方程：
$$\frac{dy}{dx} = \frac{y^2 - x}{xy^3} = \frac{y^2}{xy^3} - \frac{x}{xy^3} = \frac{1}{xy} - \frac{1}{y^3}$$

这提示我们可能需要特殊的替换。

#### （2）连续变量替换

> **例题6.4**：求解 $\frac{dy}{dx} = \frac{x + 2y + 3}{2x + 4y + 5}$

**解答**：
**第一步变换**：注意到分子分母的系数关系，设 $u = x + 2y$，则：
$$\frac{du}{dx} = 1 + 2\frac{dy}{dx}$$

原方程变为：
$$\frac{du}{dx} - 1 = 2 \cdot \frac{u + 3}{2u + 5}$$
$$\frac{du}{dx} = 1 + \frac{2(u + 3)}{2u + 5} = \frac{2u + 5 + 2u + 6}{2u + 5} = \frac{4u + 11}{2u + 5}$$

**第二步变换**：设 $v = 2u + 5$，则 $u = \frac{v - 5}{2}$，$\frac{du}{dx} = \frac{1}{2}\frac{dv}{dx}$

代入：
$$\frac{1}{2}\frac{dv}{dx} = \frac{4 \cdot \frac{v-5}{2} + 11}{v} = \frac{2(v-5) + 11}{v} = \frac{2v - 10 + 11}{v} = \frac{2v + 1}{v}$$

$$\frac{dv}{dx} = \frac{2(2v + 1)}{v} = \frac{4v + 2}{v}$$

分离变量：
$$\frac{v dv}{4v + 2} = dx$$
$$\frac{v}{4v + 2} dv = dx$$

积分左边：
$$\int \frac{v}{4v + 2} dv = \int \frac{v}{2(2v + 1)} dv$$

设 $2v + 1 = w$，则 $v = \frac{w-1}{2}$，$dv = \frac{dw}{2}$

$$\int \frac{\frac{w-1}{2}}{w} \cdot \frac{dw}{2} = \frac{1}{4}\int \frac{w-1}{w} dw = \frac{1}{4}\int \left(1 - \frac{1}{w}\right) dw$$
$$= \frac{1}{4}(w - \ln|w|) = \frac{1}{4}(2v + 1 - \ln|2v + 1|)$$

所以：
$$\frac{1}{4}(2v + 1 - \ln|2v + 1|) = x + C$$

回代 $v = 2u + 5$ 和 $u = x + 2y$：
$$\frac{1}{4}(2(2u + 5) + 1 - \ln|2(2u + 5) + 1|) = x + C$$
$$\frac{1}{4}(4u + 11 - \ln|4u + 11|) = x + C$$
$$\frac{1}{4}(4(x + 2y) + 11 - \ln|4(x + 2y) + 11|) = x + C$$

这就是通解的隐式表达形式。

### 6.3 含绝对值的微分方程

> **处理原则**：分区间讨论，注意连接条件

> **例题6.5**：求解 $\frac{dy}{dx} = |x - 1|$，$y(0) = 2$

**解答**：
1. **分区间**：
   - 当 $x < 1$ 时，$|x - 1| = 1 - x$
   - 当 $x > 1$ 时，$|x - 1| = x - 1$

2. **分别求解**：
   
   **区间1**：$x < 1$，$\frac{dy}{dx} = 1 - x$
   $$y = \int (1 - x) dx = x - \frac{x^2}{2} + C_1$$
   
   **区间2**：$x > 1$，$\frac{dy}{dx} = x - 1$
   $$y = \int (x - 1) dx = \frac{x^2}{2} - x + C_2$$

3. **确定常数**：
   利用 $y(0) = 2$（在区间1内）：
   $$2 = 0 - 0 + C_1 \Rightarrow C_1 = 2$$
   
   所以区间1的解为：$y = x - \frac{x^2}{2} + 2$

4. **连接条件**：
   在 $x = 1$ 处，解应该连续：
   $$\lim_{x \to 1^-} y = 1 - \frac{1}{2} + 2 = \frac{5}{2}$$
   $$\lim_{x \to 1^+} y = \frac{1}{2} - 1 + C_2 = C_2 - \frac{1}{2}$$
   
   连续性要求：$C_2 - \frac{1}{2} = \frac{5}{2}$，所以 $C_2 = 3$

5. **完整解**：
   $$y = \begin{cases}
   x - \frac{x^2}{2} + 2, & x \leq 1 \\
   \frac{x^2}{2} - x + 3, & x > 1
   \end{cases}$$

### 6.4 求解技巧的优先级判断

> **实战策略**：按优先级尝试不同方法

#### （1）方法优先级排序

1. **第一优先**：可分离变量（最简单）
2. **第二优先**：一阶线性（有通用公式）
3. **第三优先**：齐次方程（标准替换）
4. **第四优先**：伯努利方程（非线性转线性）
5. **第五优先**：全微分方程（需要验证条件）
6. **最后考虑**：对调x、y、特殊替换、积分因子

#### （2）快速识别表

> **例题7.6**：快速判断下列方程的类型并选择最优解法

1. $\frac{dy}{dx} = \frac{x^2 + 1}{y}$ → **可分离变量**（第一优先）

2. $\frac{dy}{dx} + 2xy = x$ → **一阶线性**（第二优先）

3. $\frac{dy}{dx} = \frac{x + y}{x - y}$ → **齐次方程**（第三优先，因为右端可写成$\frac{1 + \frac{y}{x}}{1 - \frac{y}{x}}$）

4. $\frac{dy}{dx} + y = xy^2$ → **伯努利方程**（第四优先，$n = 2$）

5. $(2x + 3y)dx + (3x + 2y)dy = 0$ → **检查全微分条件**（第五优先）

### 7.5 考研常考的综合题型

#### （1）含参数的讨论题

> **例题7.7**：设 $a$ 为实参数，求解 $\frac{dy}{dx} + ay = x^a$

**解答**：
这是一阶线性方程，但需要分情况讨论 $a$ 的值：

**情况1**：$a = 0$
方程变为 $\frac{dy}{dx} = 1$，通解：$y = x + C$

**情况2**：$a \neq 0$
$$y = e^{-ax}\left[\int x^a e^{ax} dx + C\right]$$

这个积分比较复杂，需要根据 $a$ 的不同值进一步讨论。

#### （2）与其他知识点结合

> **例题7.8**：设曲线过点 $(1,0)$，且曲线上任一点 $(x,y)$ 处的切线斜率等于该点到原点距离的倒数，求曲线方程

**解答**：
1. **建立微分方程**：
   切线斜率为 $\frac{dy}{dx}$，点到原点距离为 $\sqrt{x^2 + y^2}$
   
   $$\frac{dy}{dx} = \frac{1}{\sqrt{x^2 + y^2}}$$

2. **识别方程类型**：
   这个方程不属于标准类型，考虑变换。

3. **巧妙变换**：
   将方程写成：$\sqrt{x^2 + y^2} dy = dx$
   
   设 $u = x^2 + y^2$，则：
   $$du = 2x dx + 2y dy$$
   
   从原方程：$\sqrt{u} dy = dx$，得 $dy = \frac{dx}{\sqrt{u}}$
   
   代入：
   $$du = 2x dx + 2y \cdot \frac{dx}{\sqrt{u}} = 2x dx + \frac{2y dx}{\sqrt{u}}$$
   
   这个方法变得复杂。

4. **重新考虑**：
   原方程：$\frac{dy}{dx} = \frac{1}{\sqrt{x^2 + y^2}}$
   
   分离变量：$\sqrt{x^2 + y^2} dy = dx$
   
   这是一个复杂的积分，实际求解需要用到椭圆积分等高级技巧，超出了基础微分方程的范围。
 

## 7. 重要公式汇总

| 方程类型 | 标准形式 | 通解公式 | 注意事项 |
|:---------|:---------|:---------|:---------|
| 可分离变量 | $\frac{dy}{dx} = f(x)g(y)$ | $\int \frac{dy}{g(y)} = \int f(x)dx$ | 注意 $g(y) = 0$ 的解 |
| 齐次方程 | $\frac{dy}{dx} = f(\frac{y}{x})$ | 令 $v = \frac{y}{x}$ 转化 | 变量替换后分离变量 |
| 一阶线性 | $\frac{dy}{dx} + P(x)y = Q(x)$ | $y = e^{-\int P(x)dx}[\int Q(x)e^{\int P(x)dx}dx + C]$ | 积分计算要仔细 |
| 伯努利方程 | $\frac{dy}{dx} + P(x)y = Q(x)y^n$ | 令 $z = y^{1-n}$ 转化为线性 | $n \neq 0, 1$ |
| 全微分方程 | $M dx + N dy = 0$ | $u(x,y) = C$，其中 $du = M dx + N dy$ | 需验证 $\frac{\partial M}{\partial y} = \frac{\partial N}{\partial x}$ |

---

